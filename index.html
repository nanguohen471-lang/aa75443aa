<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>探索你的生命密碼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        
        .gradient-bg {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%), 
                        url('https://meet.eslite.com/CMS/Files/@M091/2023-12/2023movie_wish/2023movie_wish01.jpg') center/cover no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        .start-page-bg {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.85) 0%, rgba(118, 75, 162, 0.85) 100%), 
                        url('https://meet.eslite.com/CMS/Files/@M091/2023-12/2023movie_wish/2023movie_wish01.jpg') center/cover no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        .card-shadow {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .number-circle {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .option-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .option-card.selected {
            border-color: #7c3aed;
            background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
        }

        /* 迪士尼城堡開場動畫 */
        .disney-intro {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, rgba(26, 26, 46, 0.95) 0%, rgba(22, 33, 62, 0.95) 30%, rgba(15, 52, 96, 0.95) 60%, rgba(83, 52, 131, 0.95) 100%), 
                        url('https://meet.eslite.com/CMS/Files/@M091/2023-12/2023movie_wish/2023movie_wish01.jpg') center/cover no-repeat;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            animation: introFadeOut 2s ease-in-out forwards;
            overflow: hidden;
        }

        .disney-intro.hidden {
            display: none;
        }

        @keyframes introFadeOut {
            0% { opacity: 1; }
            85% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }

        /* 流星雨效果 */
        .shooting-stars {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .shooting-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: linear-gradient(45deg, #fff, #87ceeb);
            border-radius: 50%;
            box-shadow: 0 0 10px #87ceeb, 0 0 20px #87ceeb, 0 0 30px #87ceeb;
            animation: shootingStar 3s linear infinite;
        }

        @keyframes shootingStar {
            0% {
                transform: translateX(-100px) translateY(-100px);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateX(100vw) translateY(100vh);
                opacity: 0;
            }
        }

        .shooting-star::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 50px;
            height: 1px;
            background: linear-gradient(90deg, transparent, #87ceeb, transparent);
            transform: translateX(-50px) rotate(45deg);
        }

        /* 雲朵動畫 */
        .clouds {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
            opacity: 0.6;
            animation: cloudFloat 20s infinite linear;
        }

        .cloud:before {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
        }

        .cloud1 {
            width: 80px;
            height: 40px;
            top: 20%;
            left: -100px;
            animation-duration: 25s;
        }

        .cloud1:before {
            width: 50px;
            height: 50px;
            top: -25px;
            left: 10px;
        }

        .cloud2 {
            width: 60px;
            height: 30px;
            top: 40%;
            left: -80px;
            animation-duration: 30s;
            animation-delay: -5s;
        }

        .cloud2:before {
            width: 40px;
            height: 40px;
            top: -20px;
            left: 15px;
        }

        .cloud3 {
            width: 100px;
            height: 50px;
            top: 60%;
            left: -120px;
            animation-duration: 35s;
            animation-delay: -10s;
        }

        .cloud3:before {
            width: 60px;
            height: 60px;
            top: -30px;
            left: 20px;
        }

        @keyframes cloudFloat {
            0% { transform: translateX(0); }
            100% { transform: translateX(calc(100vw + 200px)); }
        }

        .castle-container {
            position: relative;
            animation: castleEntrance 1s ease-out;
            z-index: 10;
        }

        @keyframes castleEntrance {
            0% { 
                transform: translateY(200px) scale(0.3);
                opacity: 0;
                filter: blur(15px);
            }
            30% {
                transform: translateY(100px) scale(0.6);
                opacity: 0.3;
                filter: blur(10px);
            }
            60% {
                transform: translateY(30px) scale(0.9);
                opacity: 0.7;
                filter: blur(5px);
            }
            80% {
                transform: translateY(-20px) scale(1.1);
                opacity: 0.9;
                filter: blur(2px);
            }
            90% {
                transform: translateY(10px) scale(0.95);
                opacity: 1;
                filter: blur(0px);
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
                filter: blur(0px);
            }
        }

        .castle-svg {
            width: 200px;
            height: 200px;
            filter: drop-shadow(0 15px 30px rgba(0,0,0,0.6));
            animation: castleGlow 4s ease-in-out infinite alternate;
        }

        @keyframes castleGlow {
            0% { 
                filter: drop-shadow(0 20px 40px rgba(0,0,0,0.6)) 
                        drop-shadow(0 0 30px rgba(135,206,235,0.4))
                        drop-shadow(0 0 60px rgba(255,215,0,0.2)); 
            }
            100% { 
                filter: drop-shadow(0 20px 40px rgba(0,0,0,0.6)) 
                        drop-shadow(0 0 60px rgba(135,206,235,0.8))
                        drop-shadow(0 0 100px rgba(255,215,0,0.5)); 
            }
        }

        /* 魔法粒子效果 */
        .magic-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ffd700;
            border-radius: 50%;
            animation: particleFloat 4s infinite ease-in-out;
            box-shadow: 0 0 10px #ffd700;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(1);
                opacity: 0;
            }
        }

        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .star {
            position: absolute;
            color: #ffd700;
            animation: starTwinkle 3s infinite;
            text-shadow: 0 0 10px #ffd700;
        }

        @keyframes starTwinkle {
            0%, 100% { 
                opacity: 0.3; 
                transform: scale(1) rotate(0deg);
                text-shadow: 0 0 5px #ffd700;
            }
            50% { 
                opacity: 1; 
                transform: scale(1.3) rotate(180deg);
                text-shadow: 0 0 20px #ffd700, 0 0 30px #ffd700;
            }
        }

        .magic-text {
            color: white;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-top: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            animation: magicTextEntrance 0.8s ease-out 0.5s forwards, textGlow 2s ease-in-out 1.3s infinite alternate;
            opacity: 0;
            transform: translateY(50px);
        }

        @keyframes magicTextEntrance {
            0% {
                opacity: 0;
                transform: translateY(50px) scale(0.5);
                filter: blur(10px);
            }
            50% {
                opacity: 0.7;
                transform: translateY(10px) scale(1.1);
                filter: blur(2px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0px);
            }
        }

        @keyframes textGlow {
            from { 
                text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 
                            0 0 30px rgba(135,206,235,0.6),
                            0 0 60px rgba(255,255,255,0.4);
                color: white;
            }
            to { 
                text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 
                            0 0 60px rgba(135,206,235,1),
                            0 0 100px rgba(255,215,0,0.8),
                            0 0 150px rgba(255,215,0,0.4);
                color: #87ceeb;
            }
        }

        .magic-subtitle {
            color: #b8d4f0;
            font-size: 1.2rem;
            text-align: center;
            margin-top: 1rem;
            opacity: 0;
            animation: subtitleEntrance 0.5s ease-out 1s forwards;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }

        @keyframes subtitleEntrance {
            0% { 
                opacity: 0; 
                transform: translateY(30px) scale(0.8);
                filter: blur(5px);
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1);
                filter: blur(0px);
            }
        }

        .fireworks {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }

        .firework {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: fireworkBurst 2s ease-out;
            box-shadow: 0 0 10px currentColor;
        }

        @keyframes fireworkBurst {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            20% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(3);
                opacity: 0;
            }
        }

        /* 魔法光環效果 */
        .magic-ring {
            position: absolute;
            width: 200px;
            height: 200px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: magicRingPulse 4s ease-in-out infinite;
        }

        @keyframes magicRingPulse {
            0%, 100% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.3;
                border-color: rgba(255, 215, 0, 0.3);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 0.8;
                border-color: rgba(255, 215, 0, 0.8);
            }
        }

        .loading-dots {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 1.5rem;
        }

        .loading-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            margin: 0 4px;
            animation: magicDotBounce 1.6s infinite ease-in-out both;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
        }

        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }
        .loading-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes magicDotBounce {
            0%, 80%, 100% {
                transform: scale(0);
                box-shadow: 0 0 5px rgba(255, 215, 0, 0.3);
            }
            40% {
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            }
        }

        /* 魔法過渡效果樣式 */
        .magic-transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, rgba(26, 26, 46, 0.95) 0%, rgba(22, 33, 62, 0.95) 30%, rgba(15, 52, 96, 0.95) 60%, rgba(83, 52, 131, 0.95) 100%);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            animation: magicFadeIn 0.5s ease-out;
            overflow: hidden;
        }

        @keyframes magicFadeIn {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes magicFadeOut {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(1.2); }
        }

        /* 魔法圓圈擴散動畫 */
        .magic-circle-container {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .magic-circle {
            position: absolute;
            border: 3px solid rgba(255, 215, 0, 0.6);
            border-radius: 50%;
            animation: magicCircleExpand 3s ease-out infinite;
        }

        .magic-circle-1 {
            width: 100px;
            height: 100px;
            animation-delay: 0s;
            border-color: rgba(255, 215, 0, 0.8);
        }

        .magic-circle-2 {
            width: 200px;
            height: 200px;
            animation-delay: 0.5s;
            border-color: rgba(135, 206, 235, 0.6);
        }

        .magic-circle-3 {
            width: 300px;
            height: 300px;
            animation-delay: 1s;
            border-color: rgba(255, 105, 180, 0.4);
        }

        @keyframes magicCircleExpand {
            0% {
                transform: scale(0);
                opacity: 1;
                border-width: 5px;
            }
            50% {
                opacity: 0.8;
                border-width: 3px;
            }
            100% {
                transform: scale(3);
                opacity: 0;
                border-width: 1px;
            }
        }

        /* 魔法文字動畫 */
        .magic-transition-text {
            position: relative;
            z-index: 10;
            text-align: center;
        }

        .magic-text-line {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 1rem 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8), 0 0 30px rgba(255,215,0,0.6);
            animation: magicTextAppear 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(30px) scale(0.8);
        }

        .magic-text-delay-1 {
            animation-delay: 0.8s;
        }

        .magic-text-delay-2 {
            animation-delay: 1.6s;
        }

        @keyframes magicTextAppear {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.8);
                filter: blur(10px);
            }
            50% {
                opacity: 0.8;
                transform: translateY(10px) scale(1.1);
                filter: blur(2px);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                filter: blur(0px);
            }
        }

        /* 魔法光束效果 */
        .magic-beams {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .magic-beam {
            position: absolute;
            width: 2px;
            height: 100%;
            background: linear-gradient(to bottom, transparent, rgba(255, 215, 0, 0.8), transparent);
            animation: magicBeamRotate 4s linear infinite;
            transform-origin: center center;
        }

        .magic-beam-1 {
            left: 50%;
            animation-delay: 0s;
            background: linear-gradient(to bottom, transparent, rgba(255, 215, 0, 0.8), transparent);
        }

        .magic-beam-2 {
            left: 50%;
            animation-delay: 1s;
            background: linear-gradient(to bottom, transparent, rgba(135, 206, 235, 0.6), transparent);
        }

        .magic-beam-3 {
            left: 50%;
            animation-delay: 2s;
            background: linear-gradient(to bottom, transparent, rgba(255, 105, 180, 0.6), transparent);
        }

        .magic-beam-4 {
            left: 50%;
            animation-delay: 3s;
            background: linear-gradient(to bottom, transparent, rgba(152, 251, 152, 0.6), transparent);
        }

        @keyframes magicBeamRotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 魔法粒子動畫 */
        .magic-particles-container {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .magic-transition-particle {
            position: absolute;
            border-radius: 50%;
            animation: magicParticleFloat 3s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes magicParticleFloat {
            0% {
                transform: translateY(0) scale(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: translateY(-20px) scale(1) rotate(45deg);
            }
            50% {
                opacity: 1;
                transform: translateY(-100px) scale(1.2) rotate(180deg);
            }
            90% {
                opacity: 1;
                transform: translateY(-200px) scale(0.8) rotate(315deg);
            }
            100% {
                transform: translateY(-300px) scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        /* 魔法星星雨效果 */
        .magic-star-rain {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .magic-falling-star {
            position: absolute;
            top: -50px;
            animation: magicStarFall 3s linear infinite;
            text-shadow: 0 0 10px currentColor;
            pointer-events: none;
        }

        @keyframes magicStarFall {
            0% {
                transform: translateY(-50px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(calc(100vh + 50px)) rotate(360deg);
                opacity: 0;
            }
        }
    </style>

<style>
@media (max-width: 768px) {
  h2.section-title, h3.section-title, h4.section-title {
    font-size: 1.1rem !important;
    line-height: 1.4 !important;
    text-align: center;
  }
  .section-title {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.4rem;
    font-size: 1rem !important;
  }
}
</style>


<style>
/* 三個標題一排 */
.section-title-group {
  display: flex;
  justify-content: center;
  gap: 1.2rem;
  font-size: 1.4rem;
  margin: 1rem 0;
}
@media (max-width: 768px) {
  .section-title-group {
    font-size: 1rem;
    gap: 0.6rem;
    flex-wrap: nowrap;
  }
}

/* 魔法測驗卡片手機縮小 */
@media (max-width: 768px) {
  #quizPage .card-shadow,
  #birthdayPage .card-shadow {
    max-width: 95%;
    margin: 0 auto;
    padding: 1rem;
    transform: scale(0.95);
  }
}
</style>


<style>
@media (max-width: 768px) {
  #magicStartButton {
    font-size: 0.9rem;
    padding: 0.6rem 1rem;
    border-radius: 12px;
    width: auto;
    min-width: 60%;
    margin: 0 auto;
    display: block;
  }
}
</style>


<style>
/* 移除描述，只保留標題 */
.section-card p,
.section-card .details,
.section-card .recommend {
  display: none !important;
}

/* 手機版更利索 */
@media (max-width: 768px) {
  .section-card {
    padding: 0.8rem 1rem;
    margin: 0.4rem 0;
    font-size: 1rem;
    text-align: center;
  }
  .section-card h3 {
    font-size: 1.1rem;
    margin: 0;
  }
}
</style>


<style>
/* === UI 縮小版：字級與間距微調 === */
/* 開場頁主標題（我會魔法，你相信嗎？） */
#introPage h1 { font-size: 1.5rem !important; line-height: 1.3 !important; margin-bottom: 1rem !important; }

/* 三個小卡（🔮/✨/🌟）的 emoji 與標題字級 */
#introPage .grid.grid-cols-3 .text-3xl { font-size: 1.4rem !important; }     /* emoji */
#introPage .grid.grid-cols-3 .text-base { font-size: 0.95rem !important; }   /* 標題文字 */
#introPage .grid.grid-cols-3 { gap: 0.75rem !important; }

/* 魔法歡迎字與副標 */
.magic-text { font-size: 1.5rem !important; }
.magic-subtitle { font-size: 1rem !important; }

/* 開場頁卡片與內距縮小一些 */
#introPage .card-shadow { padding: 1.5rem !important; }
#introPage .bg-gradient-to-br.p-6 { padding: 0.9rem !important; }

/* 頂部圓形圖示縮小 */
#introPage .number-circle { width: 6rem !important; height: 6rem !important; }
#introPage .number-circle span { font-size: 2rem !important; }

/* 進入測驗按鈕字級與內距縮小 */
#magicStartButton { font-size: 1rem !important; padding: 0.75rem 1.25rem !important; }
#magicStartButton .text-3xl { font-size: 1.25rem !important; } /* 按鈕內左右兩顆表情符號也同步縮小 */

/* 手機端再更精緻一點 */
@media (max-width: 768px) {
  #introPage h1 { font-size: 1.25rem !important; }
  .magic-text { font-size: 1.25rem !important; }
  .magic-subtitle { font-size: 0.95rem !important; }
  #introPage .number-circle { width: 5.25rem !important; height: 5.25rem !important; }
  #introPage .number-circle span { font-size: 1.6rem !important; }
  #magicStartButton { font-size: 0.95rem !important; padding: 0.6rem 1rem !important; }
}
</style>


<style>
/* === 神秘段落：更小、更工整的排版 === */
#introPage .leading-relaxed.text-base { font-size: 0.95rem !important; line-height: 1.65 !important; letter-spacing: 0.02em !important; }
#introPage .flex.items-start.space-x-3 { gap: 0.5rem !important; }
#introPage .flex.items-start .text-2xl { font-size: 1.25rem !important; line-height: 1.2 !important; }
#introPage .flex.items-start p { margin: 0 !important; padding: 0 !important; }
#introPage .flex.items-start + .flex.items-start { margin-top: 0.35rem !important; }

/* 手機微調 */
@media (max-width: 768px) {
  #introPage .leading-relaxed.text-base { font-size: 0.92rem !important; line-height: 1.7 !important; }
  #introPage .flex.items-start .text-2xl { font-size: 1.1rem !important; }
  #introPage .flex.items-start.space-x-3 { gap: 0.45rem !important; }
}
</style>


<style>
/* === 背景音樂（自動播放）UI === */
.audio-toggle{
  position: fixed;
  right: max(12px, env(safe-area-inset-right));
  bottom: calc(12px + env(safe-area-inset-bottom));
  width: 52px; height: 52px;
  border-radius: 9999px;
  background: rgba(255,255,255,0.85);
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255,255,255,0.4);
  box-shadow: 0 10px 25px rgba(0,0,0,.25);
  display: grid; place-items: center;
  z-index: 9999;
  transition: transform .15s ease, filter .2s ease, box-shadow .25s ease;
}
.audio-toggle:hover{ transform: translateY(-1px); filter: brightness(1.05); }
.audio-toggle:active{ transform: translateY(0); filter: brightness(.98); }
.audio-toggle:focus-visible{
  outline: 3px solid rgba(158,197,255,0.6); outline-offset: 2px;
  border-radius: 9999px;
}
.audio-toggle .icon{ font-size: 20px; }

#soundToast{
  position: fixed;
  left: 50%; transform: translateX(-50%);
  bottom: calc(76px + env(safe-area-inset-bottom));
  background: rgba(0,0,0,0.6); color: #fff;
  padding: 10px 14px; border-radius: 999px;
  font-weight: 700; letter-spacing: .2px;
  opacity: 0; pointer-events: none;
  transition: opacity .25s ease; z-index: 9998;
}
#soundToast.show{ opacity: 1; }

/* 鍵盤彈出時避免遮擋（行動裝置） */
body.keyboard-open .audio-toggle{ transform: translateY(80px); opacity:.85; pointer-events:none; }

@media (prefers-reduced-motion: reduce){
  .audio-toggle{ transition: none; }
}
</style>
</head>
<body class="start-page-bg min-h-screen">
    <!-- 迪士尼城堡開場動畫 -->
    <div id="disneyIntro" class="disney-intro">
        <!-- 流星雨背景 -->
        <div class="shooting-stars" id="shootingStarsContainer"></div>
        
        <!-- 雲朵背景 -->
        <div class="clouds">
            <div class="cloud cloud1"></div>
            <div class="cloud cloud2"></div>
            <div class="cloud cloud3"></div>
        </div>
        
        <!-- 魔法光環 -->
        <div class="magic-ring"></div>
        
        <!-- 魔法粒子 -->
        <div class="magic-particles" id="particlesContainer"></div>
        
        <!-- 星星背景 -->
        <div class="stars">
            <div class="star" style="top: 15%; left: 10%; font-size: 1.8rem; animation-delay: 0s;">✨</div>
            <div class="star" style="top: 25%; left: 85%; font-size: 1.2rem; animation-delay: 0.5s;">⭐</div>
            <div class="star" style="top: 45%; left: 5%; font-size: 1.5rem; animation-delay: 1s;">✨</div>
            <div class="star" style="top: 65%; left: 90%; font-size: 1rem; animation-delay: 1.5s;">⭐</div>
            <div class="star" style="top: 10%; left: 60%; font-size: 1.3rem; animation-delay: 0.3s;">✨</div>
            <div class="star" style="top: 75%; left: 30%; font-size: 1.6rem; animation-delay: 0.8s;">⭐</div>
            <div class="star" style="top: 35%; left: 75%; font-size: 1.1rem; animation-delay: 2s;">✨</div>
            <div class="star" style="top: 55%; left: 15%; font-size: 1.4rem; animation-delay: 2.5s;">⭐</div>
        </div>
        
        <!-- 煙火效果 -->
        <div class="fireworks" id="fireworksContainer"></div>
        
        <!-- 城堡主體 -->
        <div class="castle-container">
            <svg class="castle-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <!-- 城堡基座 -->
                <rect x="40" y="120" width="120" height="60" fill="url(#castleGradient)" stroke="#654321" stroke-width="2"/>
                
                <!-- 主塔 -->
                <rect x="80" y="80" width="40" height="60" fill="url(#towerGradient)" stroke="#A0522D" stroke-width="2"/>
                
                <!-- 左塔 -->
                <rect x="50" y="90" width="25" height="50" fill="url(#towerGradient)" stroke="#A0522D" stroke-width="2"/>
                
                <!-- 右塔 -->
                <rect x="125" y="90" width="25" height="50" fill="url(#towerGradient)" stroke="#A0522D" stroke-width="2"/>
                
                <!-- 主塔屋頂 -->
                <polygon points="75,80 100,50 125,80" fill="url(#roofGradient)" stroke="#191970" stroke-width="2"/>
                
                <!-- 左塔屋頂 -->
                <polygon points="47,90 62.5,70 78,90" fill="url(#roofGradient)" stroke="#191970" stroke-width="2"/>
                
                <!-- 右塔屋頂 -->
                <polygon points="122,90 137.5,70 153,90" fill="url(#roofGradient)" stroke="#191970" stroke-width="2"/>
                
                <!-- 城門 -->
                <path d="M 90 120 Q 90 110 100 110 Q 110 110 110 120 L 110 140 L 90 140 Z" fill="#654321" stroke="#4A4A4A" stroke-width="2"/>
                
                <!-- 窗戶發光效果 -->
                <rect x="85" y="95" width="8" height="12" fill="url(#windowGlow)" stroke="#FFA500" stroke-width="1"/>
                <rect x="107" y="95" width="8" height="12" fill="url(#windowGlow)" stroke="#FFA500" stroke-width="1"/>
                <rect x="57" y="105" width="6" height="10" fill="url(#windowGlow)" stroke="#FFA500" stroke-width="1"/>
                <rect x="132" y="105" width="6" height="10" fill="url(#windowGlow)" stroke="#FFA500" stroke-width="1"/>
                
                <!-- 旗幟 -->
                <line x1="100" y1="50" x2="100" y2="35" stroke="#8B4513" stroke-width="2"/>
                <polygon points="100,35 115,40 100,45" fill="url(#flagGradient)"/>
                
                <!-- 裝飾星星 -->
                <text x="100" y="30" text-anchor="middle" fill="#FFD700" font-size="14" style="filter: drop-shadow(0 0 5px #FFD700);">✨</text>
                
                <!-- 漸層定義 -->
                <defs>
                    <linearGradient id="castleGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#D2691E;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#8B4513;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="towerGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#F4A460;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#D2691E;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="roofGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#6495ED;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#4169E1;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="windowGlow" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#FFFF99;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#FFD700;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="flagGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#FF69B4;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#FF1493;stop-opacity:1" />
                    </linearGradient>
                </defs>
            </svg>
        </div>
        
        <!-- 魔法文字 -->
        <div class="magic-text">
            ✨ 歡迎來到生命密碼國度 ✨
        </div>
        
        <div class="magic-subtitle">
            準備開啟你的魔法之旅...
        </div>
        
        <!-- 載入動畫 -->
        <div class="loading-dots">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8">
        <!-- 魔法開場白頁面 -->
        <div id="introPage" class="max-w-4xl mx-auto text-center fade-in">
            <div class="bg-white bg-opacity-95 backdrop-blur-sm rounded-3xl p-8 card-shadow border border-white border-opacity-20">
                <div class="mb-8">
                    <div class="w-32 h-32 mx-auto mb-8 rounded-full number-circle flex items-center justify-center">
                        <span class="text-5xl font-bold text-purple-800">🔮</span>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-800 mb-8 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">我會魔法，你相信嗎？</h1>
                    
                    <!-- 魔法開場白 -->
                    <div class="bg-gradient-to-br from-purple-50 to-indigo-50 p-6 rounded-3xl mb-8 border-2 border-purple-200 shadow-lg">
                        <div class="text-left space-y-4 text-gray-700 leading-relaxed text-base">
                            <div class="flex items-start space-x-3">
                                <span class="text-2xl">🌙</span>
                                <p>在這片日常看似平凡的世界裡，其實藏著一條只有少數人能看見的隱密通道。那是一扇通往心靈深處的門，門後的每一道光影，都是你靈魂密碼的線索。</p>
                            </div>
                            
                            <div class="flex items-start space-x-3">
                                <span class="text-2xl">✨</span>
                                <p>今晚，你將化身為旅人，踏上這場神秘的探索之旅。沒有水晶球，也沒有占卜卡，只有你內心最真實的選擇，將一步一步拼湊出屬於你的「生密碼」。</p>
                            </div>
                            
                            <div class="text-center mt-6 p-4 bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl border border-purple-300">
                                <p class="text-purple-700 font-bold text-lg">你/妳準備好了嗎？</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 魔法元素裝飾 -->
                    <div class="grid grid-cols-3 gap-4 mb-8">
                        <div class="bg-gradient-to-br from-purple-100 to-purple-200 p-4 rounded-2xl transform hover:scale-105 transition-transform">
                            <div class="text-3xl mb-2">🔮</div>
                            <div class="text-base font-bold text-purple-800">神秘預言</div>
                        </div>
                        <div class="bg-gradient-to-br from-pink-100 to-pink-200 p-4 rounded-2xl transform hover:scale-105 transition-transform">
                            <div class="text-3xl mb-2">✨</div>
                            <div class="text-base font-bold text-pink-800">魔法解析</div>
                        </div>
                        <div class="bg-gradient-to-br from-indigo-100 to-indigo-200 p-4 rounded-2xl transform hover:scale-105 transition-transform">
                            <div class="text-3xl mb-2">🌟</div>
                            <div class="text-base font-bold text-indigo-800">未來指引</div>
                        </div>
                    </div>
                </div>
                
                <div class="relative">
                    <button id="magicStartButton" onclick="enterTestInterface()" class="relative bg-gradient-to-r from-purple-600 via-pink-600 to-indigo-600 text-white px-16 py-6 rounded-full text-2xl font-bold hover:from-purple-700 hover:via-pink-700 hover:to-indigo-700 transform hover:scale-110 transition-all duration-500 shadow-2xl overflow-hidden group">
                        <!-- 魔法光效背景 -->
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-0 group-hover:opacity-30 transform -skew-x-12 group-hover:translate-x-full transition-all duration-1000 ease-out"></div>
                        
                        <!-- 魔法粒子效果 -->
                        <div class="absolute inset-0 overflow-hidden rounded-full">
                            <div class="magic-particle absolute w-2 h-2 bg-yellow-300 rounded-full animate-ping" style="top: 20%; left: 15%; animation-delay: 0s;"></div>
                            <div class="magic-particle absolute w-2 h-2 bg-blue-300 rounded-full animate-ping" style="top: 60%; left: 80%; animation-delay: 0.5s;"></div>
                            <div class="magic-particle absolute w-2 h-2 bg-pink-300 rounded-full animate-ping" style="top: 40%; left: 30%; animation-delay: 1s;"></div>
                            <div class="magic-particle absolute w-2 h-2 bg-purple-300 rounded-full animate-ping" style="top: 70%; left: 60%; animation-delay: 1.5s;"></div>
                        </div>
                        
                        <!-- 按鈕文字 -->
                        <span class="relative z-10 flex items-center justify-center">
                            <span class="mr-4 text-3xl animate-bounce">🌟</span>
                            進入魔法測驗
                            <span class="ml-4 text-3xl animate-bounce" style="animation-delay: 0.5s;">✨</span>
                        </span>
                        
                        <!-- 魔法邊框 -->
                        <div class="absolute inset-0 rounded-full border-3 border-yellow-300 opacity-0 group-hover:opacity-100 animate-pulse"></div>
                    </button>
                    
                    <!-- 環繞魔法效果 -->
                    <div class="absolute -inset-6 opacity-0 hover:opacity-100 transition-opacity duration-500 pointer-events-none">
                        <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-3 text-yellow-400 animate-bounce text-2xl">⭐</div>
                        <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-3 text-pink-400 animate-bounce text-2xl" style="animation-delay: 0.3s;">💫</div>
                        <div class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-3 text-purple-400 animate-bounce text-2xl" style="animation-delay: 0.6s;">✨</div>
                        <div class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-3 text-blue-400 animate-bounce text-2xl" style="animation-delay: 0.9s;">🌟</div>
                    </div>
                </div>
            </div>
        </div>



        <!-- 生日輸入階段 -->
        <div id="birthdayPage" class="max-w-2xl mx-auto text-center hidden fade-in">
            <div class="bg-white bg-opacity-95 backdrop-blur-sm rounded-3xl p-8 card-shadow border border-white border-opacity-20">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">輸入你的生日</h2>
                <p class="text-gray-600 mb-8">讓我們從你的生日開始，計算你的生命密碼<br>
                <span class="text-sm text-purple-600">接下來將有13個多元化問題，幫助我們更深入了解你</span></p>
                
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div>
                        <label class="block text-left text-gray-700 font-medium mb-3">你的姓名：</label>
                        <input type="text" id="nameInput" placeholder="請輸入你的姓名" class="w-full p-4 border-2 border-gray-200 rounded-xl text-lg focus:border-purple-500 focus:outline-none transition-colors">
                    </div>
                    <div>
                        <label class="block text-left text-gray-700 font-medium mb-3">性別：</label>
                        <select id="genderSelect" class="w-full p-4 border-2 border-gray-200 rounded-xl text-lg focus:border-purple-500 focus:outline-none transition-colors">
                            <option value="">請選擇性別</option>
                            <option value="male">男性 👨</option>
                            <option value="female">女性 👩</option>
                        </select>
                    </div>
                </div>
                
                <div class="mb-8">
                    <label class="block text-left text-gray-700 font-medium mb-3">選擇你的生日：</label>
                    <input type="date" id="birthdayInput" class="w-full p-4 border-2 border-gray-200 rounded-xl text-lg focus:border-purple-500 focus:outline-none transition-colors">
                </div>
                
                <div id="lifeNumberDisplay" class="hidden mb-8">
                    <div class="bg-gradient-to-r from-purple-100 to-pink-100 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold text-gray-800 mb-3">你的生命密碼</h3>
                        <div class="flex justify-center space-x-4">
                            <div class="text-center">
                                <div class="w-16 h-16 bg-purple-600 text-white rounded-full flex items-center justify-center text-2xl font-bold mb-2">
                                    <span id="mainLifeNumber"></span>
                                </div>
                                <div class="text-sm text-gray-600">主要密碼</div>
                            </div>
                            <div class="text-center">
                                <div class="w-16 h-16 bg-blue-600 text-white rounded-full flex items-center justify-center text-2xl font-bold mb-2">
                                    <span id="yearNumber"></span>
                                </div>
                                <div class="text-sm text-gray-600">今年運勢</div>
                            </div>
                            <div class="text-center">
                                <div class="w-16 h-16 bg-green-600 text-white rounded-full flex items-center justify-center text-2xl font-bold mb-2">
                                    <span id="monthNumber"></span>
                                </div>
                                <div class="text-sm text-gray-600">本月運勢</div>
                            </div>
                            <div class="text-center">
                                <div class="w-16 h-16 bg-orange-600 text-white rounded-full flex items-center justify-center text-2xl font-bold mb-2">
                                    <span id="dayNumber"></span>
                                </div>
                                <div class="text-sm text-gray-600">今日運勢</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button onclick="proceedToQuestions()" id="proceedBtn" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-4 rounded-full text-lg font-semibold hover:from-purple-700 hover:to-pink-700 transform hover:scale-105 transition-all duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    開始13題心理測驗 →
                </button>
            </div>
        </div>

        <!-- 問題階段 -->
        <div id="questionsPage" class="max-w-2xl mx-auto hidden fade-in">
            <div class="bg-white bg-opacity-95 backdrop-blur-sm rounded-3xl p-8 card-shadow border border-white border-opacity-20">
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">心理探索問題</h2>
                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">
                            <span id="currentQuestion">1</span> / 13
                        </span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progressBar" class="bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full transition-all duration-500" style="width: 33.33%"></div>
                    </div>
                </div>
                
                <div id="questionContainer">
                    <div class="question-item mb-8">
                        <h3 class="text-xl font-semibold text-gray-800 mb-6" id="questionText">在面對困難時，你通常會？</h3>
                        <div class="space-y-3" id="optionsContainer">
                            <!-- 選項會動態生成 -->
                        </div>
                    </div>
                </div>
                
                <!-- 移除下一題按鈕，選擇後直接進入下一題 -->
            </div>
        </div>

        <!-- 結果頁 -->
        <div id="resultPage" class="max-w-4xl mx-auto hidden fade-in">
            <div class="bg-white bg-opacity-95 backdrop-blur-sm rounded-3xl p-8 card-shadow border border-white border-opacity-20">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">你的專屬生命密碼解析</h2>
                    <div class="flex justify-center items-center mb-6">
                        <div class="text-center">
                            <div id="finalLifeNumberCircle" class="w-24 h-24 bg-gradient-to-br from-purple-600 to-pink-600 text-white rounded-full flex items-center justify-center text-4xl font-bold number-circle mb-3">
                                <span id="finalLifeNumber"></span>
                            </div>
                            <div class="text-lg font-semibold text-gray-700">
                                <span id="numberColorName"></span>能量
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 運勢詳情 -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl text-center">
                        <div class="w-12 h-12 bg-purple-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-2">
                            <span id="displayMainNumber"></span>
                        </div>
                        <div class="text-sm font-medium text-purple-800 mb-1">主要密碼</div>
                        <div class="text-xs text-purple-600" id="mainNumberMeaning"></div>
                    </div>
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl text-center">
                        <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-2">
                            <span id="displayYearNumber"></span>
                        </div>
                        <div class="text-sm font-medium text-blue-800 mb-1">今年運勢</div>
                        <div class="text-xs text-blue-600" id="yearNumberMeaning"></div>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center">
                        <div class="w-12 h-12 bg-green-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-2">
                            <span id="displayMonthNumber"></span>
                        </div>
                        <div class="text-sm font-medium text-green-800 mb-1">本月運勢</div>
                        <div class="text-xs text-green-600" id="monthNumberMeaning"></div>
                    </div>
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-4 rounded-xl text-center">
                        <div class="w-12 h-12 bg-orange-600 text-white rounded-full flex items-center justify-center text-xl font-bold mx-auto mb-2">
                            <span id="displayDayNumber"></span>
                        </div>
                        <div class="text-sm font-medium text-orange-800 mb-1">今日運勢</div>
                        <div class="text-xs text-orange-600" id="dayNumberMeaning"></div>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8 mb-8">
                    <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">🌟 性格特質</h3>
                        <p id="personalityText" class="text-gray-700 leading-relaxed"></p>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">🎯 人生方向</h3>
                        <p id="directionText" class="text-gray-700 leading-relaxed"></p>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
                    <div class="bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-xl text-center">
                        <div class="text-2xl mb-2">❤️</div>
                        <div class="text-sm font-medium text-red-800 mb-2">健康</div>
                        <div class="text-xs text-red-600" id="healthAdvice"></div>
                    </div>
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl text-center">
                        <div class="text-2xl mb-2">🌟</div>
                        <div class="text-sm font-medium text-blue-800 mb-2">生活</div>
                        <div class="text-xs text-blue-600" id="lifeAdvice"></div>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center">
                        <div class="text-2xl mb-2">👥</div>
                        <div class="text-sm font-medium text-green-800 mb-2">人際</div>
                        <div class="text-xs text-green-600" id="relationshipAdvice"></div>
                    </div>
                    <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-xl text-center">
                        <div class="text-2xl mb-2">💰</div>
                        <div class="text-sm font-medium text-yellow-800 mb-2">財富</div>
                        <div class="text-xs text-yellow-600" id="wealthAdvice"></div>
                    </div>
                    <div class="bg-gradient-to-br from-pink-50 to-pink-100 p-4 rounded-xl text-center cursor-pointer hover:shadow-lg transition-shadow" onclick="toggleBeautyDetails()">
                        <div class="text-2xl mb-2" id="beautyIcon">💄</div>
                        <div class="text-sm font-medium text-pink-800 mb-2" id="beautyTitle">美容</div>
                        <div class="text-xs text-pink-600" id="beautyAdvice"></div>
                        <div class="text-xs text-pink-500 mt-2">點擊查看詳細建議 ↓</div>
                    </div>
                </div>
                
                <!-- 詳細美容造型分析區塊 -->
                <div id="beautyDetailsSection" class="mb-8 hidden">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">💄 專屬美容造型完整分析</h3>
                    <div class="bg-gradient-to-br from-pink-50 to-rose-50 p-8 rounded-3xl border-2 border-pink-200 shadow-lg">
                        <div class="grid md:grid-cols-2 gap-8">
                            <!-- 左側：基本資訊和風格分析 -->
                            <div class="space-y-6">
                                <div class="bg-white bg-opacity-80 p-6 rounded-2xl shadow-sm">
                                    <div class="flex items-center mb-4">
                                        <span class="text-3xl mr-4" id="detailedBeautyIcon">💄</span>
                                        <div>
                                            <h4 class="text-xl font-bold text-pink-800" id="detailedBeautyTitle">美容造型分析</h4>
                                            <div class="text-sm text-pink-600">根據你的生命密碼和測驗答案</div>
                                        </div>
                                    </div>
                                    <div class="text-sm text-gray-700 leading-relaxed" id="detailedBeautyDescription"></div>
                                </div>
                                
                                <div class="bg-white bg-opacity-80 p-6 rounded-2xl shadow-sm">
                                    <h5 class="text-lg font-semibold text-pink-800 mb-3">🎨 個人風格特色</h5>
                                    <div class="text-sm text-gray-700 leading-relaxed" id="personalStyleAnalysis"></div>
                                </div>
                            </div>
                            
                            <!-- 右側：具體建議 -->
                            <div class="space-y-4">
                                <div class="bg-white bg-opacity-80 p-4 rounded-xl shadow-sm" id="hairStyleSection">
                                    <h6 class="text-md font-semibold text-pink-800 mb-2 flex items-center">
                                        <span class="mr-2">💇‍♀️</span>髮型建議
                                    </h6>
                                    <div class="text-sm text-gray-700" id="hairStyleAdvice"></div>
                                </div>
                                
                                <div class="bg-white bg-opacity-80 p-4 rounded-xl shadow-sm" id="hairColorSection">
                                    <h6 class="text-md font-semibold text-pink-800 mb-2 flex items-center">
                                        <span class="mr-2">🎨</span>髮色推薦
                                    </h6>
                                    <div class="text-sm text-gray-700" id="hairColorAdvice"></div>
                                </div>
                                
                                <div class="bg-white bg-opacity-80 p-4 rounded-xl shadow-sm" id="makeupSection">
                                    <h6 class="text-md font-semibold text-pink-800 mb-2 flex items-center">
                                        <span class="mr-2">💄</span>妝容風格
                                    </h6>
                                    <div class="text-sm text-gray-700" id="makeupAdvice"></div>
                                </div>
                                
                                <div class="bg-white bg-opacity-80 p-4 rounded-xl shadow-sm" id="skincareSection">
                                    <h6 class="text-md font-semibold text-pink-800 mb-2 flex items-center">
                                        <span class="mr-2">🧴</span>保養重點
                                    </h6>
                                    <div class="text-sm text-gray-700" id="skincareAdvice"></div>
                                </div>
                                
                                <div class="bg-white bg-opacity-80 p-4 rounded-xl shadow-sm" id="colorSection">
                                    <h6 class="text-md font-semibold text-pink-800 mb-2 flex items-center">
                                        <span class="mr-2">🌈</span>適合色系
                                    </h6>
                                    <div class="text-sm text-gray-700" id="colorAdvice"></div>
                                </div>
                                
                                <div class="bg-white bg-opacity-80 p-4 rounded-xl shadow-sm" id="productSection">
                                    <h6 class="text-md font-semibold text-pink-800 mb-2 flex items-center">
                                        <span class="mr-2">🛍️</span>產品推薦
                                    </h6>
                                    <div class="text-sm text-gray-700" id="productAdvice"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 底部：個人化建議總結 -->
                        <div class="mt-8 bg-gradient-to-r from-pink-100 to-rose-100 p-6 rounded-2xl border border-pink-300">
                            <h5 class="text-lg font-semibold text-pink-800 mb-3 text-center">✨ 專屬造型建議總結</h5>
                            <div class="text-sm text-pink-700 leading-relaxed text-center" id="beautySummary"></div>
                        </div>
                        
                        <div class="text-center mt-6">
                            <button onclick="toggleBeautyDetails()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-6 py-3 rounded-full text-sm font-semibold hover:from-pink-600 hover:to-rose-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
                                收起詳細分析 ↑
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 數字組合特殊分析 -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">🔢 數字組合特殊分析</h3>
                    <div id="numberCombinationSection" class="grid md:grid-cols-2 gap-6">
                        <!-- 數字組合分析內容會動態生成 -->
                    </div>
                </div>
                
                <!-- 迪士尼角色分析 -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">🏰 迪士尼角色對應分析</h3>
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-gradient-to-br from-pink-50 to-rose-50 p-6 rounded-xl">
                            <div class="flex items-center mb-4">
                                <span id="disneyCharacterIcon" class="text-4xl mr-4">👸</span>
                                <div>
                                    <h4 class="text-lg font-semibold text-pink-800" id="disneyCharacterName">白雪公主</h4>
                                    <div class="text-sm text-pink-600" id="disneyCharacterMovie">白雪公主與七個小矮人</div>
                                </div>
                            </div>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-pink-800 mb-1">✨ 角色特質</div>
                                    <div class="text-xs text-pink-700" id="disneyCharacterTraits"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-pink-800 mb-1">🎯 人生課題</div>
                                    <div class="text-xs text-pink-700" id="disneyLifeLesson"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl">
                            <h4 class="text-lg font-semibold text-blue-800 mb-4">🌟 多元化角色分析</h4>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-blue-800 mb-1" id="diversityAnalysisTitle">性格相似度</div>
                                    <div class="text-xs text-blue-700" id="diversityAnalysisContent"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-blue-800 mb-1">🎭 其他相似角色</div>
                                    <div class="text-xs text-blue-700" id="similarCharacters"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-blue-800 mb-1">💡 角色啟發</div>
                                    <div class="text-xs text-blue-700" id="characterInspiration"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 星座運勢分析 -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">⭐ 星座運勢專業建議</h3>
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="bg-gradient-to-br from-indigo-50 to-blue-50 p-6 rounded-xl">
                            <div class="flex items-center mb-4">
                                <span id="zodiacIcon" class="text-3xl mr-3">♈</span>
                                <div>
                                    <h4 class="text-lg font-semibold text-indigo-800" id="zodiacName">白羊座</h4>
                                    <div class="text-sm text-indigo-600" id="zodiacDate">3/21 - 4/19</div>
                                </div>
                            </div>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-indigo-800 mb-1">🌟 本月運勢</div>
                                    <div class="text-xs text-indigo-700" id="monthlyFortune"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-indigo-800 mb-1">💼 事業建議</div>
                                    <div class="text-xs text-indigo-700" id="careerAdvice"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-xl">
                            <h4 class="text-lg font-semibold text-purple-800 mb-4">👤 個人化分析</h4>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-purple-800 mb-1" id="genderAnalysisTitle">性格特質</div>
                                    <div class="text-xs text-purple-700" id="genderAnalysisContent"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-purple-800 mb-1">📝 姓名能量</div>
                                    <div class="text-xs text-purple-700" id="nameAnalysis"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-amber-50 to-orange-50 p-6 rounded-xl">
                            <h4 class="text-lg font-semibold text-amber-800 mb-4">🔮 流年流月流日</h4>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-amber-800 mb-1">📅 流年</div>
                                    <div class="text-xs text-amber-700" id="liuNianGanzhi"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-amber-800 mb-1">🌙 流月</div>
                                    <div class="text-xs text-amber-700" id="liuYueGanzhi"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-amber-800 mb-1">☀️ 流日</div>
                                    <div class="text-xs text-amber-700" id="liuRiGanzhi"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 八字命理分析 -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">🔮 八字命理深度分析</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- 日主分析 -->
                        <div class="bg-gradient-to-br from-red-50 to-orange-50 p-6 rounded-xl">
                            <div class="flex items-center mb-4">
                                <span class="text-3xl mr-3">👤</span>
                                <div>
                                    <h4 class="text-lg font-semibold text-red-800">日主分析</h4>
                                    <div class="text-sm text-red-600">你的命理核心</div>
                                </div>
                            </div>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-red-800 mb-1">🌟 日主天干</div>
                                    <div class="text-xs text-red-700" id="baziDayGan"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-red-800 mb-1">🔥 五行屬性</div>
                                    <div class="text-xs text-red-700" id="baziDayWuxing"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-red-800 mb-1">📅 出生干支</div>
                                    <div class="text-xs text-red-700" id="baziBirthGanzhi"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 十神分析 -->
                        <div class="bg-gradient-to-br from-blue-50 to-cyan-50 p-6 rounded-xl">
                            <div class="flex items-center mb-4">
                                <span class="text-3xl mr-3">⚡</span>
                                <div>
                                    <h4 class="text-lg font-semibold text-blue-800">十神運勢</h4>
                                    <div class="text-sm text-blue-600">當前流月流日分析</div>
                                </div>
                            </div>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-blue-800 mb-1">🌙 本月十神</div>
                                    <div class="text-xs text-blue-700" id="baziMonthShishen"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-blue-800 mb-1">☀️ 今日十神</div>
                                    <div class="text-xs text-blue-700" id="baziDayShishen"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-blue-800 mb-1">📈 當前干支</div>
                                    <div class="text-xs text-blue-700" id="baziCurrentGanzhi"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 十神詳細解析 -->
                    <div class="mt-6 grid md:grid-cols-2 gap-6">
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-xl">
                            <h4 class="text-lg font-semibold text-green-800 mb-4">🌙 本月運勢解析</h4>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-green-800 mb-1">✨ 十神含義</div>
                                    <div class="text-xs text-green-700" id="baziMonthMeaning"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-green-800 mb-1">🔮 運勢預測</div>
                                    <div class="text-xs text-green-700" id="baziMonthFortune"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-green-800 mb-1">💡 行動建議</div>
                                    <div class="text-xs text-green-700" id="baziMonthAdvice"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-purple-50 to-violet-50 p-6 rounded-xl">
                            <h4 class="text-lg font-semibold text-purple-800 mb-4">☀️ 今日運勢解析</h4>
                            <div class="space-y-3">
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-purple-800 mb-1">✨ 十神含義</div>
                                    <div class="text-xs text-purple-700" id="baziDayMeaning"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-purple-800 mb-1">🔮 運勢預測</div>
                                    <div class="text-xs text-purple-700" id="baziDayFortune"></div>
                                </div>
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-purple-800 mb-1">💡 行動建議</div>
                                    <div class="text-xs text-purple-700" id="baziDayAdvice"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="startCoupleTest()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-6 py-3 rounded-full text-lg font-semibold hover:from-pink-600 hover:to-rose-600 transform hover:scale-105 transition-all duration-300 shadow-lg mr-4">
                        💕 伴侶契合度測試
                    </button>
                    <button onclick="restartGame()" class="bg-gradient-to-r from-gray-600 to-gray-700 text-white px-6 py-3 rounded-full text-lg font-semibold hover:from-gray-700 hover:to-gray-800 transform hover:scale-105 transition-all duration-300 shadow-lg mr-4">
                        重新探索
                    </button>
                    <button onclick="shareResult()" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-full text-lg font-semibold hover:from-purple-700 hover:to-pink-700 transform hover:scale-105 transition-all duration-300 shadow-lg">
                        分享結果 📱
                    </button>
                </div>
            </div>
        </div>

        <!-- 伴侶契合度測試頁 -->
        <div id="coupleTestPage" class="max-w-4xl mx-auto hidden fade-in">
            <div class="bg-white bg-opacity-95 backdrop-blur-sm rounded-3xl p-8 card-shadow border border-white border-opacity-20">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">💕 伴侶契合度測試</h2>
                    <p class="text-lg text-gray-600">輸入你們的資料，探索彼此的契合度和相處建議</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8 mb-8">
                    <!-- 伴侶A資料 -->
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold text-blue-800 mb-4 text-center">👨 伴侶A</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-blue-700 font-medium mb-2">姓名：</label>
                                <input type="text" id="partnerAName" placeholder="請輸入姓名" class="w-full p-3 border-2 border-blue-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors">
                            </div>
                            <div>
                                <label class="block text-blue-700 font-medium mb-2">性別：</label>
                                <select id="partnerAGender" class="w-full p-3 border-2 border-blue-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors">
                                    <option value="">請選擇性別</option>
                                    <option value="male">男性 👨</option>
                                    <option value="female">女性 👩</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-blue-700 font-medium mb-2">生日：</label>
                                <input type="date" id="partnerABirthday" class="w-full p-3 border-2 border-blue-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 伴侶B資料 -->
                    <div class="bg-gradient-to-br from-pink-50 to-rose-50 p-6 rounded-xl">
                        <h3 class="text-xl font-semibold text-pink-800 mb-4 text-center">👩 伴侶B</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-pink-700 font-medium mb-2">姓名：</label>
                                <input type="text" id="partnerBName" placeholder="請輸入姓名" class="w-full p-3 border-2 border-pink-200 rounded-xl focus:border-pink-500 focus:outline-none transition-colors">
                            </div>
                            <div>
                                <label class="block text-pink-700 font-medium mb-2">性別：</label>
                                <select id="partnerBGender" class="w-full p-3 border-2 border-pink-200 rounded-xl focus:border-pink-500 focus:outline-none transition-colors">
                                    <option value="">請選擇性別</option>
                                    <option value="male">男性 👨</option>
                                    <option value="female">女性 👩</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-pink-700 font-medium mb-2">生日：</label>
                                <input type="date" id="partnerBBirthday" class="w-full p-3 border-2 border-pink-200 rounded-xl focus:border-pink-500 focus:outline-none transition-colors">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="analyzeCoupleCompatibility()" id="analyzeBtn" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-8 py-4 rounded-full text-lg font-semibold hover:from-pink-600 hover:to-rose-600 transform hover:scale-105 transition-all duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed mr-4" disabled>
                        開始分析契合度 💕
                    </button>
                    <button onclick="backToResult()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-3 rounded-full text-lg font-semibold hover:from-gray-600 hover:to-gray-700 transform hover:scale-105 transition-all duration-300 shadow-lg">
                        返回個人結果
                    </button>
                </div>
            </div>
        </div>

        <!-- 伴侶契合度結果頁 -->
        <div id="coupleResultPage" class="max-w-4xl mx-auto hidden fade-in">
            <div class="bg-white bg-opacity-95 backdrop-blur-sm rounded-3xl p-8 card-shadow border border-white border-opacity-20">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">💕 伴侶契合度分析報告</h2>
                    <div class="flex justify-center items-center space-x-8 mb-6">
                        <div class="text-center">
                            <div id="partnerACircle" class="w-20 h-20 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full flex items-center justify-center text-2xl font-bold mb-2">
                                <span id="partnerANumber"></span>
                            </div>
                            <div class="text-sm font-medium text-blue-700" id="partnerADisplayName"></div>
                        </div>
                        <div class="text-center">
                            <div id="compatibilityScore" class="w-24 h-24 bg-gradient-to-br from-pink-500 to-rose-500 text-white rounded-full flex items-center justify-center text-3xl font-bold mb-2">
                                <span id="scoreNumber"></span>%
                            </div>
                            <div class="text-sm font-medium text-pink-700">契合度</div>
                        </div>
                        <div class="text-center">
                            <div id="partnerBCircle" class="w-20 h-20 bg-gradient-to-br from-pink-500 to-pink-600 text-white rounded-full flex items-center justify-center text-2xl font-bold mb-2">
                                <span id="partnerBNumber"></span>
                            </div>
                            <div class="text-sm font-medium text-pink-700" id="partnerBDisplayName"></div>
                        </div>
                    </div>
                    <div id="compatibilityLevel" class="text-xl font-semibold text-gray-700 mb-4"></div>
                </div>
                
                <!-- 契合度詳細分析 -->
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-blue-800 mb-4">🎯 性格契合分析</h3>
                        <div id="personalityCompatibility" class="text-sm text-blue-700 leading-relaxed"></div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-pink-50 to-rose-50 p-6 rounded-xl">
                        <h3 class="text-lg font-semibold text-pink-800 mb-4">💝 愛情運勢分析</h3>
                        <div id="loveCompatibility" class="text-sm text-pink-700 leading-relaxed"></div>
                    </div>
                </div>
                
                <!-- 迪士尼情侶對應 -->
                <div class="mb-8">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">🏰 迪士尼情侶對應</h3>
                    <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-xl">
                        <div class="flex justify-center items-center space-x-8 mb-6">
                            <div class="text-center">
                                <div class="text-4xl mb-2" id="partnerADisneyIcon"></div>
                                <div class="font-semibold text-purple-800" id="partnerADisneyName"></div>
                            </div>
                            <div class="text-4xl">💕</div>
                            <div class="text-center">
                                <div class="text-4xl mb-2" id="partnerBDisneyIcon"></div>
                                <div class="font-semibold text-pink-800" id="partnerBDisneyName"></div>
                            </div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-semibold text-gray-800 mb-3" id="coupleDisneyTitle"></div>
                            <div class="text-sm text-gray-700 leading-relaxed" id="coupleDisneyAnalysis"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 相處建議 -->
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold text-green-800 mb-4">💬 溝通建議</h4>
                        <div id="communicationAdvice" class="text-sm text-green-700 leading-relaxed"></div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-yellow-50 to-amber-50 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold text-yellow-800 mb-4">🎉 約會建議</h4>
                        <div id="dateAdvice" class="text-sm text-yellow-700 leading-relaxed"></div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-purple-50 to-violet-50 p-6 rounded-xl">
                        <h4 class="text-lg font-semibold text-purple-800 mb-4">⚠️ 注意事項</h4>
                        <div id="cautionAdvice" class="text-sm text-purple-700 leading-relaxed"></div>
                    </div>
                </div>
                
                <!-- 未來發展預測 -->
                <div class="bg-gradient-to-br from-indigo-50 to-blue-50 p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-semibold text-indigo-800 mb-4 text-center">🔮 關係發展預測</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="text-center">
                            <div class="text-2xl mb-2">💕</div>
                            <div class="text-sm font-medium text-indigo-800 mb-1">短期發展</div>
                            <div class="text-xs text-indigo-600" id="shortTermPrediction"></div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl mb-2">💍</div>
                            <div class="text-sm font-medium text-indigo-800 mb-1">中期發展</div>
                            <div class="text-xs text-indigo-600" id="mediumTermPrediction"></div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl mb-2">👨‍👩‍👧‍👦</div>
                            <div class="text-sm font-medium text-indigo-800 mb-1">長期發展</div>
                            <div class="text-xs text-indigo-600" id="longTermPrediction"></div>
                        </div>
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="startNewCoupleTest()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-6 py-3 rounded-full text-lg font-semibold hover:from-pink-600 hover:to-rose-600 transform hover:scale-105 transition-all duration-300 shadow-lg mr-4">
                        測試其他伴侶
                    </button>
                    <button onclick="shareCoupleResult()" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-full text-lg font-semibold hover:from-purple-700 hover:to-pink-700 transform hover:scale-105 transition-all duration-300 shadow-lg mr-4">
                        分享契合度 📱
                    </button>
                    <button onclick="backToResult()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-3 rounded-full text-lg font-semibold hover:from-gray-600 hover:to-gray-700 transform hover:scale-105 transition-all duration-300 shadow-lg">
                        返回個人結果
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentQuestionIndex = 0;
        let answers = [];
        let lifeNumbers = {};
        let coupleData = {};
        
        // 迪士尼開場動畫控制
        document.addEventListener('DOMContentLoaded', function() {
            // 創建流星雨效果
            createShootingStars();
            
            // 創建魔法粒子效果
            createMagicParticles();
            
            // 創建煙火效果
            createEnhancedFireworks();
            
            // 2秒後隱藏開場動畫
            setTimeout(() => {
                const intro = document.getElementById('disneyIntro');
                intro.classList.add('hidden');
            }, 2000);
        });
        
        function createShootingStars() {
            const shootingStarsContainer = document.getElementById('shootingStarsContainer');
            
            // 創建持續的流星雨效果
            function createSingleShootingStar() {
                const star = document.createElement('div');
                star.className = 'shooting-star';
                
                // 隨機起始位置（從左上角區域開始）
                star.style.left = Math.random() * 30 + '%';
                star.style.top = Math.random() * 30 + '%';
                
                // 隨機動畫延遲和持續時間
                star.style.animationDelay = Math.random() * 2 + 's';
                star.style.animationDuration = (2 + Math.random() * 2) + 's';
                
                shootingStarsContainer.appendChild(star);
                
                // 清理流星
                setTimeout(() => {
                    if (star.parentNode) {
                        star.parentNode.removeChild(star);
                    }
                }, 5000);
            }
            
            // 每0.3秒創建一顆流星
            const shootingStarInterval = setInterval(() => {
                createSingleShootingStar();
            }, 300);
            
            // 2秒後停止創建流星
            setTimeout(() => {
                clearInterval(shootingStarInterval);
            }, 2000);
        }
        
        function createMagicParticles() {
            const particlesContainer = document.getElementById('particlesContainer');
            
            // 創建持續的魔法粒子效果
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    createSingleParticle(particlesContainer);
                }, i * 200);
            }
            
            // 每1秒創建新的粒子波
            const particleInterval = setInterval(() => {
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        createSingleParticle(particlesContainer);
                    }, i * 100);
                }
            }, 1000);
            
            // 2秒後停止創建粒子
            setTimeout(() => {
                clearInterval(particleInterval);
            }, 2000);
        }
        
        function createSingleParticle(container) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            // 隨機位置
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 2 + 's';
            particle.style.animationDuration = (3 + Math.random() * 2) + 's';
            
            // 隨機顏色
            const colors = ['#FFD700', '#FFA500', '#FF69B4', '#87CEEB', '#98FB98'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            particle.style.background = color;
            particle.style.boxShadow = `0 0 10px ${color}`;
            
            container.appendChild(particle);
            
            // 清理粒子
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            }, 5000);
        }
        
        function createEnhancedFireworks() {
            const fireworksContainer = document.getElementById('fireworksContainer');
            const colors = ['#FF1493', '#00BFFF', '#FFD700', '#FF6347', '#98FB98', '#DDA0DD', '#FF69B4', '#87CEEB'];
            
            // 第一波煙火 - 0.5秒後開始
            setTimeout(() => {
                for (let i = 0; i < 8; i++) {
                    setTimeout(() => {
                        createEnhancedFirework(fireworksContainer, colors);
                    }, i * 150);
                }
            }, 500);
            
            // 第二波煙火 - 1.5秒後開始（最終高潮）
            setTimeout(() => {
                for (let i = 0; i < 12; i++) {
                    setTimeout(() => {
                        createEnhancedFirework(fireworksContainer, colors);
                    }, i * 100);
                }
            }, 1500);
        }
        
        function createEnhancedFirework(container, colors) {
            const firework = document.createElement('div');
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            firework.className = 'firework';
            firework.style.backgroundColor = color;
            firework.style.left = Math.random() * 80 + 10 + '%';
            firework.style.top = Math.random() * 60 + 20 + '%';
            firework.style.boxShadow = `0 0 15px ${color}`;
            
            container.appendChild(firework);
            
            // 創建更多爆炸粒子
            for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework';
                particle.style.backgroundColor = color;
                particle.style.left = firework.style.left;
                particle.style.top = firework.style.top;
                particle.style.boxShadow = `0 0 8px ${color}`;
                
                const angle = (i * 30) * Math.PI / 180;
                const distance = 40 + Math.random() * 30;
                
                particle.style.transform = `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`;
                particle.style.animationDelay = '0.1s';
                particle.style.animationDuration = '2s';
                
                container.appendChild(particle);
                
                // 清理粒子
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 2200);
            }
            
            // 創建內圈小粒子
            for (let i = 0; i < 8; i++) {
                const smallParticle = document.createElement('div');
                smallParticle.className = 'firework';
                smallParticle.style.backgroundColor = '#FFFFFF';
                smallParticle.style.width = '3px';
                smallParticle.style.height = '3px';
                smallParticle.style.left = firework.style.left;
                smallParticle.style.top = firework.style.top;
                smallParticle.style.boxShadow = `0 0 5px #FFFFFF`;
                
                const angle = (i * 45) * Math.PI / 180;
                const distance = 15 + Math.random() * 15;
                
                smallParticle.style.transform = `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px)`;
                smallParticle.style.animationDelay = '0.05s';
                smallParticle.style.animationDuration = '1.5s';
                
                container.appendChild(smallParticle);
                
                // 清理小粒子
                setTimeout(() => {
                    if (smallParticle.parentNode) {
                        smallParticle.parentNode.removeChild(smallParticle);
                    }
                }, 1700);
            }
            
            // 清理主煙火
            setTimeout(() => {
                if (firework.parentNode) {
                    firework.parentNode.removeChild(firework);
                }
            }, 2000);
        }
        
        const questions = [
            {
                text: "在面對困難時，你通常會？",
                options: [
                    { text: "立即行動，積極解決問題", value: "A", emoji: "⚡" },
                    { text: "先冷靜思考，制定計劃", value: "B", emoji: "🧠" },
                    { text: "尋求他人的建議和幫助", value: "C", emoji: "🤝" },
                    { text: "相信時間會解決一切", value: "D", emoji: "⏰" }
                ]
            },
            {
                text: "你最重視生活中的哪個方面？",
                options: [
                    { text: "個人成長和自我實現", value: "A", emoji: "🌱" },
                    { text: "家庭和親密關係", value: "B", emoji: "💕" },
                    { text: "事業成功和社會地位", value: "C", emoji: "🏆" },
                    { text: "健康和內心平靜", value: "D", emoji: "🧘" }
                ]
            },
            {
                text: "在團隊合作中，你傾向於？",
                options: [
                    { text: "擔任領導者，指導方向", value: "A", emoji: "👑" },
                    { text: "提供創意和新想法", value: "B", emoji: "💡" },
                    { text: "協調溝通，維持和諧", value: "C", emoji: "🤲" },
                    { text: "專注執行，確保品質", value: "D", emoji: "🎯" }
                ]
            },
            {
                text: "你理想的週末是？",
                options: [
                    { text: "冒險旅行，探索新地方", value: "A", emoji: "🗺️" },
                    { text: "在家放鬆，享受寧靜時光", value: "B", emoji: "🏠" },
                    { text: "和朋友聚會，分享生活", value: "C", emoji: "🎉" },
                    { text: "學習新技能，充實自己", value: "D", emoji: "📚" }
                ]
            },
            {
                text: "面對金錢，你的態度是？",
                options: [
                    { text: "積極投資，追求財富增長", value: "A", emoji: "📈" },
                    { text: "謹慎理財，注重安全穩定", value: "B", emoji: "🏦" },
                    { text: "適度消費，享受當下生活", value: "C", emoji: "🛍️" },
                    { text: "簡樸生活，金錢不是重點", value: "D", emoji: "🌿" }
                ]
            },
            {
                text: "在愛情關係中，你最看重？",
                options: [
                    { text: "激情與浪漫的火花", value: "A", emoji: "🔥" },
                    { text: "深度的心靈契合", value: "B", emoji: "💫" },
                    { text: "相互支持與陪伴", value: "C", emoji: "🤗" },
                    { text: "共同成長與未來規劃", value: "D", emoji: "🌱" }
                ]
            },
            {
                text: "你的學習風格偏向？",
                options: [
                    { text: "實作體驗，邊做邊學", value: "A", emoji: "🔨" },
                    { text: "理論研究，深度思考", value: "B", emoji: "🔬" },
                    { text: "討論交流，集體學習", value: "C", emoji: "💬" },
                    { text: "視覺圖像，創意表達", value: "D", emoji: "🎨" }
                ]
            },
            {
                text: "面對壓力時，你會？",
                options: [
                    { text: "正面迎戰，化壓力為動力", value: "A", emoji: "💪" },
                    { text: "冷靜分析，找出解決方案", value: "B", emoji: "🧩" },
                    { text: "尋求支持，與他人分享", value: "C", emoji: "🫂" },
                    { text: "暫時休息，調整心態", value: "D", emoji: "🧘‍♀️" }
                ]
            },
            {
                text: "你的職業理想是？",
                options: [
                    { text: "創業當老闆，實現夢想", value: "A", emoji: "🚀" },
                    { text: "專業技術領域的專家", value: "B", emoji: "⚙️" },
                    { text: "幫助他人的服務工作", value: "C", emoji: "🤲" },
                    { text: "自由創作的藝術工作", value: "D", emoji: "🎭" }
                ]
            },
            {
                text: "在社交場合中，你通常？",
                options: [
                    { text: "主動出擊，成為焦點", value: "A", emoji: "🌟" },
                    { text: "觀察他人，適時參與", value: "B", emoji: "👁️" },
                    { text: "熱情交流，廣結善緣", value: "C", emoji: "🤝" },
                    { text: "保持低調，深度對話", value: "D", emoji: "💭" }
                ]
            },
            {
                text: "你對未來的規劃是？",
                options: [
                    { text: "大膽設定目標，勇敢追夢", value: "A", emoji: "🎯" },
                    { text: "穩步前進，按部就班", value: "B", emoji: "📋" },
                    { text: "保持彈性，隨機應變", value: "C", emoji: "🌊" },
                    { text: "順其自然，相信直覺", value: "D", emoji: "🍃" }
                ]
            },
            {
                text: "你最喜歡的休閒活動是？",
                options: [
                    { text: "極限運動，挑戰自我", value: "A", emoji: "🏂" },
                    { text: "閱讀思考，充實內在", value: "B", emoji: "📖" },
                    { text: "聚會派對，享受人際", value: "C", emoji: "🎊" },
                    { text: "藝術創作，表達自我", value: "D", emoji: "🖌️" }
                ]
            },
            {
                text: "面對變化時，你的反應是？",
                options: [
                    { text: "興奮期待，擁抱新機會", value: "A", emoji: "🌈" },
                    { text: "謹慎評估，做好準備", value: "B", emoji: "🔍" },
                    { text: "尋求建議，集思廣益", value: "C", emoji: "🗣️" },
                    { text: "內心調適，接受現實", value: "D", emoji: "🧘" }
                ]
            }
        ];
        
        // 美容美髮建議數據庫 - 根據測驗答案個人化
        const beautyAdvice = {
            male: {
                1: {
                    icon: "💇‍♂️",
                    title: "造型",
                    advice: "適合俐落短髮或個性油頭，展現領導者風範。建議定期修剪保持精神",
                    detailed: {
                        hairStyle: "推薦：側分油頭、漸層短髮、經典平頭。避免過長或蓬鬆髮型",
                        hairColor: "深色系為主：黑色、深棕色能展現權威感",
                        skincare: "簡潔有效的保養程序：洗面乳→爽膚水→保濕乳→防曬",
                        products: "推薦髮蠟、髮膠等定型產品，選擇知名品牌展現品味"
                    }
                },
                2: {
                    icon: "🧴",
                    title: "保養",
                    advice: "溫和保養為主，選擇天然成分產品。注重基礎清潔和保濕",
                    detailed: {
                        hairStyle: "推薦：自然蓬鬆短髮、溫和捲髮、簡約側分。避免過於銳利的造型",
                        hairColor: "溫暖色調：淺棕色、蜂蜜色能展現親和力",
                        skincare: "溫和保養：胺基酸洗面乳→保濕化妝水→乳液→天然防曬",
                        products: "選擇溫和天然成分，避免刺激性強的產品"
                    }
                },
                3: {
                    icon: "✨",
                    title: "造型",
                    advice: "可嘗試時尚髮型和造型品，展現創意個性。適合有層次感的髮型",
                    detailed: {
                        hairStyle: "推薦：層次短髮、紋理燙、個性刺蝟頭。可嘗試不對稱設計",
                        hairColor: "可嘗試亮色：淺棕、金棕、甚至挑染都很適合",
                        skincare: "創意保養：可嘗試面膜、精華液等新產品",
                        products: "髮泥、造型噴霧、蓬鬆粉等創意造型品"
                    }
                },
                4: {
                    icon: "🪒",
                    title: "保養",
                    advice: "規律的基礎保養，選擇實用性高的產品。重視清潔和防曬",
                    detailed: {
                        hairStyle: "推薦：經典短髮、整齊平頭、傳統側分。穩重不花俏",
                        hairColor: "保守色系：自然黑色、深棕色最適合",
                        skincare: "基礎三步驟：清潔→保濕→防曬，選擇CP值高的產品",
                        products: "實用型產品，重視功效勝過包裝"
                    }
                },
                5: {
                    icon: "🌊",
                    title: "造型",
                    advice: "適合自然蓬鬆髮型，展現自由不羈的個性。可嘗試不同風格",
                    detailed: {
                        hairStyle: "推薦：自然捲髮、海灘波浪、隨性中長髮。避免過於拘謹的造型",
                        hairColor: "自由色調：可嘗試漸層染、挑染、季節性變色",
                        skincare: "簡單保養：多功能產品，適合旅行攜帶",
                        products: "海鹽噴霧、免沖洗護髮、多效合一產品"
                    }
                },
                6: {
                    icon: "💫",
                    title: "保養",
                    advice: "注重整體形象管理，選擇有質感的保養品。適合精緻的護膚程序",
                    detailed: {
                        hairStyle: "推薦：精緻短髮、優雅側分、質感燙髮。注重整體協調",
                        hairColor: "溫暖魅力色：深棕、栗子色能提升親和力",
                        skincare: "精緻保養：清潔→化妝水→精華→乳液→防曬→晚霜",
                        products: "選擇有品牌故事和質感包裝的產品"
                    }
                },
                7: {
                    icon: "🧘‍♂️",
                    title: "保養",
                    advice: "偏好天然有機產品，重視內在調理。適合簡約的保養程序",
                    detailed: {
                        hairStyle: "推薦：自然簡約短髮、禪意光頭、低調側分。避免過度造型",
                        hairColor: "自然色系：保持原生髮色或深色系",
                        skincare: "天然保養：有機洗面乳→天然化妝水→植物油保濕",
                        products: "選擇有機認證、天然成分的產品"
                    }
                },
                8: {
                    icon: "👔",
                    title: "造型",
                    advice: "商務專業髮型，展現成功人士形象。投資高品質的造型產品",
                    detailed: {
                        hairStyle: "推薦：商務短髮、經典油頭、專業側分。整齊俐落最重要",
                        hairColor: "專業色系：黑色、深棕色展現權威感",
                        skincare: "高效保養：選擇知名品牌的抗老、緊緻產品",
                        products: "投資高級髮蠟、定型噴霧，選擇專業品牌"
                    }
                },
                9: {
                    icon: "👑",
                    title: "造型",
                    advice: "經典優雅髮型，展現智慧與權威。選擇有品牌價值的產品",
                    detailed: {
                        hairStyle: "推薦：經典短髮、優雅側分、智者光頭。展現成熟魅力",
                        hairColor: "經典色系：自然黑、銀灰色都能展現智慧",
                        skincare: "全方位保養：抗老、緊緻、美白一應俱全",
                        products: "選擇歷史悠久的經典品牌，重視品質和傳承"
                    }
                }
            },
            female: {
                1: {
                    icon: "💄",
                    title: "美容",
                    advice: "適合大膽的妝容和髮色，展現自信魅力。紅色系彩妝特別適合",
                    detailed: {
                        makeup: "大膽妝容：紅唇、煙燻眼妝、立體修容。展現領導者氣場",
                        hairStyle: "推薦：俐落短髮、個性BOB頭、帥氣油頭。避免過於甜美的造型",
                        hairColor: "強烈色系：深紅、酒紅、黑色都能展現個性",
                        skincare: "高效保養：選擇功效強的抗老、美白產品",
                        colors: "適合色系：紅色、黑色、金色、深紫色"
                    }
                },
                2: {
                    icon: "🌸",
                    title: "美容",
                    advice: "溫柔自然妝容，粉色系最能展現你的親和力。重視肌膚保養",
                    detailed: {
                        makeup: "自然妝容：淡粉唇彩、自然眉型、淡雅眼影。重視底妝透亮",
                        hairStyle: "推薦：溫柔長髮、自然捲髮、甜美BOB頭。避免過於銳利的造型",
                        hairColor: "溫柔色調：淺棕、蜂蜜色、櫻花粉都很適合",
                        skincare: "溫和保養：選擇溫和天然的產品，重視保濕",
                        colors: "適合色系：粉色、淺藍、米白、淡紫色"
                    }
                },
                3: {
                    icon: "🎨",
                    title: "美容",
                    advice: "創意多變的造型，可嘗試不同風格。適合亮麗活潑的色彩",
                    detailed: {
                        makeup: "創意妝容：彩色眼影、亮片、創意唇色。可嘗試不同風格",
                        hairStyle: "推薦：層次髮型、創意燙髮、彩色挑染。經常變換造型",
                        hairColor: "創意色彩：可嘗試各種顏色，季節性變化",
                        skincare: "創新保養：可嘗試新產品、面膜、美容儀器",
                        colors: "適合色系：亮黃、橙色、綠色、彩虹色系"
                    }
                },
                4: {
                    icon: "🌿",
                    title: "美容",
                    advice: "經典實用的妝容，重視肌膚健康。選擇溫和天然的產品",
                    detailed: {
                        makeup: "實用妝容：自然底妝、淡色唇膏、簡約眼妝。重視持久度",
                        hairStyle: "推薦：經典長髮、簡約馬尾、傳統捲髮。穩重不花俏",
                        hairColor: "經典色系：自然黑、深棕色最適合",
                        skincare: "基礎保養：清潔→保濕→防曬，選擇溫和產品",
                        colors: "適合色系：大地色、米色、深綠、經典藍"
                    }
                },
                5: {
                    icon: "🦋",
                    title: "美容",
                    advice: "自由變化的造型，適合嘗試新趨勢。海洋色系特別適合",
                    detailed: {
                        makeup: "自由妝容：可嘗試各種風格，從自然到濃豔都適合",
                        hairStyle: "推薦：自由捲髮、海灘波浪、隨性長髮。避免過於拘束的造型",
                        hairColor: "自由色調：海洋藍、薄荷綠、漸層色都很棒",
                        skincare: "簡單保養：多功能產品，適合旅行使用",
                        colors: "適合色系：海洋藍、薄荷綠、珊瑚色、自由搭配"
                    }
                },
                6: {
                    icon: "💖",
                    title: "美容",
                    advice: "浪漫優雅的妝容，粉紅色系最能展現魅力。注重整體協調",
                    detailed: {
                        makeup: "浪漫妝容：粉色系眼影、玫瑰唇色、自然腮紅。展現女性魅力",
                        hairStyle: "推薦：浪漫長捲髮、優雅盤髮、甜美波浪。注重整體協調",
                        hairColor: "浪漫色調：玫瑰金、淺棕、蜂蜜色都很迷人",
                        skincare: "精緻保養：全套護膚程序，重視抗老和美白",
                        colors: "適合色系：粉紅、玫瑰金、淡紫、珍珠白"
                    }
                },
                7: {
                    icon: "🔮",
                    title: "美容",
                    advice: "神秘深邃的妝容，紫色系能展現你的智慧。偏好有機保養",
                    detailed: {
                        makeup: "神秘妝容：深色眼影、紫色唇彩、立體輪廓。展現內在深度",
                        hairStyle: "推薦：神秘長髮、簡約直髮、禪意盤髮。避免過於花俏",
                        hairColor: "神秘色系：深紫、深棕、黑色都很適合",
                        skincare: "天然保養：選擇有機、天然成分的產品",
                        colors: "適合色系：紫色、深藍、銀色、神秘黑"
                    }
                },
                8: {
                    icon: "💎",
                    title: "美容",
                    advice: "精緻專業的妝容，投資高級保養品。金色系能提升貴氣",
                    detailed: {
                        makeup: "精緻妝容：完美底妝、精準眼線、高級唇色。展現成功女性形象",
                        hairStyle: "推薦：專業短髮、精緻盤髮、商務造型。整齊俐落",
                        hairColor: "貴氣色系：金棕色、深棕色能展現成功氣質",
                        skincare: "高級保養：投資頂級品牌，全方位抗老護理",
                        colors: "適合色系：金色、深紅、黑色、香檳色"
                    }
                },
                9: {
                    icon: "👸",
                    title: "美容",
                    advice: "優雅高貴的造型，適合經典不敗的風格。金色系最能展現智慧",
                    detailed: {
                        makeup: "高貴妝容：經典紅唇、優雅眼妝、完美輪廓。展現女王氣質",
                        hairStyle: "推薦：經典長髮、優雅盤髮、女王短髮。展現成熟魅力",
                        hairColor: "高貴色系：金色、深棕、銀灰都能展現智慧",
                        skincare: "全方位保養：選擇歷史悠久的經典品牌",
                        colors: "適合色系：金色、深紅、皇室藍、經典黑"
                    }
                }
            }
        };

        const lifeNumberMeanings = {
            1: {
                color: "red",
                colorName: "紅色",
                colorClass: "from-red-500 to-red-600",
                personality: "天生的領導者，具有強烈的開創精神和獨立性。你不畏懼挑戰，總是第一個站出來解決問題。有時會因為太過直接而忽略他人感受，但你的勇氣和決心是無可取代的。你習慣主導一切，不喜歡被人指揮，內心深處渴望被認可和尊重。",
                direction: "最適合創業當老闆或擔任高階主管，你的開創能力能帶領團隊突破困境。避免從事需要長期服從他人的工作，那會讓你感到窒息。建議發展自己的事業或在大企業中爭取決策權。",
                health: "容易因壓力過大導致頭痛和失眠，需要規律運動釋放壓力",
                life: "追求成就感和掌控權，喜歡挑戰和變化的生活節奏",
                relationship: "在感情中容易過於強勢，需要學會傾聽和妥協",
                wealth: "有賺大錢的潛力，但要避免過度冒險的投資",
                yearMeaning: "今年是開創新事業或新計畫的絕佳時機",
                monthMeaning: "本月適合主動出擊，展現領導才能",
                dayMeaning: "今日宜做重要決策，相信自己的直覺"
            },
            2: {
                color: "orange",
                colorName: "橘色",
                colorClass: "from-orange-500 to-orange-600",
                personality: "天生的協調者和溝通高手，你總能在衝突中找到平衡點。男性2號通常脾氣溫和、善解人意；女性2號則容易心軟、耳根子軟，但這正是你的魅力所在。你重視和諧，不喜歡爭執，有時會為了維持表面和平而委屈自己。你的直覺很準，能敏銳察覺他人的情緒變化。",
                direction: "最適合從事需要溝通協調的工作，如心理諮商師、人資主管、客服經理、外交官等。你的人際關係是最大的資產，避免從事過於競爭或需要強硬手段的工作。建議發展以服務他人為核心的事業。",
                health: "容易因為情緒起伏影響腸胃，需要學會適當表達負面情緒",
                life: "重視家庭和諧，喜歡安定平靜的生活環境",
                relationship: "在愛情中容易付出過多，要學會保護自己的底線",
                wealth: "財運與人際關係密切相關，善用人脈能帶來意外收入",
                yearMeaning: "今年人際關係特別重要，多參與社交活動",
                monthMeaning: "本月適合修復關係，化解誤會",
                dayMeaning: "今日宜傾聽他人心聲，給予溫暖支持"
            },
            3: {
                color: "yellow",
                colorName: "黃色",
                colorClass: "from-yellow-500 to-yellow-600",
                personality: "永遠的孩子王，充滿創意和學習熱忱。你天生樂觀開朗，想像力豐富，總能為生活帶來歡樂。男性3號通常外表帥氣有魅力；女性3號則美麗動人且充滿活力。你學習能力超強，但有時會因為興趣太廣泛而缺乏專注力。你無心機、玩心重，保持著赤子之心。",
                direction: "最適合創意產業，如設計師、藝術家、老師、娛樂業、廣告企劃等。你的創意和學習能力是最大資產，避免過於枯燥重複的工作。建議選擇能發揮創意且有學習成長空間的職業。",
                health: "情緒起伏會影響食慾，保持規律作息和適度運動",
                life: "追求多采多姿的生活，喜歡學習新事物和結交朋友",
                relationship: "用幽默和創意為感情加溫，但要學會深度溝通",
                wealth: "創意和才華是賺錢來源，但要避免衝動消費",
                yearMeaning: "今年創意靈感特別豐富，適合學習新技能",
                monthMeaning: "本月適合展現才華，參與創意競賽",
                dayMeaning: "今日宜發揮想像力，嘗試新的表達方式"
            },
            4: {
                color: "green",
                colorName: "綠色",
                colorClass: "from-green-500 to-green-600",
                personality: "穩重可靠的實務派，你是家庭和團隊的重要支柱。做事穩紮穩打，不喜歡冒險，凡事都要深思熟慮。你以家為重，對家人有強烈的責任感和保護欲。花錢時會反覆考慮，理財觀念保守但穩健。你給人安全感，但有時會因為過於謹慎而錯失機會。",
                direction: "最適合需要穩定性和責任感的工作，如會計師、工程師、銀行員、公務員、建築師等。你的可靠性是最大優勢，避免需要快速決策或高風險的工作。建議選擇能長期發展且有保障的職業。",
                health: "容易因壓力導致肩頸僵硬，需要定期放鬆和按摩",
                life: "重視家庭生活品質，喜歡安定有序的生活節奏",
                relationship: "是可靠的伴侶，但要學會表達情感和浪漫",
                wealth: "理財保守穩健，適合長期投資和儲蓄",
                yearMeaning: "今年適合打穩基礎，進行長期規劃",
                monthMeaning: "本月宜按部就班，不要急於求成",
                dayMeaning: "今日適合整理規劃，處理重要文件"
            },
            5: {
                color: "blue",
                colorName: "藍色",
                colorClass: "from-blue-500 to-blue-600",
                personality: "自由的靈魂，天生的冒險家和賺錢高手。你熱愛自由，不喜歡被束縛，需要空間和新鮮感。執行力超強，一旦決定就會立即行動。你有敏銳的商業嗅覺，天生財庫，總能找到賺錢機會。愛旅行，喜歡體驗不同的文化和生活方式。有時會因為太愛自由而缺乏耐性。",
                direction: "最適合自由度高的工作，如業務員、旅遊業、貿易商、自由工作者、投資顧問等。你的執行力和適應力是最大優勢，避免過於制式化或需要長時間坐辦公室的工作。建議發展能發揮自由特質的事業。",
                health: "需要充足的運動量來釋放精力，注意不要過度勞累",
                life: "追求多元化的生活體驗，喜歡變化和挑戰",
                relationship: "需要理解和支持你自由特質的伴侶",
                wealth: "賺錢能力強但花錢也快，要學會儲蓄和投資",
                yearMeaning: "今年變化和機會特別多，要把握時機",
                monthMeaning: "本月適合嘗試新事物，拓展視野",
                dayMeaning: "今日宜保持彈性，隨機應變"
            },
            6: {
                color: "indigo",
                colorName: "靛色",
                colorClass: "from-indigo-500 to-indigo-600",
                personality: "天生的魅力王者，無論男女都具有強大的吸引力。你散發著溫暖的愛心能量，容易獲得他人的喜愛和信任。感情運勢特別好，容易遇到好姻緣。你重視家庭和諧，有強烈的責任感，願意為愛付出一切。有時會因為太過在意他人感受而忽略自己的需求。",
                direction: "最適合需要人際魅力的工作，如公關經理、銷售主管、服務業、美容業、婚禮企劃等。你的親和力和魅力是最大資產，避免過於冷漠或競爭激烈的工作環境。建議選擇能發揮愛心和魅力的職業。",
                health: "容易因為照顧他人而忽略自己，要學會適度休息",
                life: "重視愛情和家庭，追求和諧美滿的生活",
                relationship: "天生的戀愛高手，但要避免過度付出",
                wealth: "透過人脈和魅力創造財富，適合合夥事業",
                yearMeaning: "今年感情運勢特別旺盛，單身者易脫單",
                monthMeaning: "本月適合關懷他人，建立深度關係",
                dayMeaning: "今日魅力四射，適合重要社交場合"
            },
            7: {
                color: "purple",
                colorName: "紫色",
                colorClass: "from-purple-500 to-purple-600",
                personality: "深度思考的哲學家，追求真理和完美。你凡事要追根究底，是非分明，不能容忍虛假和欺騙。具有強烈的直覺力和洞察力，能看透事物的本質。與宗教、哲學、心靈成長有深度緣分。你重視內在修養，但有時會因為過於理想化而與現實脫節。",
                direction: "最適合研究、分析、教育、宗教、心理諮商、學術研究等工作。你的深度思考能力是最大優勢，避免過於商業化或膚淺的工作。建議選擇能發揮智慧和洞察力的職業。",
                health: "容易因思慮過度導致失眠，需要學會放鬆和冥想",
                life: "追求心靈成長和內在平靜，重視精神層面的滿足",
                relationship: "尋找心靈契合的靈魂伴侶，重視精神交流",
                wealth: "對金錢不太在意，但長期投資眼光獨到",
                yearMeaning: "今年適合深度學習和靈性成長",
                monthMeaning: "本月宜內省思考，尋找人生方向",
                dayMeaning: "今日適合靜心冥想，聆聽內在聲音"
            },
            8: {
                color: "pink",
                colorName: "粉紅色",
                colorClass: "from-pink-500 to-pink-600",
                personality: "天生的商業鉅子，對金錢有敏銳的嗅覺。你具有強烈的商業頭腦和投資眼光，但財運容易大起大落。做事目標導向，執行力強，不達目的不罷休。你重視物質成就和社會地位，有時會因為太專注於賺錢而忽略其他生活層面。個性較為現實，但這正是你成功的關鍵。",
                direction: "最適合商業、金融、投資、房地產、企業管理等領域。你的商業頭腦是最大優勢，避免需要太多創意或感性的工作。建議選擇能發揮商業才能和賺錢能力的職業。",
                health: "容易因工作壓力導致心血管問題，要注意勞逸結合",
                life: "追求財富和成就，重視物質生活品質",
                relationship: "在感情中較為實際，重視對方的條件和未來",
                wealth: "投資理財天賦異稟，但要控制風險避免大起大落",
                yearMeaning: "今年投資運勢強勁，但要謹慎評估風險",
                monthMeaning: "本月適合投資理財，處理重要商務",
                dayMeaning: "今日宜處理金錢事務，做重要商業決策"
            },
            9: {
                color: "gold",
                colorName: "金色",
                colorClass: "from-yellow-400 to-yellow-500",
                personality: "智慧的領導者，天生具有影響他人的能力。你聰明睿智，善於做重大決定，總能在關鍵時刻展現領導風範。具有廣闊的視野和長遠的眼光，能統籌全局。你重視精神層面的成就，希望能對社會產生正面影響。有時會因為想太多而猶豫不決，但你的智慧最終會指引正確方向。",
                direction: "最適合需要做重大決策的工作，如企業高管、政治家、教育家、法官、醫生等。你的智慧和影響力是最大優勢，避免過於基層或執行性的工作。建議選擇能發揮領導才能和智慧的職業。",
                health: "容易因責任重大而感到壓力，需要學會適度放鬆",
                life: "承擔重要責任和使命，追求更高層次的人生意義",
                relationship: "在感情中扮演智慧導師的角色，給予伴侶指引",
                wealth: "透過智慧和決策創造財富，適合長期投資",
                yearMeaning: "今年需要做重要人生決定，相信自己的智慧",
                monthMeaning: "本月適合發揮影響力，幫助他人成長",
                dayMeaning: "今日宜運用智慧解決複雜問題"
            }
        };

        // 干支計算相關數據 - 精確版本
        const ganzhiData = {
            heavenlyStems: ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],
            earthlyBranches: ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
            yearGanToMonthGan: {
                '甲': '丙', '己': '丙',
                '乙': '戊', '庚': '戊', 
                '丙': '庚', '辛': '庚',
                '丁': '壬', '壬': '壬',
                '戊': '甲', '癸': '甲'
            },
            monthBranches: ["寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥", "子", "丑"],
            // 使用1984年甲子年作為基準點（更準確的六十甲子循環起點）
            baseYear: 1984,
            baseYearGanzhi: { gan: 0, zhi: 0 }, // 甲子年 (甲=0, 子=0)
            // 1900年1月1日的儒略日數（用於日干支計算）
            baseDayJulian: 2415021,
            baseDayGanzhi: { gan: 7, zhi: 0 }, // 1900年1月1日是庚子日
            
            // 干支與五行對照
            ganWuxing: {
                '甲': '木', '乙': '木',
                '丙': '火', '丁': '火',
                '戊': '土', '己': '土',
                '庚': '金', '辛': '金',
                '壬': '水', '癸': '水'
            },
            
            // 五行生克關係
            wuxingRelations: {
                '木': ['火', '土', '金', '水'], // 木生火、木克土、木被金克、木生於水
                '火': ['土', '金', '水', '木'],
                '土': ['金', '水', '木', '火'],
                '金': ['水', '木', '火', '土'],
                '水': ['木', '火', '土', '金']
            },
            
            // 十神含義
            shishenMeanings: {
                "比肩": {
                    meaning: "自我意識強、競爭者多，容易固執，也可能有貴人",
                    fortune: "平穩發展，需要團隊合作",
                    advice: "保持謙遜，善用人際關係"
                },
                "劫財": {
                    meaning: "競爭激烈、容易破財，但也代表朋友幫助",
                    fortune: "財運起伏，注意投資風險",
                    advice: "謹慎理財，避免借貸糾紛"
                },
                "食神": {
                    meaning: "生活輕鬆、有口福，創造力佳，利於名氣",
                    fortune: "創意豐富，適合展現才華",
                    advice: "發揮創造力，注意健康飲食"
                },
                "傷官": {
                    meaning: "口才好、想法多，但容易與權威衝突",
                    fortune: "表達能力強，但需注意人際關係",
                    advice: "控制情緒，避免與上司衝突"
                },
                "正財": {
                    meaning: "財運穩定、適合腳踏實地工作",
                    fortune: "穩定收入，適合長期投資",
                    advice: "踏實工作，積少成多"
                },
                "偏財": {
                    meaning: "有突發財運、偏門機會、人緣佳",
                    fortune: "意外收入，投資機會多",
                    advice: "把握機會，但要謹慎評估"
                },
                "正官": {
                    meaning: "重視規矩、有責任心，利於職場發展",
                    fortune: "事業運佳，容易獲得提升",
                    advice: "遵守規則，展現責任感"
                },
                "七殺": {
                    meaning: "壓力大、挑戰多，也有突破機會",
                    fortune: "面臨挑戰，但有突破可能",
                    advice: "勇敢面對，化壓力為動力"
                },
                "正印": {
                    meaning: "貴人幫助、學習力強，利於深造或休養",
                    fortune: "學習運佳，有貴人相助",
                    advice: "多學習充實自己，感謝貴人"
                },
                "偏印": {
                    meaning: "靈感多、思維跳躍，適合創作但需防迷惘",
                    fortune: "靈感豐富，但思緒較亂",
                    advice: "專注目標，避免三心二意"
                }
            },
            
            // 六十甲子納音五行和特質
            ganzhiMeanings: {
                // 六十甲子納音五行
                '甲子': { element: '海中金', trait: '開創進取，但需要耐心培養' },
                '乙丑': { element: '海中金', trait: '溫和堅韌，默默耕耘必有收穫' },
                '丙寅': { element: '爐中火', trait: '熱情積極，具有領導魅力' },
                '丁卯': { element: '爐中火', trait: '溫文儒雅，創意豐富' },
                '戊辰': { element: '大林木', trait: '穩重踏實，具有包容力' },
                '己巳': { element: '大林木', trait: '智慧靈活，善於變通' },
                '庚午': { element: '路旁土', trait: '直率豪爽，行動力強' },
                '辛未': { element: '路旁土', trait: '細心謹慎，重視品質' },
                '壬申': { element: '劍鋒金', trait: '機智敏銳，適應力強' },
                '癸酉': { element: '劍鋒金', trait: '聰明伶俐，注重細節' },
                '甲戌': { element: '山頭火', trait: '忠誠可靠，責任感強' },
                '乙亥': { element: '山頭火', trait: '善良純真，富有同情心' },
                '丙子': { element: '澗下水', trait: '溫和包容，善於滋養他人' },
                '丁丑': { element: '澗下水', trait: '內斂深沉，具有治癒能力' },
                '戊寅': { element: '城牆土', trait: '穩固可靠，是他人的依靠' },
                '己卯': { element: '城牆土', trait: '溫和堅定，默默支持他人' },
                '庚辰': { element: '白蠟金', trait: '純潔高貴，追求完美' },
                '辛巳': { element: '白蠟金', trait: '精緻細膩，注重品味' },
                '壬午': { element: '楊柳木', trait: '柔韌靈活，適應力強' },
                '癸未': { element: '楊柳木', trait: '溫柔體貼，善解人意' },
                '甲申': { element: '泉中水', trait: '清澈純淨，源源不絕' },
                '乙酉': { element: '泉中水', trait: '細水長流，持之以恆' },
                '丙戌': { element: '屋上土', trait: '穩重踏實，給人安全感' },
                '丁亥': { element: '屋上土', trait: '溫暖包容，如家的感覺' },
                '戊子': { element: '霹靂火', trait: '爆發力強，一鳴驚人' },
                '己丑': { element: '霹靂火', trait: '內斂蓄勢，厚積薄發' },
                '庚寅': { element: '松柏木', trait: '堅韌不拔，歷久彌新' },
                '辛卯': { element: '松柏木', trait: '高潔品格，不畏風霜' },
                '壬辰': { element: '長流水', trait: '源遠流長，影響深遠' },
                '癸巳': { element: '長流水', trait: '智慧如水，潤物無聲' },
                '甲午': { element: '沙中金', trait: '潛力無限，需要發掘' },
                '乙未': { element: '沙中金', trait: '溫和內斂，價值珍貴' },
                '丙申': { element: '山下火', trait: '光芒內斂，溫暖他人' },
                '丁酉': { element: '山下火', trait: '精緻優雅，品味獨特' },
                '戊戌': { element: '平地木', trait: '腳踏實地，穩步成長' },
                '己亥': { element: '平地木', trait: '包容寬厚，滋養萬物' },
                '庚子': { element: '壁上土', trait: '堅固穩定，保護他人' },
                '辛丑': { element: '壁上土', trait: '默默守護，不求回報' },
                '壬寅': { element: '金箔金', trait: '光彩奪目，魅力四射' },
                '癸卯': { element: '金箔金', trait: '精緻美麗，令人驚艷' },
                '甲辰': { element: '覆燈火', trait: '照亮他人，奉獻精神' },
                '乙巳': { element: '覆燈火', trait: '溫暖光明，指引方向' },
                '丙午': { element: '天河水', trait: '氣勢磅礴，志向遠大' },
                '丁未': { element: '天河水', trait: '溫柔如水，包容萬物' },
                '戊申': { element: '大驛土', trait: '廣闊包容，承載萬物' },
                '己酉': { element: '大驛土', trait: '穩重可靠，值得信賴' },
                '庚戌': { element: '釵釧金', trait: '精美華麗，品味高雅' },
                '辛亥': { element: '釵釧金', trait: '純潔高貴，內外兼美' },
                '壬子': { element: '桑柘木', trait: '生命力強，默默奉獻' },
                '癸丑': { element: '桑柘木', trait: '堅韌不拔，無私付出' },
                '甲寅': { element: '大溪水', trait: '奔騰不息，勇往直前' },
                '乙卯': { element: '大溪水', trait: '溫和流暢，潤澤萬物' },
                '丙辰': { element: '沙中土', trait: '包容廣大，孕育生機' },
                '丁巳': { element: '沙中土', trait: '細膩溫和，滋養成長' },
                '戊午': { element: '天上火', trait: '光芒萬丈，照耀四方' },
                '己未': { element: '天上火', trait: '溫暖光明，普照眾生' },
                '庚申': { element: '石榴木', trait: '堅韌不拔，果實豐碩' },
                '辛酉': { element: '石榴木', trait: '精緻美麗，內外兼修' },
                '壬戌': { element: '大海水', trait: '胸懷寬廣，包容一切' },
                '癸亥': { element: '大海水', trait: '深邃智慧，源遠流長' }
            }
        };

        // 計算儒略日數
        function getJulianDay(year, month, day) {
            let a = Math.floor((14 - month) / 12);
            let y = year - a;
            let m = month + 12 * a - 3;
            
            let jd = day + Math.floor((153 * m + 2) / 5) + 365 * y + Math.floor(y / 4) - Math.floor(y / 100) + Math.floor(y / 400) + 1721119;
            return jd;
        }

        // 計算十神關係
        function getShishen(dayGan, otherGan) {
            const ganOrder = ganzhiData.heavenlyStems;
            const ganWuxing = ganzhiData.ganWuxing;
            const wuxingRelations = ganzhiData.wuxingRelations;
            
            // 判斷陰陽（偶數索引為陽，奇數索引為陰）
            const sameYinYang = (ganOrder.indexOf(dayGan) % 2) === (ganOrder.indexOf(otherGan) % 2);
            
            const dayWuxing = ganWuxing[dayGan];
            const otherWuxing = ganWuxing[otherGan];
            
            // 同五行
            if (dayWuxing === otherWuxing) {
                return sameYinYang ? "比肩" : "劫財";
            }
            
            // 日主生他（食傷）
            if (wuxingRelations[dayWuxing][0] === otherWuxing) {
                return sameYinYang ? "食神" : "傷官";
            }
            
            // 日主克他（財星）
            if (wuxingRelations[dayWuxing][1] === otherWuxing) {
                return sameYinYang ? "正財" : "偏財";
            }
            
            // 他克日主（官殺）
            if (wuxingRelations[dayWuxing][2] === otherWuxing) {
                return sameYinYang ? "正官" : "七殺";
            }
            
            // 他生日主（印星）
            if (wuxingRelations[dayWuxing][3] === otherWuxing) {
                return sameYinYang ? "正印" : "偏印";
            }
            
            return "未知";
        }

        // 計算八字命理分析
        function calculateBaziAnalysis(birthday) {
            const date = new Date(birthday);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // 計算出生日的干支
            const birthGanzhi = calculateGanzhi(year, month, day);
            const dayGan = birthGanzhi.dayGan; // 日干作為日主
            
            // 計算當前日期的干支
            const currentDate = new Date();
            const currentYear = currentDate.getFullYear();
            const currentMonth = currentDate.getMonth() + 1;
            const currentDay = currentDate.getDate();
            
            const currentGanzhi = calculateGanzhi(currentYear, currentMonth, currentDay);
            
            // 計算十神關係
            const monthShishen = getShishen(dayGan, currentGanzhi.monthGan);
            const dayShishen = getShishen(dayGan, currentGanzhi.dayGan);
            
            return {
                dayGan: dayGan,
                dayWuxing: ganzhiData.ganWuxing[dayGan],
                birthGanzhi: birthGanzhi,
                currentGanzhi: currentGanzhi,
                monthShishen: monthShishen,
                dayShishen: dayShishen,
                monthShishenData: ganzhiData.shishenMeanings[monthShishen],
                dayShishenData: ganzhiData.shishenMeanings[dayShishen]
            };
        }

        // 精確計算干支
        function calculateGanzhi(year, month, day) {
            // 年干支計算 - 使用1984甲子年為基準
            let yearOffset = year - ganzhiData.baseYear;
            // 確保正確處理負數年份
            while (yearOffset < 0) yearOffset += 60;
            
            const yearGanIndex = (ganzhiData.baseYearGanzhi.gan + yearOffset) % 10;
            const yearZhiIndex = (ganzhiData.baseYearGanzhi.zhi + yearOffset) % 12;
            const yearGan = ganzhiData.heavenlyStems[yearGanIndex];
            const yearZhi = ganzhiData.earthlyBranches[yearZhiIndex];
            const yearGanzhi = yearGan + yearZhi;
            
            // 月干支計算 - 根據年干確定月干起始點
            // 農曆月份對應：正月=寅月，二月=卯月...十二月=丑月
            // 節氣月：立春開始為寅月（正月），驚蟄開始為卯月（二月）...
            let adjustedMonth = month;
            
            // 簡化的節氣判斷：每月6日前後為節氣交替點
            if (day < 6) {
                adjustedMonth = month - 1;
                if (adjustedMonth === 0) adjustedMonth = 12;
            }
            
            // 根據年干確定正月（寅月）的天干
            const startMonthGan = ganzhiData.yearGanToMonthGan[yearGan];
            const ganOrder = ganzhiData.heavenlyStems;
            const startIndex = ganOrder.indexOf(startMonthGan);
            
            // 計算當月天干（從寅月開始計算）
            const monthGanIndex = (startIndex + adjustedMonth - 1) % 10;
            const monthGan = ganOrder[monthGanIndex];
            
            // 月地支：寅月=1月，卯月=2月...丑月=12月
            const monthZhiIndex = (adjustedMonth + 1) % 12; // 寅=2，所以+1後%12
            const monthZhi = ganzhiData.earthlyBranches[monthZhiIndex];
            const monthGanzhi = monthGan + monthZhi;
            
            // 日干支計算 - 使用儒略日數精確計算
            const julianDay = getJulianDay(year, month, day);
            const dayOffset = julianDay - ganzhiData.baseDayJulian;
            
            // 計算日干支（60甲子循環）
            let adjustedDayOffset = dayOffset % 60;
            if (adjustedDayOffset < 0) adjustedDayOffset += 60;
            
            const dayGanIndex = (ganzhiData.baseDayGanzhi.gan + adjustedDayOffset) % 10;
            const dayZhiIndex = (ganzhiData.baseDayGanzhi.zhi + adjustedDayOffset) % 12;
            const dayGan = ganzhiData.heavenlyStems[dayGanIndex];
            const dayZhi = ganzhiData.earthlyBranches[dayZhiIndex];
            const dayGanzhi = dayGan + dayZhi;
            
            return {
                year: yearGanzhi,
                month: monthGanzhi,
                day: dayGanzhi,
                yearGan: yearGan,
                monthGan: monthGan,
                dayGan: dayGan
            };
        }

        // 星座數據
        const zodiacData = {
            "白羊座": { icon: "♈", date: "3/21 - 4/19", element: "火", 
                monthlyFortune: "本月充滿活力和新機會，適合主動出擊開創新局面。",
                careerAdvice: "發揮領導才能，勇於承擔責任，但要注意與同事的協調合作。" },
            "金牛座": { icon: "♉", date: "4/20 - 5/20", element: "土",
                monthlyFortune: "穩定發展的一月，專注於既定目標會有不錯的收穫。",
                careerAdvice: "堅持不懈的努力會得到回報，適合進行長期投資規劃。" },
            "雙子座": { icon: "♊", date: "5/21 - 6/21", element: "風",
                monthlyFortune: "溝通和學習運勢佳，多元發展會帶來意想不到的機會。",
                careerAdvice: "善用溝通技巧和靈活思維，適合從事需要創意的工作。" },
            "巨蟹座": { icon: "♋", date: "6/22 - 7/22", element: "水",
                monthlyFortune: "家庭和情感生活和諧，直覺力特別敏銳的一個月。",
                careerAdvice: "關懷他人的天性適合服務業，注重團隊和諧氛圍。" },
            "獅子座": { icon: "♌", date: "7/23 - 8/22", element: "火",
                monthlyFortune: "自信和魅力四射，是展現才華和獲得認可的好時機。",
                careerAdvice: "發揮天生的領導魅力，適合需要表現力的工作領域。" },
            "處女座": { icon: "♍", date: "8/23 - 9/22", element: "土",
                monthlyFortune: "注重細節和完美主義會帶來工作上的突破和成就。",
                careerAdvice: "精確和細心是你的優勢，適合需要專業技能的工作。" },
            "天秤座": { icon: "♎", date: "9/23 - 10/23", element: "風",
                monthlyFortune: "人際關係和合作運勢極佳，平衡各方面發展很重要。",
                careerAdvice: "善於協調和美感判斷，適合藝術、設計或外交工作。" },
            "天蠍座": { icon: "♏", date: "10/24 - 11/22", element: "水",
                monthlyFortune: "深度思考和洞察力強，適合進行重要決策和變革。",
                careerAdvice: "強烈的直覺和分析能力適合研究、調查類工作。" },
            "射手座": { icon: "♐", date: "11/23 - 12/21", element: "火",
                monthlyFortune: "探索和學習慾望強烈，遠行或進修會帶來好運。",
                careerAdvice: "樂觀和冒險精神適合國際貿易或教育推廣工作。" },
            "摩羯座": { icon: "♑", date: "12/22 - 1/19", element: "土",
                monthlyFortune: "踏實努力會獲得上級認可，是建立權威地位的好時機。",
                careerAdvice: "責任感和組織能力強，適合管理階層或專業技術工作。" },
            "水瓶座": { icon: "♒", date: "1/20 - 2/18", element: "風",
                monthlyFortune: "創新思維和人道主義精神會帶來獨特的發展機會。",
                careerAdvice: "前瞻性思維適合科技、社會改革或人道關懷工作。" },
            "雙魚座": { icon: "♓", date: "2/19 - 3/20", element: "水",
                monthlyFortune: "直覺和創意靈感豐富，藝術和靈性發展運勢佳。",
                careerAdvice: "豐富的想像力和同理心適合藝術創作或助人工作。" }
        };

        // 迪士尼角色數據庫
        const disneyCharacters = {
            female: {
                1: {
                    character: "艾莎",
                    icon: "❄️",
                    movie: "冰雪奇緣",
                    traits: "獨立自主、勇於突破傳統、具有強大的內在力量，敢於做自己。",
                    lifeLesson: "學會接受自己的獨特性，不要害怕與眾不同，真正的力量來自於自我接納。",
                    similarity: "像艾莎一樣，你具有改革創新的勇氣，不畏懼挑戰，敢於開創新局面。",
                    similarCharacters: "花木蘭（勇敢突破）、梅莉達（獨立自主）、莫娜（探索未知）",
                    inspiration: "擁抱你的獨特性，不要因為與眾不同而感到恐懼，你的特質就是你的超能力。"
                },
                2: {
                    character: "白雪公主",
                    icon: "🍎",
                    movie: "白雪公主與七個小矮人",
                    traits: "善良溫柔、樂於助人、具有治癒他人的能力，總是為他人著想。",
                    lifeLesson: "在幫助他人的同時，也要學會保護自己，善良不等於軟弱。",
                    similarity: "像白雪公主一樣，你擁有溫暖的心和協調的能力，是天生的和平使者。",
                    similarCharacters: "仙杜瑞拉（溫柔堅韌）、貝兒（善解人意）、安娜（關愛他人）",
                    inspiration: "你的善良是珍貴的禮物，但記得在照顧他人的同時，也要愛護自己。"
                },
                3: {
                    character: "樂佩",
                    icon: "🌻",
                    movie: "魔髮奇緣",
                    traits: "充滿好奇心、創意無限、學習能力強，對世界充滿熱情和想像力。",
                    lifeLesson: "保持童心和好奇心，但也要學會專注，將創意轉化為實際成果。",
                    similarity: "像樂佩一樣，你對世界充滿好奇，具有無限的創意和學習熱忱。",
                    similarCharacters: "愛麗絲（好奇探索）、小美人魚愛麗兒（渴望新世界）、安娜（活潑開朗）",
                    inspiration: "永遠保持對世界的好奇心，你的創意和熱情能為世界帶來美好的改變。"
                },
                4: {
                    character: "仙杜瑞拉",
                    icon: "👠",
                    movie: "仙杜瑞拉",
                    traits: "堅韌不拔、以家為重、默默承擔責任，即使面對困難也不放棄希望。",
                    lifeLesson: "學會在付出的同時也要為自己爭取，你值得被愛和被重視。",
                    similarity: "像仙杜瑞拉一樣，你穩重可靠，以家庭為重，是值得信賴的支柱。",
                    similarCharacters: "蒂安娜（努力工作）、白雪公主（默默付出）、莫娜（責任感強）",
                    inspiration: "你的堅韌和付出會得到回報，但也要記得為自己的幸福而努力。"
                },
                5: {
                    character: "莫娜",
                    icon: "🌊",
                    movie: "海洋奇緣",
                    traits: "熱愛自由、勇於冒險、執行力強，不畏懼未知的挑戰和變化。",
                    lifeLesson: "在追求自由的同時，也要學會承擔責任，平衡冒險與穩定。",
                    similarity: "像莫娜一樣，你熱愛自由和冒險，具有強大的執行力和適應能力。",
                    similarCharacters: "愛麗兒（渴望自由）、梅莉達（冒險精神）、艾莎（突破束縛）",
                    inspiration: "跟隨你內心的聲音去探索世界，你的冒險精神會帶來意想不到的收穫。"
                },
                6: {
                    character: "貝兒",
                    icon: "📚",
                    movie: "美女與野獸",
                    traits: "充滿愛心、具有包容力、能看見他人內在美，散發溫暖的魅力。",
                    lifeLesson: "學會在愛護他人的同時也要設立界限，真愛需要相互尊重。",
                    similarity: "像貝兒一樣，你具有強烈的魅力和包容力，容易獲得他人的喜愛。",
                    similarCharacters: "白雪公主（充滿愛心）、仙杜瑞拉（溫柔體貼）、安娜（關愛家人）",
                    inspiration: "你的愛心和包容是珍貴的品質，用它們來建立真正深刻的關係。"
                },
                7: {
                    character: "愛麗兒",
                    icon: "🧜‍♀️",
                    movie: "小美人魚",
                    traits: "追求真理、渴望探索未知世界、具有深度思考能力和強烈的求知慾。",
                    lifeLesson: "在追求理想的過程中，要學會珍惜現有的一切，平衡夢想與現實。",
                    similarity: "像愛麗兒一樣，你對未知世界充滿好奇，追求真理和深度的理解。",
                    similarCharacters: "貝兒（求知慾強）、樂佩（好奇心重）、莫娜（探索精神）",
                    inspiration: "永遠保持對真理的追求，你的深度思考能力會帶來獨特的洞察。"
                },
                8: {
                    character: "蒂安娜",
                    icon: "🐸",
                    movie: "公主與青蛙",
                    traits: "目標明確、努力工作、具有商業頭腦，為了夢想不懈努力。",
                    lifeLesson: "在追求成功的同時，也要享受過程中的美好，平衡工作與生活。",
                    similarity: "像蒂安娜一樣，你具有強烈的目標導向和商業頭腦，善於創造財富。",
                    similarCharacters: "仙杜瑞拉（努力不懈）、花木蘭（目標明確）、艾莎（追求卓越）",
                    inspiration: "你的努力和決心會帶來成功，但也要記得享受達成目標的過程。"
                },
                9: {
                    character: "花木蘭",
                    icon: "⚔️",
                    movie: "花木蘭",
                    traits: "智慧勇敢、具有領導力、能做出重大決定，為了大義不惜犧牲。",
                    lifeLesson: "學會在承擔重責大任的同時，也要照顧自己的需求和感受。",
                    similarity: "像花木蘭一樣，你具有智慧和勇氣，能夠做出重大決策並影響他人。",
                    similarCharacters: "艾莎（領導能力）、莫娜（勇於承擔）、梅莉達（勇敢決斷）",
                    inspiration: "你的智慧和領導力是珍貴的天賦，用它們來為世界帶來正面的改變。"
                }
            },
            male: {
                1: {
                    character: "阿拉丁",
                    icon: "🧞‍♂️",
                    movie: "阿拉丁",
                    traits: "冒險創新、挑戰傳統、機智靈活，敢於追求夢想和突破階級限制。",
                    lifeLesson: "學會在追求夢想的同時保持誠實，真正的魅力來自於真實的自己。",
                    similarity: "像阿拉丁一樣，你具有冒險精神和改革創新的勇氣，敢於挑戰傳統。",
                    similarCharacters: "弗林萊德（機智冒險）、李翔（勇敢突破）、克里斯多夫（不拘傳統）",
                    inspiration: "相信自己的價值不在於出身，而在於你的品格和行動。"
                },
                2: {
                    character: "克里斯多夫",
                    icon: "⛄",
                    movie: "冰雪奇緣",
                    traits: "溫和支持、善於協調、忠誠可靠，是很好的夥伴和朋友。",
                    lifeLesson: "學會在支持他人的同時也要表達自己的需求，真正的關係需要相互理解。",
                    similarity: "像克里斯多夫一樣，你溫和可靠，善於協調，是天生的好夥伴。",
                    similarCharacters: "約翰史密斯（理解包容）、費利克斯（友善協調）、艾瑞克王子（溫柔體貼）",
                    inspiration: "你的溫暖和支持是珍貴的品質，用它們來建立深刻的友誼。"
                },
                3: {
                    character: "弗林萊德",
                    icon: "👑",
                    movie: "魔髮奇緣",
                    traits: "魅力創意、機智靈活、學習能力強，總是能帶來歡樂和驚喜。",
                    lifeLesson: "學會在展現魅力的同時也要真誠，最吸引人的是真實的自己。",
                    similarity: "像弗林萊德一樣，你充滿魅力和創意，機智靈活，總能化解困境。",
                    similarCharacters: "阿拉丁（機智靈活）、路易王子（活潑開朗）、漢斯（表面魅力，但要用在正途）",
                    inspiration: "你的魅力和機智是天賦，用它們來幫助他人和創造美好。"
                },
                4: {
                    character: "野獸",
                    icon: "🌹",
                    movie: "美女與野獸",
                    traits: "責任感強、保護家庭、內在溫柔，雖然外表粗獷但內心善良。",
                    lifeLesson: "學會控制情緒和脾氣，真正的力量來自於內在的溫柔和愛。",
                    similarity: "像野獸一樣，你穩重可靠，以家庭為重，具有強烈的保護欲。",
                    similarCharacters: "李翔（穩重可靠）、約翰史密斯（承擔責任）、克里斯多夫（保護他人）",
                    inspiration: "你的責任感和保護欲是珍貴的品質，但也要學會溫柔表達。"
                },
                5: {
                    character: "阿拉丁",
                    icon: "🕌",
                    movie: "阿拉丁",
                    traits: "自由冒險、執行力強、適應能力佳，不畏懼未知的挑戰和變化。",
                    lifeLesson: "在追求自由的同時，也要學會承擔責任，平衡冒險與承諾。",
                    similarity: "像阿拉丁一樣，你熱愛自由和冒險，具有強大的執行力和適應能力。",
                    similarCharacters: "弗林萊德（靈活機智）、毛伊（冒險執行）、約翰史密斯（探索精神）",
                    inspiration: "跟隨你的冒險精神去探索世界，但也要珍惜身邊重要的人。"
                },
                6: {
                    character: "亞當王子",
                    icon: "🤴",
                    movie: "美女與野獸",
                    traits: "魅力包容、親和力強、容易獲得他人喜愛，具有領導魅力。",
                    lifeLesson: "學會在展現魅力的同時保持謙遜，真正的魅力來自於內在品格。",
                    similarity: "像亞當王子一樣，你具有強烈的魅力和包容力，容易獲得他人的喜愛。",
                    similarCharacters: "艾瑞克王子（溫柔體貼）、路易王子（親和力強）、弗林萊德（個人魅力）",
                    inspiration: "你的魅力和包容是天賦，用它們來建立真正有意義的關係。"
                },
                7: {
                    character: "野獸",
                    icon: "📚",
                    movie: "美女與野獸",
                    traits: "深度思考、追求真理、內在成長，具有哲學思維和求知慾。",
                    lifeLesson: "在追求真理的過程中，也要學會與他人分享你的洞察和智慧。",
                    similarity: "像野獸一樣，你追求真理和內在成長，具有深度思考能力。",
                    similarCharacters: "約翰史密斯（探索真理）、李翔（智慧沉穩）、亞當王子（內在成長）",
                    inspiration: "你的深度思考是珍貴的天賦，用它來理解世界和幫助他人成長。"
                },
                8: {
                    character: "納文王子",
                    icon: "🎺",
                    movie: "公主與青蛙",
                    traits: "目標導向、商業頭腦、執行力強，善於規劃和達成目標。",
                    lifeLesson: "在追求成功的同時，也要享受過程和重視人際關係。",
                    similarity: "像納文王子一樣，你具有強烈的目標導向和商業頭腦，善於創造財富。",
                    similarCharacters: "李翔（執行力強）、艾瑞克王子（決策果斷）、亞當王子（領導能力）",
                    inspiration: "你的商業頭腦和執行力會帶來成功，但也要記得享受成功的過程。"
                },
                9: {
                    character: "李翔",
                    icon: "⚔️",
                    movie: "花木蘭",
                    traits: "智慧領導、決策能力強、能承擔重責大任，具有影響他人的能力。",
                    lifeLesson: "學會在領導他人的同時也要聆聽不同的聲音，真正的領導來自於服務。",
                    similarity: "像李翔一樣，你具有智慧和領導力，能夠做出重大決策並影響他人。",
                    similarCharacters: "約翰史密斯（決策能力）、亞當王子（影響力強）、野獸（承擔責任）",
                    inspiration: "你的智慧和領導力是珍貴的天賦，用它們來為團隊和社會帶來正面影響。"
                }
            }
        };

        // 契合度分析數據庫
        const compatibilityData = {
            // 數字契合度矩陣 (1-9 x 1-9)
            matrix: {
                "11": { score: 85, level: "極佳契合", description: "兩個領導者的結合，充滿創新活力" },
                "12": { score: 78, level: "良好契合", description: "領導與協調的完美平衡" },
                "13": { score: 82, level: "極佳契合", description: "創新與創意的絕佳組合" },
                "14": { score: 75, level: "良好契合", description: "開創與穩定的互補關係" },
                "15": { score: 88, level: "極佳契合", description: "冒險與執行力的強力組合" },
                "16": { score: 80, level: "良好契合", description: "領導魅力與愛心的結合" },
                "17": { score: 72, level: "中等契合", description: "實用與理想的平衡挑戰" },
                "18": { score: 85, level: "極佳契合", description: "創新與商業的成功組合" },
                "19": { score: 90, level: "完美契合", description: "雙重領導智慧的頂級組合" },
                
                "22": { score: 88, level: "極佳契合", description: "雙重協調能力，和諧美滿" },
                "23": { score: 85, level: "極佳契合", description: "溝通與創意的完美融合" },
                "24": { score: 82, level: "極佳契合", description: "協調與穩定的理想組合" },
                "25": { score: 78, level: "良好契合", description: "溝通與自由的平衡關係" },
                "26": { score: 92, level: "完美契合", description: "愛與關懷的最佳組合" },
                "27": { score: 75, level: "良好契合", description: "感性與理性的互補" },
                "28": { score: 80, level: "良好契合", description: "溝通與商業的良好結合" },
                "29": { score: 85, level: "極佳契合", description: "協調與智慧的優秀組合" },
                
                "33": { score: 90, level: "完美契合", description: "雙重創意，充滿樂趣" },
                "34": { score: 75, level: "良好契合", description: "創意與穩定的平衡" },
                "35": { score: 88, level: "極佳契合", description: "創意與執行的絕佳組合" },
                "36": { score: 85, level: "極佳契合", description: "創意與愛心的美好結合" },
                "37": { score: 82, level: "極佳契合", description: "藝術與靈性的深度連結" },
                "38": { score: 78, level: "良好契合", description: "創意與商業的實用組合" },
                "39": { score: 88, level: "極佳契合", description: "創意與智慧的優秀組合" },
                
                "44": { score: 85, level: "極佳契合", description: "雙重穩定，安全感十足" },
                "45": { score: 72, level: "中等契合", description: "穩定與自由的平衡挑戰" },
                "46": { score: 88, level: "極佳契合", description: "穩定與愛心的溫暖組合" },
                "47": { score: 75, level: "良好契合", description: "實用與理想的互補" },
                "48": { score: 90, level: "完美契合", description: "穩定與商業的成功組合" },
                "49": { score: 82, level: "極佳契合", description: "穩定與智慧的可靠組合" },
                
                "55": { score: 82, level: "極佳契合", description: "雙重自由，冒險人生" },
                "56": { score: 78, level: "良好契合", description: "自由與愛心的平衡" },
                "57": { score: 75, level: "良好契合", description: "自由與靈性的探索" },
                "58": { score: 88, level: "極佳契合", description: "自由與商業的成功組合" },
                "59": { score: 85, level: "極佳契合", description: "自由與智慧的優秀組合" },
                
                "66": { score: 95, level: "完美契合", description: "雙重愛心，最浪漫的組合" },
                "67": { score: 80, level: "良好契合", description: "愛心與靈性的深度結合" },
                "68": { score: 85, level: "極佳契合", description: "愛心與商業的平衡發展" },
                "69": { score: 90, level: "完美契合", description: "愛心與智慧的完美結合" },
                
                "77": { score: 78, level: "良好契合", description: "雙重靈性，深度連結" },
                "78": { score: 75, level: "良好契合", description: "靈性與商業的平衡" },
                "79": { score: 88, level: "極佳契合", description: "靈性與智慧的高層次組合" },
                
                "88": { score: 85, level: "極佳契合", description: "雙重商業頭腦，財富雙收" },
                "89": { score: 90, level: "完美契合", description: "商業與智慧的頂級組合" },
                
                "99": { score: 92, level: "完美契合", description: "雙重智慧，最高層次的結合" }
            },
            
            // 迪士尼情侶對應
            disneyCouples: {
                // 經典情侶組合
                "阿拉丁_茉莉": {
                    title: "阿拉丁與茉莉公主",
                    analysis: "你們就像阿拉丁和茉莉一樣，一個充滿冒險精神，一個渴望自由。這個組合充滿了探索未知的勇氣和對彼此的深度理解。",
                    compatibility: 88
                },
                "野獸_貝兒": {
                    title: "野獸與貝兒",
                    analysis: "如同野獸與貝兒的愛情故事，你們的關係建立在真正的理解和接納之上。外表的差異無法阻擋內心的深度連結。",
                    compatibility: 92
                },
                "艾瑞克_愛麗兒": {
                    title: "艾瑞克王子與愛麗兒",
                    analysis: "像艾瑞克王子和愛麗兒一樣，你們來自不同的世界，但愛情讓你們願意為彼此改變和犧牲。",
                    compatibility: 85
                },
                "弗林_樂佩": {
                    title: "弗林萊德與樂佩",
                    analysis: "如同弗林和樂佩，你們的關係充滿了歡樂和冒險。彼此都能帶給對方新的視野和無限的可能。",
                    compatibility: 90
                },
                "克里斯多夫_安娜": {
                    title: "克里斯多夫與安娜",
                    analysis: "像克里斯多夫和安娜一樣，你們的愛情樸實而真摯。彼此都是對方最可靠的支持和最溫暖的陪伴。",
                    compatibility: 87
                },
                "李翔_花木蘭": {
                    title: "李翔與花木蘭",
                    analysis: "如同李翔和花木蘭，你們的關係建立在相互尊重和欣賞之上。彼此都能激發對方最好的一面。",
                    compatibility: 89
                }
            }
        };

        // 相處建議數據庫
        const relationshipAdvice = {
            communication: {
                high: [
                    "你們的溝通非常順暢，繼續保持開放和誠實的對話。",
                    "善用你們的溝通優勢，多分享內心想法和感受。",
                    "定期進行深度對話，這會讓你們的關係更加穩固。"
                ],
                medium: [
                    "多練習傾聽對方的想法，給予足夠的耐心和理解。",
                    "嘗試用不同的方式表達愛意，找到彼此都舒服的溝通模式。",
                    "遇到分歧時，先冷靜下來再進行討論。"
                ],
                low: [
                    "需要更多的耐心來理解彼此的溝通方式。",
                    "建議設定固定的談心時間，慢慢建立溝通習慣。",
                    "學習用對方能理解的方式表達自己的需求。"
                ]
            },
            dating: {
                adventurous: [
                    "一起去旅行探索新地方，體驗不同的文化和美食。",
                    "嘗試刺激的戶外活動，如登山、潛水或極限運動。",
                    "參加各種新奇的課程或工作坊，一起學習新技能。"
                ],
                romantic: [
                    "安排燭光晚餐或在家一起做飯，享受溫馨的二人時光。",
                    "到美麗的地方看日出日落，創造浪漫的回憶。",
                    "互相寫情書或製作紀念品，表達對彼此的愛意。"
                ],
                intellectual: [
                    "一起參觀博物館、藝術展或文化活動。",
                    "進行深度的哲學討論或讀書分享會。",
                    "參加講座或研習課程，共同成長學習。"
                ],
                relaxed: [
                    "在家看電影或追劇，享受輕鬆的相處時光。",
                    "到公園散步或野餐，感受大自然的美好。",
                    "一起做手工藝或園藝，培養共同興趣。"
                ]
            },
            cautions: {
                personality: [
                    "尊重彼此的個性差異，不要試圖改變對方。",
                    "給予對方足夠的個人空間和時間。",
                    "學會欣賞對方的優點，包容對方的缺點。"
                ],
                communication: [
                    "避免在情緒激動時進行重要討論。",
                    "不要把過去的問題重複提起。",
                    "學會道歉和原諒，不要讓小事變成大問題。"
                ],
                lifestyle: [
                    "協調彼此的生活節奏和習慣。",
                    "在金錢觀念上需要更多的溝通和理解。",
                    "平衡工作與感情，不要忽略對方的需求。"
                ]
            }
        };

        // 性別分析數據
        const genderAnalysis = {
            male: {
                1: "男性1號領導者：你是天生的alpha男性，具有強烈的征服欲和保護欲。在職場上容易成為焦點，但要學會團隊合作。在感情中會想要主導一切，需要學習尊重伴侶的獨立性。你的魅力來自於自信和決斷力。",
                2: "男性2號協調者：你是溫暖的暖男代表，脾氣特別好，很少發火。女性朋友很多，容易成為傾訴對象。在愛情中會全心全意付出，但要避免過度遷就而失去自我。你的魅力來自於體貼和包容。",
                3: "男性3號創意者：你通常外表帥氣有型，充滿藝術氣息和創意才華。學習能力超強，興趣廣泛，但有時會給人不夠穩重的感覺。在感情中會用幽默和創意討好對方，但要學會深度溝通。",
                4: "男性4號守護者：你是最可靠的男人，給人強烈的安全感。以家庭為重，是標準的好男人、好爸爸。在感情中會默默承擔責任，但要學會表達情感和製造浪漫。你的魅力來自於穩重和責任感。",
                5: "男性5號冒險者：你熱愛自由，不喜歡被束縛，有強烈的冒險精神。賺錢能力強，但也愛花錢享受。在感情中需要很多個人空間，適合找同樣愛自由的伴侶。你的魅力來自於活力和神秘感。",
                6: "男性6號魅力者：你是天生的放電機，異性緣極佳，走到哪裡都是焦點。容易獲得女性的青睞，但要學會專一和深度經營感情。你的魅力來自於親和力和天生的吸引力。",
                7: "男性7號思想者：你是深度思考的哲學家型男性，有獨特的人生觀和價值觀。可能對宗教、哲學有興趣，追求精神層面的滿足。在感情中重視心靈契合，需要找到能理解你深度的伴侶。",
                8: "男性8號成功者：你是標準的成功男性，商業頭腦發達，目標導向強。重視物質成就和社會地位，在感情中會想要給伴侶最好的物質生活。但要注意平衡工作與感情，避免忽略精神層面的需求。",
                9: "男性9號智者：你是智慧型的領導者，具有廣闊的視野和深度的洞察力。在團隊中容易成為意見領袖，善於做重大決策。在感情中會扮演導師角色，但要避免過於說教，學會平等溝通。"
            },
            female: {
                1: "女性1號領導者：你是獨立自主的現代女性，有自己的事業和想法。不依賴男性，有強烈的自我意識。在感情中會想要平等地位，需要找到能欣賞你獨立性的伴侶。你的魅力來自於自信和能力。",
                2: "女性2號協調者：你是溫柔善良的傳統女性代表，耳根子軟，容易心疼他人。在感情中會全心全意付出，但要學會保護自己，避免遇到不珍惜你的人。你的魅力來自於溫柔和善解人意。",
                3: "女性3號創意者：你通常外表美麗動人，充滿青春活力和創意才華。永遠保持少女心，學習能力強，興趣廣泛。在感情中會帶來很多歡樂，但要學會成熟穩重。你的魅力來自於活力和創意。",
                4: "女性4號守護者：你是顧家愛家的好女人，以家庭為重心，是賢妻良母的代表。理財謹慎，會為家庭精打細算。在感情中會默默付出，但要學會表達自己的需求。你的魅力來自於賢淑和可靠。",
                5: "女性5號冒險者：你熱愛自由和旅行，不喜歡被傳統束縛。有自己的事業和賺錢能力，經濟獨立。在感情中需要很多個人空間，適合找能理解你自由特質的伴侶。你的魅力來自於獨立和神秘。",
                6: "女性6號魅力者：你是天生的女神，魅力無窮，容易獲得好姻緣。異性緣極佳，但要學會選擇真正適合的人。在感情中會全心投入，但要避免過度付出而失去自我。你的魅力來自於天生的女性魅力。",
                7: "女性7號思想者：你追求心靈成長和內在美，有深度的洞察力和直覺。可能對宗教、靈性、心理學有興趣。在感情中重視精神交流，需要找到心靈契合的靈魂伴侶。你的魅力來自於智慧和神秘感。",
                8: "女性8號成功者：你是事業型女性，理財投資眼光獨到，有自己的經濟實力。重視物質生活品質，在感情中會比較實際。但要注意平衡事業與愛情，避免過於現實而忽略感情需求。",
                9: "女性9號智者：你智慧與美貌並重，具有領導才能和影響力。在團隊中容易成為核心人物，善於重大決策。在感情中會希望找到能與你並肩作戰的優秀伴侶。你的魅力來自於智慧和氣質。"
            }
        };

        // 數字組合特殊分析
        const numberCombinationAnalysis = {
            // 雙數字組合分析
            combinations: {
                "12": {
                    name: "領導協調型",
                    description: "你既有領導能力又善於協調，是天生的管理人才。能在強勢和溫和之間找到平衡點。",
                    strength: "領導力與人際關係並重",
                    challenge: "有時會在主導和配合之間猶豫不決"
                },
                "13": {
                    name: "創新領導型", 
                    description: "你是充滿創意的領導者，能帶領團隊開創新局面。想法新穎，執行力強。",
                    strength: "創意與領導力的完美結合",
                    challenge: "有時創意太多會讓人跟不上節奏"
                },
                "18": {
                    name: "商業領袖型",
                    description: "你是天生的商業領袖，既有開創精神又有商業頭腦，容易在商界成功。",
                    strength: "領導力與商業嗅覺並重",
                    challenge: "可能會過於專注事業而忽略其他"
                },
                "23": {
                    name: "溝通創意型",
                    description: "你善於溝通又充滿創意，是很好的企劃或教育人才。能用創意的方式與人溝通。",
                    strength: "溝通能力與創意思維並重",
                    challenge: "有時會因為太有創意而讓人難以理解"
                },
                "26": {
                    name: "愛心協調型",
                    description: "你既善於協調又充滿愛心，是天生的服務業人才。容易獲得他人的信任和喜愛。",
                    strength: "協調能力與人格魅力並重", 
                    challenge: "可能會因為太善良而被人利用"
                },
                "35": {
                    name: "創意執行型",
                    description: "你既有創意又有執行力，能將想法付諸實現。是很好的創業或專案管理人才。",
                    strength: "創意與執行力的完美組合",
                    challenge: "有時會因為想法太多而分散注意力"
                },
                "47": {
                    name: "穩健智慧型",
                    description: "你既穩重又有智慧，做決策時會深思熟慮。是很好的顧問或分析師人才。",
                    strength: "穩重與智慧的可靠組合",
                    challenge: "有時會因為過於謹慎而錯失機會"
                },
                "58": {
                    name: "自由商業型",
                    description: "你熱愛自由又有商業頭腦，適合自由創業或投資。能在變化中找到商機。",
                    strength: "自由度與賺錢能力並重",
                    challenge: "可能會因為太愛自由而缺乏持續性"
                },
                "69": {
                    name: "魅力智慧型",
                    description: "你既有魅力又有智慧，是天生的領袖人才。能用個人魅力影響他人做出正確決策。",
                    strength: "個人魅力與智慧並重",
                    challenge: "有時會因為太有魅力而讓人忽略你的智慧"
                }
            },
            
            // 三數字組合分析
            tripleNumbers: {
                "123": {
                    name: "全能創意型",
                    description: "你集領導力、協調力、創意於一身，是全方位的人才。適合需要綜合能力的工作。"
                },
                "456": {
                    name: "穩健魅力型", 
                    description: "你既穩重可靠又有魅力，還能給人安全感。是很好的管理或服務業人才。"
                },
                "789": {
                    name: "智慧商業型",
                    description: "你集智慧、商業頭腦、決策能力於一身，是天生的企業家或高階主管。"
                },
                "147": {
                    name: "領導智慧型",
                    description: "你有領導力、穩重性格和深度智慧，適合擔任重要決策職位。"
                },
                "258": {
                    name: "社交商業型",
                    description: "你善於社交、熱愛自由又有商業頭腦，適合業務或公關工作。"
                },
                "369": {
                    name: "創意魅力型",
                    description: "你充滿創意、有魅力又有智慧，適合創意產業或教育工作。"
                }
            }
        };

        // 工作態度連線數據
        const workAttitudeConnections = {
            "13": {
                name: "1-3創意領導線",
                trait: "創新領導、藝術天賦",
                description: "結合領導力與創意，適合創意產業的管理職位。"
            },
            "17": {
                name: "1-7真理追求線", 
                trait: "追求真理的領導者",
                description: "具有深度思考的領導風格，適合教育或宗教領域。"
            },
            "19": {
                name: "1-9權威智慧線",
                trait: "智慧型領導者",
                description: "結合開創力與智慧，是天生的企業領袖。"
            },
            "28": {
                name: "2-8溝通財富線",
                trait: "善於溝通的理財專家", 
                description: "透過良好溝通創造財富，適合金融服務業。"
            },
            "35": {
                name: "3-5創意執行線",
                trait: "創意與執行力並重",
                description: "能將創意想法付諸實行，適合創業或專案管理。"
            },
            "37": {
                name: "3-7藝術靈性線",
                trait: "藝術與靈性結合",
                description: "具有深度的藝術創作能力，作品富有哲理。"
            },
            "46": {
                name: "4-6穩定魅力線",
                trait: "穩重中帶有魅力",
                description: "既能給人安全感又具有吸引力，適合服務業管理。"
            },
            "49": {
                name: "4-9穩健智慧線", 
                trait: "穩重的智慧決策者",
                description: "做決策時既穩重又有智慧，適合重要管理職位。"
            },
            "58": {
                name: "5-8執行財富線",
                trait: "執行力強的賺錢高手",
                description: "能快速執行賺錢計畫，適合業務或投資工作。"
            },
            "67": {
                name: "6-7魅力智慧線",
                trait: "具有智慧的魅力領袖",
                description: "結合個人魅力與深度思考，適合公眾領域工作。"
            },
            "69": {
                name: "6-9魅力決策線",
                trait: "有魅力的決策者",
                description: "能以個人魅力影響重大決策，適合政治或大企業。"
            },
            "78": {
                name: "7-8智慧財富線",
                trait: "智慧型投資專家",
                description: "以深度分析進行投資決策，長期投資眼光獨到。"
            }
        };

        // 連線分析數據
        const connectionMeanings = {
            small: {
                "24": {
                    name: "2-4靈巧變通線",
                    trait: "反應快、舉一反三、見機行事",
                    description: "具有靈活的手藝和快速的反應能力，適合需要動手操作的工作。",
                    missing: {
                        "2": "察言觀色能力弱、內心才不快樂",
                        "4": "膽子小、情緒起伏大"
                    }
                },
                "48": {
                    name: "4-8工作模範線", 
                    trait: "工作非常有效率、四平八穩",
                    description: "是最會創造最大績效的人，能在時間內有效達到目標，具有敏銳的投資眼光和商業嗅覺。",
                    missing: {
                        "4": "容易因情緒而流失生意",
                        "8": "做公關或業績，不使人備感壓力及目的",
                        "48": "成隱性連線、在必要時、特質才會顯現出來、甚至強過顯性連線"
                    }
                },
                "26": {
                    name: "2-6公平正義線",
                    trait: "熱心助人、好打抱不平",
                    description: "會記仇，但也會為正義挺身而出，是非分明的性格。",
                    missing: {
                        "2": "內心話不易訴說",
                        "6": "表達慾望弱、與人互動頻率少",
                        "26": "成隱性連線、在必要時、特質才會顯現出來、甚至強過顯性連線"
                    }
                },
                "68": {
                    name: "6-8親切誠實線",
                    trait: "熱情親切，平易近人", 
                    description: "天生具有親和力，容易與人建立良好關係，適合服務業。",
                    missing: {
                        "6": "表達慾望弱、與人互動頻率少",
                        "8": "與人的互動是不求回報與目的",
                        "68": "成隱性連線、在必要時、特質才會顯現出來、甚至強過顯性連線"
                    }
                }
            },
            large: {
                "147": {
                    name: "1-4-7物質充裕線",
                    trait: "調錢容易、偏財運佳",
                    description: "在錢財上較充裕，愛運動。具有良好的財運和物質基礎。",
                    missing: {
                        "4": "容易因情緒起伏而花錢",
                        "7": "錢容易越花越大筆",
                        "47": "容易吸147連線的財氣"
                    }
                },
                "258": {
                    name: "2-5-8熱情公關線",
                    trait: "活潑、能很快與人打成一片、善交際公關",
                    description: "善交際溝通，成交值大，天生的業務和公關人才。擁有此連線又有6：容易有爛桃花氣場。",
                    missing: {
                        "2": "內心話不易傾訴",
                        "5": "不夠熱情、賺的錢容易往外花、守不住財庫",
                        "8": "熱情公關不會使人感到壓力及現實(天生的業務員)",
                        "258": "在人群中表現較為安靜、但非常有人緣"
                    }
                },
                "369": {
                    name: "3-6-9聰明智慧線", 
                    trait: "聰明伶俐、表達力佳、很適合從事講師的工作",
                    description: "數理較強，學習能力優秀，思維敏捷。擁有此線又有6：容易有桃花氣場。",
                    missing: {
                        "3": "容易被人劫財",
                        "6": "表達慾望低",
                        "9": "做事暸草、馬虎",
                        "369": "成隱性連線，在必要時才會顯現出來、甚至強過顯性連線"
                    }
                },
                "123": {
                    name: "1-2-3美感藝術線",
                    trait: "對美學習事務相當敏銳",
                    description: "男女都愛美，具有藝術天賦和美感，對美的事物特別敏感。",
                    missing: {
                        "1": "較沒自信、獨立性不夠、懦弱",
                        "2": "任何東西都想學、但容易遇到內心障礙、瓶頸",
                        "3": "學習很快、但不夠堅持、容易半途而廢、學而不精"
                    }
                },
                "456": {
                    name: "4-5-6完美組織線",
                    trait: "邏輯組織強、做事條理分明、井然有序",
                    description: "對生活品質要求高，特別是在飲食方面有高標準，做事有條理。",
                    missing: {
                        "4": "膽子較小、害怕改變且情緒起伏大",
                        "5": "缺乏執行力、動力",
                        "6": "不擅與人互動",
                        "45": "膽子小：大小事情自己嚇自己",
                        "56": "有時不知如何與人相處、外表冷漠、內心波濤洶湧",
                        "456": "把所有事情放在心裡隱藏、容易讓人感覺陰沉"
                    }
                },
                "789": {
                    name: "7-8-9權勢高鋒線",
                    trait: "有貴人相助、有計畫、企圖心、智慧又有人脈",
                    description: "在家可掌權，女性會重老公的意見，容易得到貴人相助。成就大事業是絕對的。",
                    missing: {
                        "7": "容易壓力大",
                        "8": "當主管或經營事業較不求目的、有興趣才是最重要",
                        "9": "若是管理者比較管不動員工",
                        "789": "成隱性連線，在必要時特質才會顯現，甚至強過顯性連線"
                    }
                },
                "357": {
                    name: "3-5-7最佳人緣線",
                    trait: "深受朋友、老闆、同事喜愛",
                    description: "會散發獨特的魅力，如影藝人員、公眾人物，人緣極佳。",
                    missing: {
                        "57": "受氣包、被人碎碎念",
                        "35": "容易被人碎碎念",
                        "7": "愛碎碎念別人",
                        "357": "成隱性連線的人，必須要相處過後才會深受喜愛"
                    }
                },
                "159": {
                    name: "1-5-9工作事業線",
                    trait: "樂在工作、積極努力求上進",
                    description: "對家庭無怨無悔的付出，對家有責任感，工作非常投入。",
                    missing: {
                        "1": "懶惰、懦弱、希望別人來幫助他",
                        "5": "工作執行力低、積極度弱、想多做少",
                        "9": "求知欲低、無法發揮才能",
                        "159": "成隱性連線、在必要時、特質才會顯現出來、甚至強過顯性連線"
                    }
                }
            },
            special: {
                "246_missing": {
                    condition: "2、4、6同時不在",
                    result: "易得憂鬱症",
                    description: "缺乏這三個數字的人容易有情緒低落的傾向，需要特別注意心理健康。"
                },
                "486_missing": {
                    condition: "4、8、6同時不在", 
                    result: "隱藏雙財庫",
                    description: "雖然表面看起來不重視金錢，但實際上具有隱藏的財富累積能力。"
                },
                "357_369_both": {
                    condition: "3-5-7和3-6-9皆有",
                    result: "較無異性緣",
                    description: "雖然人緣很好，但在異性關係方面可能會遇到一些挑戰。"
                },
                "all_numbers": {
                    condition: "9個數皆有",
                    result: "人生平穩，無風無浪",
                    description: "擁有所有數字的人，人生相對平穩，較少大起大落。"
                }
            }
        };

        function enterTestInterface() {
            // 創建魔法過渡效果
            createMagicalTransition(() => {
                document.getElementById('introPage').classList.add('hidden');
                document.getElementById('birthdayPage').classList.remove('hidden');
            });
        }
        
        function createMagicalTransition(callback) {
            // 創建魔法過渡遮罩
            const magicOverlay = document.createElement('div');
            magicOverlay.className = 'magic-transition-overlay';
            magicOverlay.innerHTML = `
                <!-- 魔法粒子容器 -->
                <div class="magic-particles-container"></div>
                
                <!-- 魔法圓圈擴散 -->
                <div class="magic-circle-container">
                    <div class="magic-circle magic-circle-1"></div>
                    <div class="magic-circle magic-circle-2"></div>
                    <div class="magic-circle magic-circle-3"></div>
                </div>
                
                <!-- 魔法文字 -->
                <div class="magic-transition-text">
                    <div class="magic-text-line">✨ 魔法正在啟動 ✨</div>
                    <div class="magic-text-line magic-text-delay-1">🌟 準備進入測驗世界 🌟</div>
                    <div class="magic-text-line magic-text-delay-2">🔮 你的命運之旅即將開始 🔮</div>
                </div>
                
                <!-- 魔法光束 -->
                <div class="magic-beams">
                    <div class="magic-beam magic-beam-1"></div>
                    <div class="magic-beam magic-beam-2"></div>
                    <div class="magic-beam magic-beam-3"></div>
                    <div class="magic-beam magic-beam-4"></div>
                </div>
                
                <!-- 魔法星星雨 -->
                <div class="magic-star-rain"></div>
            `;
            
            document.body.appendChild(magicOverlay);
            
            // 創建魔法粒子
            createTransitionParticles();
            
            // 創建星星雨
            createStarRain();
            
            // 播放魔法音效（如果需要的話）
            // playMagicSound();
            
            // 3秒後執行回調並移除遮罩
            setTimeout(() => {
                callback();
                
                // 添加消失動畫
                magicOverlay.style.animation = 'magicFadeOut 1s ease-in-out forwards';
                
                setTimeout(() => {
                    if (magicOverlay.parentNode) {
                        magicOverlay.parentNode.removeChild(magicOverlay);
                    }
                }, 1000);
            }, 3000);
        }
        
        function createTransitionParticles() {
            const container = document.querySelector('.magic-particles-container');
            
            // 創建50個魔法粒子
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'magic-transition-particle';
                    
                    // 隨機位置
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';
                    
                    // 隨機顏色
                    const colors = ['#FFD700', '#FF69B4', '#87CEEB', '#98FB98', '#DDA0DD', '#FFA500'];
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.background = color;
                    particle.style.boxShadow = `0 0 20px ${color}`;
                    
                    // 隨機大小
                    const size = 3 + Math.random() * 8;
                    particle.style.width = size + 'px';
                    particle.style.height = size + 'px';
                    
                    // 隨機動畫延遲
                    particle.style.animationDelay = Math.random() * 2 + 's';
                    particle.style.animationDuration = (2 + Math.random() * 3) + 's';
                    
                    container.appendChild(particle);
                    
                    // 3秒後移除粒子
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 5000);
                }, i * 50);
            }
        }
        
        function createStarRain() {
            const container = document.querySelector('.magic-star-rain');
            const stars = ['⭐', '✨', '🌟', '💫', '⚡'];
            
            // 創建30個星星
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const star = document.createElement('div');
                    star.className = 'magic-falling-star';
                    star.textContent = stars[Math.floor(Math.random() * stars.length)];
                    
                    // 隨機水平位置
                    star.style.left = Math.random() * 100 + '%';
                    
                    // 隨機動畫延遲和持續時間
                    star.style.animationDelay = Math.random() * 2 + 's';
                    star.style.animationDuration = (2 + Math.random() * 2) + 's';
                    
                    // 隨機大小
                    const fontSize = 1 + Math.random() * 1.5;
                    star.style.fontSize = fontSize + 'rem';
                    
                    container.appendChild(star);
                    
                    // 4秒後移除星星
                    setTimeout(() => {
                        if (star.parentNode) {
                            star.parentNode.removeChild(star);
                        }
                    }, 4000);
                }, i * 100);
            }
        }



        function calculateLifeNumber(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // 計算主要生命密碼（出生年月日相加）
            const birthSum = year + month + day;
            const mainNumber = reduceToSingleDigit(birthSum);
            
            // 計算個人流年（使用新的精確算法）
            const currentYear = new Date().getFullYear();
            const personalYear = calculatePersonalYear(month, day, currentYear);
            
            // 計算本月運勢（出生日 + 當前年月）
            const currentMonth = new Date().getMonth() + 1;
            const monthSum = day + currentYear + currentMonth;
            const monthNumber = reduceToSingleDigit(monthSum);
            
            // 計算今日運勢（當前完整日期）
            const currentDay = new Date().getDate();
            const daySum = currentYear + currentMonth + currentDay;
            const dayNumber = reduceToSingleDigit(daySum);
            
            return {
                main: mainNumber,
                year: personalYear,
                month: monthNumber,
                day: dayNumber
            };
        }

        // 新增個人流年計算函數
        function calculatePersonalYear(birthMonth, birthDay, year) {
            // 計算年份各位數字之和
            const yearSum = year.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
            
            // 出生月日 + 年份數字和
            let total = birthMonth + birthDay + yearSum;
            
            // 化簡為個位數
            while (total > 9) {
                total = total.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
            }
            
            return total;
        }

        function reduceToSingleDigit(num) {
            while (num > 9) {
                num = num.toString().split('').reduce((sum, digit) => sum + parseInt(digit), 0);
            }
            return num;
        }

        function checkBirthdayInput() {
            const birthday = document.getElementById('birthdayInput').value;
            const name = document.getElementById('nameInput').value.trim();
            const gender = document.getElementById('genderSelect').value;
            
            if (birthday && name && gender) {
                lifeNumbers = calculateLifeNumber(birthday);
                
                document.getElementById('mainLifeNumber').textContent = lifeNumbers.main;
                document.getElementById('yearNumber').textContent = lifeNumbers.year;
                document.getElementById('monthNumber').textContent = lifeNumbers.month;
                document.getElementById('dayNumber').textContent = lifeNumbers.day;
                
                document.getElementById('lifeNumberDisplay').classList.remove('hidden');
                document.getElementById('proceedBtn').disabled = false;
            } else {
                document.getElementById('lifeNumberDisplay').classList.add('hidden');
                document.getElementById('proceedBtn').disabled = true;
            }
        }

        document.getElementById('birthdayInput').addEventListener('change', checkBirthdayInput);
        document.getElementById('nameInput').addEventListener('input', checkBirthdayInput);
        document.getElementById('genderSelect').addEventListener('change', checkBirthdayInput);

        function proceedToQuestions() {
            document.getElementById('birthdayPage').classList.add('hidden');
            document.getElementById('questionsPage').classList.remove('hidden');
            showQuestion(0);
        }

        function showQuestion(index) {
            const question = questions[index];
            document.getElementById('questionText').textContent = question.text;
            document.getElementById('currentQuestion').textContent = index + 1;
            
            const progressWidth = ((index + 1) / questions.length) * 100;
            document.getElementById('progressBar').style.width = progressWidth + '%';
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, i) => {
                const div = document.createElement('div');
                div.className = 'option-card p-4 border-2 border-gray-200 rounded-xl cursor-pointer hover:border-purple-300 transition-all duration-300';
                div.innerHTML = `
                    <div class="flex items-center">
                        <div class="text-2xl mr-4">${option.emoji}</div>
                        <span class="text-gray-700 font-medium">${option.text}</span>
                    </div>
                `;
                
                div.addEventListener('click', function() {
                    // 移除其他選項的選中狀態
                    optionsContainer.querySelectorAll('.option-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    
                    // 添加選中狀態
                    this.classList.add('selected');
                    
                    // 保存答案
                    answers[index] = option.value;
                    
                    // 延遲0.5秒後自動進入下一題
                    setTimeout(() => {
                        nextQuestion();
                    }, 500);
                });
                
                optionsContainer.appendChild(div);
            });
            
            // 移除下一題按鈕，選擇後直接進入下一題
        }

        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < questions.length) {
                showQuestion(currentQuestionIndex);
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('questionsPage').classList.add('hidden');
            document.getElementById('resultPage').classList.remove('hidden');
            
            const mainLifeNumber = lifeNumbers.main;
            const meaning = lifeNumberMeanings[mainLifeNumber];
            
            // 更新主要數字和顏色
            document.getElementById('finalLifeNumber').textContent = mainLifeNumber;
            document.getElementById('numberColorName').textContent = meaning.colorName;
            
            // 更新數字圓圈顏色
            const circle = document.getElementById('finalLifeNumberCircle');
            circle.className = `w-24 h-24 bg-gradient-to-br ${meaning.colorClass} text-white rounded-full flex items-center justify-center text-4xl font-bold number-circle mb-3`;
            
            // 更新運勢詳情
            document.getElementById('displayMainNumber').textContent = lifeNumbers.main;
            document.getElementById('displayYearNumber').textContent = lifeNumbers.year;
            document.getElementById('displayMonthNumber').textContent = lifeNumbers.month;
            document.getElementById('displayDayNumber').textContent = lifeNumbers.day;
            
            document.getElementById('mainNumberMeaning').textContent = lifeNumberMeanings[lifeNumbers.main].colorName + '能量';
            document.getElementById('yearNumberMeaning').textContent = lifeNumberMeanings[lifeNumbers.year].yearMeaning;
            document.getElementById('monthNumberMeaning').textContent = lifeNumberMeanings[lifeNumbers.month].monthMeaning;
            document.getElementById('dayNumberMeaning').textContent = lifeNumberMeanings[lifeNumbers.day].dayMeaning;
            
            document.getElementById('personalityText').textContent = meaning.personality;
            document.getElementById('directionText').textContent = meaning.direction;
            document.getElementById('healthAdvice').textContent = meaning.health;
            document.getElementById('lifeAdvice').textContent = meaning.life;
            document.getElementById('relationshipAdvice').textContent = meaning.relationship;
            document.getElementById('wealthAdvice').textContent = meaning.wealth;
            
            // 更新美容美髮建議
            updateBeautyAdvice();
            
            // 分析星座和個人化資訊
            analyzeZodiacAndPersonal();
            
            // 分析八字命理
            analyzeBaziMingLi();
            
            // 分析迪士尼角色
            analyzeDisneyCharacter();
            
            // 分析數字組合
            analyzeNumberCombinations();
            
            // 分析連線
            analyzeConnections();
        }

        function getZodiacSign(month, day) {
            const zodiacSigns = [
                { name: "摩羯座", start: [12, 22], end: [1, 19] },
                { name: "水瓶座", start: [1, 20], end: [2, 18] },
                { name: "雙魚座", start: [2, 19], end: [3, 20] },
                { name: "白羊座", start: [3, 21], end: [4, 19] },
                { name: "金牛座", start: [4, 20], end: [5, 20] },
                { name: "雙子座", start: [5, 21], end: [6, 21] },
                { name: "巨蟹座", start: [6, 22], end: [7, 22] },
                { name: "獅子座", start: [7, 23], end: [8, 22] },
                { name: "處女座", start: [8, 23], end: [9, 22] },
                { name: "天秤座", start: [9, 23], end: [10, 23] },
                { name: "天蠍座", start: [10, 24], end: [11, 22] },
                { name: "射手座", start: [11, 23], end: [12, 21] }
            ];

            for (let sign of zodiacSigns) {
                if (sign.name === "摩羯座") {
                    if ((month === 12 && day >= 22) || (month === 1 && day <= 19)) {
                        return sign.name;
                    }
                } else {
                    const [startMonth, startDay] = sign.start;
                    const [endMonth, endDay] = sign.end;
                    
                    if ((month === startMonth && day >= startDay) || 
                        (month === endMonth && day <= endDay)) {
                        return sign.name;
                    }
                }
            }
            return "白羊座"; // 預設值
        }

        function calculateNameNumber(name) {
            // 簡化的姓名學計算（基於筆劃數概念）
            let total = 0;
            for (let char of name) {
                total += char.charCodeAt(0) % 9 + 1;
            }
            return reduceToSingleDigit(total);
        }

        function updateBeautyAdvice() {
            const mainNumber = lifeNumbers.main;
            const gender = document.getElementById('genderSelect').value;
            const beauty = beautyAdvice[gender][mainNumber];
            
            // 更新美容美髮建議
            document.getElementById('beautyIcon').textContent = beauty.icon;
            document.getElementById('beautyTitle').textContent = beauty.title;
            
            // 根據測驗答案個人化建議
            const personalizedAdvice = generatePersonalizedBeautyAdvice(beauty, answers);
            document.getElementById('beautyAdvice').textContent = personalizedAdvice;
        }

        function generatePersonalizedBeautyAdvice(beauty, userAnswers) {
            let advice = beauty.advice;
            const detailed = beauty.detailed;
            const gender = document.getElementById('genderSelect').value;
            
            // 分析用戶的答案傾向
            const answerCounts = { A: 0, B: 0, C: 0, D: 0 };
            userAnswers.forEach(answer => {
                if (answer) answerCounts[answer]++;
            });
            
            // 找出主要傾向
            const dominantTrait = Object.keys(answerCounts).reduce((a, b) => 
                answerCounts[a] > answerCounts[b] ? a : b
            );
            
            // 根據主要傾向調整建議
            let personalizedTips = [];
            
            if (gender === 'male') {
                switch (dominantTrait) {
                    case 'A': // 積極主動型
                        personalizedTips.push(`髮型建議：${detailed.hairStyle}`);
                        personalizedTips.push(`顏色選擇：${detailed.hairColor}`);
                        personalizedTips.push("你的積極個性適合嘗試較為大膽的造型變化");
                        break;
                    case 'B': // 思考型
                        personalizedTips.push(`保養程序：${detailed.skincare}`);
                        personalizedTips.push("你注重品質，建議選擇成分天然、效果明確的產品");
                        break;
                    case 'C': // 社交型
                        personalizedTips.push(`產品推薦：${detailed.products}`);
                        personalizedTips.push("你重視他人觀感，建議投資能提升整體形象的產品");
                        break;
                    case 'D': // 平衡型
                        personalizedTips.push("你追求內外平衡，建議選擇簡約但有質感的造型");
                        personalizedTips.push(`基礎保養：${detailed.skincare}`);
                        break;
                }
            } else {
                switch (dominantTrait) {
                    case 'A': // 積極主動型
                        personalizedTips.push(`妝容風格：${detailed.makeup}`);
                        personalizedTips.push(`適合色系：${detailed.colors}`);
                        personalizedTips.push("你的自信個性適合嘗試較為搶眼的造型");
                        break;
                    case 'B': // 思考型
                        personalizedTips.push(`髮型建議：${detailed.hairStyle}`);
                        personalizedTips.push(`保養重點：${detailed.skincare}`);
                        personalizedTips.push("你注重內在美，建議重視肌膚保養勝過彩妝");
                        break;
                    case 'C': // 社交型
                        personalizedTips.push(`髮色推薦：${detailed.hairColor}`);
                        personalizedTips.push("你善於社交，建議選擇能提升親和力的溫暖色調");
                        break;
                    case 'D': // 平衡型
                        personalizedTips.push("你追求和諧美感，建議選擇經典不敗的造型");
                        personalizedTips.push(`色彩搭配：${detailed.colors}`);
                        break;
                }
            }
            
            // 結合基本建議和個人化建議
            return advice + "。" + personalizedTips.join("；") + "。";
        }

        function toggleBeautyDetails() {
            const detailsSection = document.getElementById('beautyDetailsSection');
            const isHidden = detailsSection.classList.contains('hidden');
            
            if (isHidden) {
                // 顯示詳細分析
                updateDetailedBeautyAnalysis();
                detailsSection.classList.remove('hidden');
                // 平滑滾動到詳細分析區塊
                setTimeout(() => {
                    detailsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            } else {
                // 隱藏詳細分析
                detailsSection.classList.add('hidden');
            }
        }

        function updateDetailedBeautyAnalysis() {
            const mainNumber = lifeNumbers.main;
            const gender = document.getElementById('genderSelect').value;
            const beauty = beautyAdvice[gender][mainNumber];
            const detailed = beauty.detailed;
            
            // 分析用戶的答案傾向
            const answerCounts = { A: 0, B: 0, C: 0, D: 0 };
            answers.forEach(answer => {
                if (answer) answerCounts[answer]++;
            });
            
            const dominantTrait = Object.keys(answerCounts).reduce((a, b) => 
                answerCounts[a] > answerCounts[b] ? a : b
            );
            
            // 更新基本資訊
            document.getElementById('detailedBeautyIcon').textContent = beauty.icon;
            document.getElementById('detailedBeautyTitle').textContent = `${beauty.title}造型分析`;
            
            // 生成詳細描述
            const personalityTraits = {
                A: "積極主動、勇於嘗試",
                B: "深思熟慮、注重品質", 
                C: "善於社交、重視他人觀感",
                D: "追求平衡、喜愛和諧"
            };
            
            const description = `根據你的生命密碼${mainNumber}號和測驗結果，你展現出${personalityTraits[dominantTrait]}的特質。這樣的個性特色讓你在美容造型上有獨特的優勢和偏好。`;
            document.getElementById('detailedBeautyDescription').textContent = description;
            
            // 個人風格分析
            const styleAnalysis = generateStyleAnalysis(mainNumber, dominantTrait, gender);
            document.getElementById('personalStyleAnalysis').textContent = styleAnalysis;
            
            // 更新具體建議
            if (gender === 'male') {
                // 男性建議
                document.getElementById('hairStyleAdvice').textContent = detailed.hairStyle;
                document.getElementById('hairColorAdvice').textContent = detailed.hairColor;
                document.getElementById('skincareAdvice').textContent = detailed.skincare;
                document.getElementById('productAdvice').textContent = detailed.products;
                
                // 隱藏女性專用區塊
                document.getElementById('makeupSection').style.display = 'none';
                document.getElementById('colorSection').style.display = 'none';
                
                // 調整男性專用圖示
                document.querySelector('#hairStyleSection h6 span').textContent = '💇‍♂️';
            } else {
                // 女性建議
                document.getElementById('hairStyleAdvice').textContent = detailed.hairStyle;
                document.getElementById('hairColorAdvice').textContent = detailed.hairColor;
                document.getElementById('makeupAdvice').textContent = detailed.makeup;
                document.getElementById('skincareAdvice').textContent = detailed.skincare;
                document.getElementById('colorAdvice').textContent = detailed.colors;
                
                // 女性產品建議（如果有的話）
                if (detailed.products) {
                    document.getElementById('productAdvice').textContent = detailed.products;
                } else {
                    document.getElementById('productSection').style.display = 'none';
                }
                
                // 顯示女性專用區塊
                document.getElementById('makeupSection').style.display = 'block';
                document.getElementById('colorSection').style.display = 'block';
            }
            
            // 生成個人化總結
            const summary = generateBeautySummary(mainNumber, dominantTrait, gender);
            document.getElementById('beautySummary').textContent = summary;
        }

        function generateStyleAnalysis(lifeNumber, dominantTrait, gender) {
            const styleMap = {
                male: {
                    1: "你的領導者氣質適合俐落有型的造型，展現自信和權威感。",
                    2: "你的溫和特質適合自然舒適的造型，重視質感勝過花俏。",
                    3: "你的創意個性適合多變有趣的造型，可以大膽嘗試新風格。",
                    4: "你的穩重性格適合經典實用的造型，重視持久性和實用性。",
                    5: "你的自由精神適合隨性自然的造型，不喜歡過於拘束的風格。",
                    6: "你的魅力特質適合精緻有品味的造型，注重整體協調性。",
                    7: "你的深度內涵適合簡約有質感的造型，偏好天然有機產品。",
                    8: "你的成功導向適合專業有品牌的造型，願意投資高品質產品。",
                    9: "你的智慧氣質適合經典優雅的造型，展現成熟穩重的魅力。"
                },
                female: {
                    1: "你的自信魅力適合大膽搶眼的造型，不怕成為眾人焦點。",
                    2: "你的溫柔氣質適合自然甜美的造型，展現親和力和女性魅力。",
                    3: "你的活潑創意適合多彩多變的造型，可以嘗試各種新潮流。",
                    4: "你的賢淑特質適合經典實用的造型，重視自然健康的美感。",
                    5: "你的獨立個性適合自由隨性的造型，展現不拘傳統的魅力。",
                    6: "你的女性魅力適合浪漫優雅的造型，天生具有吸引力。",
                    7: "你的神秘氣質適合深邃有內涵的造型，展現智慧和深度。",
                    8: "你的成功形象適合精緻專業的造型，投資高級美容產品。",
                    9: "你的高貴氣質適合經典不敗的造型，展現女王般的優雅。"
                }
            };
            
            const traitAnalysis = {
                A: "你的積極特質讓你勇於嘗試新造型，適合跟上流行趨勢。",
                B: "你的謹慎特質讓你重視產品品質，偏好經過驗證的經典選擇。",
                C: "你的社交特質讓你注重他人觀感，適合能提升親和力的造型。",
                D: "你的平衡特質讓你追求和諧美感，適合不過於極端的中庸風格。"
            };
            
            return styleMap[gender][lifeNumber] + " " + traitAnalysis[dominantTrait];
        }

        function generateBeautySummary(lifeNumber, dominantTrait, gender) {
            const numberName = lifeNumberMeanings[lifeNumber].colorName;
            const genderText = gender === 'male' ? '男性' : '女性';
            
            const summaryTemplates = {
                A: `作為${numberName}能量的${genderText}，你的積極主動讓你在美容造型上勇於創新。建議定期嘗試新產品和新造型，保持走在潮流前端的形象。`,
                B: `作為${numberName}能量的${genderText}，你的深思熟慮讓你在美容造型上注重品質。建議選擇經典不敗的風格，投資高品質的保養品和造型產品。`,
                C: `作為${numberName}能量的${genderText}，你的社交天賦讓你在美容造型上重視他人觀感。建議選擇能提升親和力的溫暖造型，讓你在人群中更加出色。`,
                D: `作為${numberName}能量的${genderText}，你的平衡追求讓你在美容造型上喜愛和諧。建議選擇經典優雅的風格，避免過於極端的造型變化。`
            };
            
            return summaryTemplates[dominantTrait];
        }

        function analyzeZodiacAndPersonal() {
            const birthday = document.getElementById('birthdayInput').value;
            const name = document.getElementById('nameInput').value.trim();
            const gender = document.getElementById('genderSelect').value;
            
            const date = new Date(birthday);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // 計算星座
            const zodiacSign = getZodiacSign(month, day);
            const zodiac = zodiacData[zodiacSign];
            
            // 更新星座資訊
            document.getElementById('zodiacIcon').textContent = zodiac.icon;
            document.getElementById('zodiacName').textContent = zodiacSign;
            document.getElementById('zodiacDate').textContent = zodiac.date;
            document.getElementById('monthlyFortune').textContent = zodiac.monthlyFortune;
            document.getElementById('careerAdvice').textContent = zodiac.careerAdvice;
            
            // 性別分析
            const mainNumber = lifeNumbers.main;
            const genderAnalysisText = genderAnalysis[gender][mainNumber];
            document.getElementById('genderAnalysisTitle').textContent = gender === 'male' ? '👨 男性特質分析' : '👩 女性特質分析';
            document.getElementById('genderAnalysisContent').textContent = genderAnalysisText;
            
            // 姓名分析
            const nameNumber = calculateNameNumber(name);
            const nameAnalysisTexts = {
                1: "姓名能量偏向領導和開創，適合擔任主導角色。",
                2: "姓名能量偏向協調和合作，人際關係和諧。", 
                3: "姓名能量充滿創意和活力，適合藝術創作。",
                4: "姓名能量穩重踏實，給人可靠的印象。",
                5: "姓名能量自由靈活，適合多元發展。",
                6: "姓名能量溫暖有愛，容易獲得他人喜愛。",
                7: "姓名能量深度內斂，適合專業研究。",
                8: "姓名能量務實進取，具有商業潛力。",
                9: "姓名能量智慧圓滿，具有影響他人的力量。"
            };
            
            document.getElementById('nameAnalysis').textContent = `${name}的姓名數字是${nameNumber}：${nameAnalysisTexts[nameNumber]}`;
            
            // 計算流年流月流日
            const currentDate = new Date();
            const currentYear = currentDate.getFullYear();
            const currentMonth = currentDate.getMonth() + 1;
            const currentDay = currentDate.getDate();
            
            const liuNianGanzhi = calculateGanzhi(currentYear, 1, 1);
            const liuYueGanzhi = calculateGanzhi(currentYear, currentMonth, 1);
            const liuRiGanzhi = calculateGanzhi(currentYear, currentMonth, currentDay);
            
            // 更新流年流月流日顯示
            const liuNianMeaning = ganzhiData.ganzhiMeanings[liuNianGanzhi.year] || { element: '未知', trait: '需要進一步分析' };
            const liuYueMeaning = ganzhiData.ganzhiMeanings[liuYueGanzhi.month] || { element: '未知', trait: '需要進一步分析' };
            const liuRiMeaning = ganzhiData.ganzhiMeanings[liuRiGanzhi.day] || { element: '未知', trait: '需要進一步分析' };
            
            document.getElementById('liuNianGanzhi').textContent = `${liuNianGanzhi.year} (${liuNianMeaning.element}) - ${liuNianMeaning.trait}`;
            document.getElementById('liuYueGanzhi').textContent = `${liuYueGanzhi.month} (${liuYueMeaning.element}) - ${liuYueMeaning.trait}`;
            document.getElementById('liuRiGanzhi').textContent = `${liuRiGanzhi.day} (${liuRiMeaning.element}) - ${liuRiMeaning.trait}`;
        }

        function analyzeBaziMingLi() {
            const birthday = document.getElementById('birthdayInput').value;
            
            // 計算八字命理分析
            const baziAnalysis = calculateBaziAnalysis(birthday);
            
            // 更新日主分析
            document.getElementById('baziDayGan').textContent = `${baziAnalysis.dayGan}（日主天干，代表你自己）`;
            document.getElementById('baziDayWuxing').textContent = `${baziAnalysis.dayWuxing}行（你的五行屬性）`;
            document.getElementById('baziBirthGanzhi').textContent = `年：${baziAnalysis.birthGanzhi.year} 月：${baziAnalysis.birthGanzhi.month} 日：${baziAnalysis.birthGanzhi.day}`;
            
            // 更新十神分析
            document.getElementById('baziMonthShishen').textContent = `${baziAnalysis.monthShishen}（本月對你的影響）`;
            document.getElementById('baziDayShishen').textContent = `${baziAnalysis.dayShishen}（今日對你的影響）`;
            document.getElementById('baziCurrentGanzhi').textContent = `流月：${baziAnalysis.currentGanzhi.month} 流日：${baziAnalysis.currentGanzhi.day}`;
            
            // 更新本月運勢解析
            document.getElementById('baziMonthMeaning').textContent = baziAnalysis.monthShishenData.meaning;
            document.getElementById('baziMonthFortune').textContent = baziAnalysis.monthShishenData.fortune;
            document.getElementById('baziMonthAdvice').textContent = baziAnalysis.monthShishenData.advice;
            
            // 更新今日運勢解析
            document.getElementById('baziDayMeaning').textContent = baziAnalysis.dayShishenData.meaning;
            document.getElementById('baziDayFortune').textContent = baziAnalysis.dayShishenData.fortune;
            document.getElementById('baziDayAdvice').textContent = baziAnalysis.dayShishenData.advice;
        }

        function analyzeNumberCombinations() {
            const birthday = document.getElementById('birthdayInput').value;
            const date = new Date(birthday);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // 取得生日中所有出現的數字
            const birthDateStr = year.toString() + month.toString().padStart(2, '0') + day.toString().padStart(2, '0');
            const allLifeNumbers = [lifeNumbers.main, lifeNumbers.year, lifeNumbers.month, lifeNumbers.day];
            const allNumbersStr = birthDateStr + allLifeNumbers.join('');
            const allNumbers = allNumbersStr.split('').map(Number);
            const uniqueNumbers = [...new Set(allNumbers)].filter(n => n > 0 && n <= 9).sort();
            
            const combinationSection = document.getElementById('numberCombinationSection');
            combinationSection.innerHTML = '';
            
            let foundCombinations = [];
            
            // 檢查雙數字組合
            Object.keys(numberCombinationAnalysis.combinations).forEach(combo => {
                const nums = combo.split('').map(Number);
                if (nums.every(num => uniqueNumbers.includes(num))) {
                    foundCombinations.push({
                        type: 'double',
                        combo: combo,
                        data: numberCombinationAnalysis.combinations[combo]
                    });
                }
            });
            
            // 檢查三數字組合
            Object.keys(numberCombinationAnalysis.tripleNumbers).forEach(combo => {
                const nums = combo.split('').map(Number);
                if (nums.every(num => uniqueNumbers.includes(num))) {
                    foundCombinations.push({
                        type: 'triple',
                        combo: combo,
                        data: numberCombinationAnalysis.tripleNumbers[combo]
                    });
                }
            });
            
            if (foundCombinations.length > 0) {
                foundCombinations.forEach(combination => {
                    const div = document.createElement('div');
                    div.className = 'bg-gradient-to-br from-purple-50 to-indigo-50 p-6 rounded-xl border border-purple-200';
                    
                    const typeIcon = combination.type === 'triple' ? '🌟' : '⭐';
                    const typeText = combination.type === 'triple' ? '三重組合' : '雙重組合';
                    
                    div.innerHTML = `
                        <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">${typeIcon}</span>
                            <div>
                                <h4 class="text-lg font-semibold text-purple-800">${combination.data.name}</h4>
                                <div class="text-sm text-purple-600">${typeText} (${combination.combo})</div>
                            </div>
                        </div>
                        <div class="space-y-3">
                            <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                <div class="text-sm font-medium text-purple-800 mb-1">✨ 組合特質</div>
                                <div class="text-xs text-purple-700">${combination.data.description}</div>
                            </div>
                            ${combination.data.strength ? `
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-green-800 mb-1">💪 核心優勢</div>
                                    <div class="text-xs text-green-700">${combination.data.strength}</div>
                                </div>
                            ` : ''}
                            ${combination.data.challenge ? `
                                <div class="bg-white bg-opacity-60 p-3 rounded-lg">
                                    <div class="text-sm font-medium text-orange-800 mb-1">⚠️ 需要注意</div>
                                    <div class="text-xs text-orange-700">${combination.data.challenge}</div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                    
                    combinationSection.appendChild(div);
                });
                
                // 添加總結
                const summaryDiv = document.createElement('div');
                summaryDiv.className = 'md:col-span-2 bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-xl border border-indigo-200';
                summaryDiv.innerHTML = `
                    <div class="text-center">
                        <div class="text-lg font-semibold text-indigo-800 mb-2">🎯 數字組合總結</div>
                        <div class="text-sm text-indigo-700">
                            你擁有 ${foundCombinations.length} 個特殊數字組合，顯示出多元化的才能和特質。
                            這些組合讓你在不同領域都有發展潛力，建議善用這些天賦優勢。
                        </div>
                    </div>
                `;
                combinationSection.appendChild(summaryDiv);
                
            } else {
                combinationSection.innerHTML = `
                    <div class="md:col-span-2 bg-gray-50 p-6 rounded-xl text-center">
                        <div class="text-gray-500 text-lg mb-2">🔍 數字組合分析</div>
                        <div class="text-gray-600">
                            你的數字組合較為獨特，沒有發現特定的組合模式。
                            這表示你有獨特的個性特質，不拘泥於傳統分類，擁有更多的可能性。
                        </div>
                    </div>
                `;
            }
        }

        function analyzeDisneyCharacter() {
            const mainNumber = lifeNumbers.main;
            const gender = document.getElementById('genderSelect').value;
            const disneyData = disneyCharacters[gender][mainNumber];
            
            // 更新迪士尼角色資訊
            document.getElementById('disneyCharacterIcon').textContent = disneyData.icon;
            document.getElementById('disneyCharacterName').textContent = disneyData.character;
            document.getElementById('disneyCharacterMovie').textContent = disneyData.movie;
            document.getElementById('disneyCharacterTraits').textContent = disneyData.traits;
            document.getElementById('disneyLifeLesson').textContent = disneyData.lifeLesson;
            
            // 多元化分析
            document.getElementById('diversityAnalysisTitle').textContent = gender === 'male' ? '🤴 王子角色對應' : '👸 公主角色對應';
            document.getElementById('diversityAnalysisContent').textContent = disneyData.similarity;
            document.getElementById('similarCharacters').textContent = disneyData.similarCharacters;
            document.getElementById('characterInspiration').textContent = disneyData.inspiration;
        }



        function analyzeConnections() {
            const birthday = document.getElementById('birthdayInput').value;
            const date = new Date(birthday);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // 取得生日中所有出現的數字（包含所有運勢數字）
            const birthDateStr = year.toString() + month.toString().padStart(2, '0') + day.toString().padStart(2, '0');
            const allLifeNumbers = [lifeNumbers.main, lifeNumbers.year, lifeNumbers.month, lifeNumbers.day];
            const allNumbersStr = birthDateStr + allLifeNumbers.join('');
            const allNumbers = allNumbersStr.split('').map(Number);
            const uniqueNumbers = [...new Set(allNumbers)].filter(n => n > 0 && n <= 9).sort();
            
            console.log('完整數字分析:', {
                生日: birthDateStr,
                生命密碼: allLifeNumbers,
                所有數字: uniqueNumbers
            });
            
            // 分析工作態度連線
            analyzeWorkAttitudeConnections(uniqueNumbers);
            
            // 分析小連線
            analyzeSmallConnections(uniqueNumbers);
            
            // 分析大連線
            analyzeLargeConnections(uniqueNumbers);
            
            // 分析特殊情況
            analyzeSpecialCases(uniqueNumbers);
        }

        function analyzeWorkAttitudeConnections(numbers) {
            const workAttitudeContainer = document.getElementById('workAttitudeConnections');
            workAttitudeContainer.innerHTML = '';
            
            const workConnections = ['13', '17', '19', '28', '35', '37', '46', '49', '58', '67', '69', '78'];
            let foundConnections = 0;
            
            workConnections.forEach(connection => {
                const nums = connection.split('').map(Number);
                const hasConnection = nums.every(num => numbers.includes(num));
                const connectionData = workAttitudeConnections[connection];
                
                if (hasConnection) {
                    foundConnections++;
                    const div = document.createElement('div');
                    div.className = 'bg-white bg-opacity-80 p-4 rounded-lg border-l-4 border-blue-500 shadow-sm hover:shadow-md transition-shadow mb-3';
                    div.innerHTML = `
                        <div class="flex items-center mb-2">
                            <span class="text-lg mr-2">💼</span>
                            <div class="font-semibold text-blue-800">${connectionData.name}</div>
                        </div>
                        <div class="text-sm text-blue-700 font-medium mb-2">${connectionData.trait}</div>
                        <div class="text-xs text-blue-600 leading-relaxed">${connectionData.description}</div>
                    `;
                    workAttitudeContainer.appendChild(div);
                }
            });
            
            if (foundConnections === 0) {
                workAttitudeContainer.innerHTML = `
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="text-gray-500 text-sm mb-1">🔍 工作態度分析</div>
                        <div class="text-gray-600 text-sm">沒有發現特定的工作態度連線，表示你的工作風格較為平衡，能適應不同環境。</div>
                    </div>
                `;
            } else {
                // 添加總結
                const summaryDiv = document.createElement('div');
                summaryDiv.className = 'mt-3 p-3 bg-blue-50 rounded-lg';
                summaryDiv.innerHTML = `
                    <div class="text-xs text-blue-700">
                        <strong>工作態度總結：</strong>發現 ${foundConnections} 個工作態度連線，顯示你在職場上有明確的工作風格和優勢。
                    </div>
                `;
                workAttitudeContainer.appendChild(summaryDiv);
            }
        }

        function analyzeSmallConnections(numbers) {
            const smallConnectionsContainer = document.getElementById('smallConnections');
            smallConnectionsContainer.innerHTML = '';
            
            const smallConnections = ['24', '48', '26', '68'];
            let foundConnections = 0;
            
            smallConnections.forEach(connection => {
                const nums = connection.split('').map(Number);
                const hasConnection = nums.every(num => numbers.includes(num));
                const connectionData = connectionMeanings.small[connection];
                
                if (hasConnection) {
                    foundConnections++;
                    const div = document.createElement('div');
                    div.className = 'bg-white bg-opacity-80 p-4 rounded-lg border-l-4 border-indigo-500 shadow-sm hover:shadow-md transition-shadow mb-3';
                    div.innerHTML = `
                        <div class="flex items-center mb-2">
                            <span class="text-lg mr-2">✨</span>
                            <div class="font-semibold text-indigo-800">${connectionData.name}</div>
                        </div>
                        <div class="text-sm text-indigo-700 font-medium mb-2">${connectionData.trait}</div>
                        <div class="text-xs text-indigo-600 leading-relaxed mb-3">${connectionData.description}</div>
                    `;
                    
                    // 檢查缺失數字並顯示相關分析
                    const missingAnalysis = analyzeMissingNumbers(nums, numbers, connectionData.missing);
                    if (missingAnalysis.length > 0) {
                        div.innerHTML += `
                            <div class="mt-2 p-2 bg-yellow-50 rounded border-l-2 border-yellow-400">
                                <div class="text-xs font-medium text-yellow-800 mb-1">⚠️ 缺失數字影響：</div>
                                ${missingAnalysis.map(analysis => `
                                    <div class="text-xs text-yellow-700 mb-1">• ${analysis}</div>
                                `).join('')}
                            </div>
                        `;
                    }
                    
                    smallConnectionsContainer.appendChild(div);
                }
            });
            
            if (foundConnections === 0) {
                smallConnectionsContainer.innerHTML = `
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="text-gray-500 text-sm mb-1">🔍 小連線分析</div>
                        <div class="text-gray-600 text-sm">目前沒有發現小連線，這表示你的工作態度較為獨特，不拘泥於傳統模式。</div>
                    </div>
                `;
            } else {
                // 添加總結
                const summaryDiv = document.createElement('div');
                summaryDiv.className = 'mt-3 p-3 bg-indigo-50 rounded-lg';
                summaryDiv.innerHTML = `
                    <div class="text-xs text-indigo-700">
                        <strong>工作態度總結：</strong>發現 ${foundConnections} 個小連線，顯示你在工作上具有特定的優勢和特質。
                    </div>
                `;
                smallConnectionsContainer.appendChild(summaryDiv);
            }
        }

        function analyzeLargeConnections(numbers) {
            const largeConnectionsContainer = document.getElementById('largeConnections');
            largeConnectionsContainer.innerHTML = '';
            
            const largeConnections = ['147', '258', '369', '123', '456', '789', '357', '159'];
            let foundConnections = 0;
            const connectionIcons = {
                '147': '💰', '258': '🤝', '369': '🧠', '123': '🎨', 
                '456': '📋', '789': '👑', '357': '⭐', '159': '💪'
            };
            
            largeConnections.forEach(connection => {
                const nums = connection.split('').map(Number);
                const hasConnection = nums.every(num => numbers.includes(num));
                const connectionData = connectionMeanings.large[connection];
                
                if (hasConnection) {
                    foundConnections++;
                    const div = document.createElement('div');
                    div.className = 'bg-white bg-opacity-80 p-4 rounded-lg border-l-4 border-emerald-500 shadow-sm hover:shadow-md transition-shadow mb-3';
                    div.innerHTML = `
                        <div class="flex items-center mb-2">
                            <span class="text-lg mr-2">${connectionIcons[connection] || '🌟'}</span>
                            <div class="font-semibold text-emerald-800">${connectionData.name}</div>
                        </div>
                        <div class="text-sm text-emerald-700 font-medium mb-2">${connectionData.trait}</div>
                        <div class="text-xs text-emerald-600 leading-relaxed mb-3">${connectionData.description}</div>
                    `;
                    
                    // 檢查缺失數字並顯示相關分析
                    const missingAnalysis = analyzeMissingNumbers(nums, numbers, connectionData.missing);
                    if (missingAnalysis.length > 0) {
                        div.innerHTML += `
                            <div class="mt-2 p-2 bg-yellow-50 rounded border-l-2 border-yellow-400">
                                <div class="text-xs font-medium text-yellow-800 mb-1">⚠️ 缺失數字影響：</div>
                                ${missingAnalysis.map(analysis => `
                                    <div class="text-xs text-yellow-700 mb-1">• ${analysis}</div>
                                `).join('')}
                            </div>
                        `;
                    }
                    
                    largeConnectionsContainer.appendChild(div);
                }
            });
            
            if (foundConnections === 0) {
                largeConnectionsContainer.innerHTML = `
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="text-gray-500 text-sm mb-1">🔍 大連線分析</div>
                        <div class="text-gray-600 text-sm">目前沒有發現大連線，這表示你的個性較為平衡，沒有特別突出的極端特質。</div>
                    </div>
                `;
            } else {
                // 添加總結
                const summaryDiv = document.createElement('div');
                summaryDiv.className = 'mt-3 p-3 bg-emerald-50 rounded-lg';
                summaryDiv.innerHTML = `
                    <div class="text-xs text-emerald-700">
                        <strong>個性特質總結：</strong>發現 ${foundConnections} 個大連線，顯示你具有明顯的個性特質和天賦。
                    </div>
                `;
                largeConnectionsContainer.appendChild(summaryDiv);
            }
        }

        function analyzeSpecialCases(numbers) {
            const specialCaseContainer = document.getElementById('specialCaseContent');
            specialCaseContainer.innerHTML = '';
            
            let foundSpecialCases = 0;
            const specialCaseIcons = {
                '246_missing': '😔',
                '486_missing': '💎', 
                '357_369_both': '💔',
                'all_numbers': '🌈'
            };
            
            // 檢查246同時不在
            if (!numbers.includes(2) && !numbers.includes(4) && !numbers.includes(6)) {
                foundSpecialCases++;
                const div = document.createElement('div');
                div.className = 'bg-white bg-opacity-80 p-4 rounded-lg border-l-4 border-rose-500 shadow-sm';
                div.innerHTML = `
                    <div class="flex items-center mb-2">
                        <span class="text-lg mr-2">${specialCaseIcons['246_missing']}</span>
                        <div class="font-semibold text-rose-800">${connectionMeanings.special['246_missing'].condition}</div>
                    </div>
                    <div class="text-sm text-rose-700 font-medium mb-2">${connectionMeanings.special['246_missing'].result}</div>
                    <div class="text-xs text-rose-600 leading-relaxed">${connectionMeanings.special['246_missing'].description}</div>
                    <div class="mt-2 p-2 bg-rose-50 rounded text-xs text-rose-700">
                        <strong>建議：</strong>多關注心理健康，培養正面思維，適時尋求專業協助。
                    </div>
                `;
                specialCaseContainer.appendChild(div);
            }
            
            // 檢查486同時不在
            if (!numbers.includes(4) && !numbers.includes(8) && !numbers.includes(6)) {
                foundSpecialCases++;
                const div = document.createElement('div');
                div.className = 'bg-white bg-opacity-80 p-4 rounded-lg border-l-4 border-green-500 shadow-sm';
                div.innerHTML = `
                    <div class="flex items-center mb-2">
                        <span class="text-lg mr-2">${specialCaseIcons['486_missing']}</span>
                        <div class="font-semibold text-green-800">${connectionMeanings.special['486_missing'].condition}</div>
                    </div>
                    <div class="text-sm text-green-700 font-medium mb-2">${connectionMeanings.special['486_missing'].result}</div>
                    <div class="text-xs text-green-600 leading-relaxed">${connectionMeanings.special['486_missing'].description}</div>
                    <div class="mt-2 p-2 bg-green-50 rounded text-xs text-green-700">
                        <strong>優勢：</strong>不被金錢慾望束縛，能專注於真正重要的事物。
                    </div>
                `;
                specialCaseContainer.appendChild(div);
            }
            
            // 檢查357和369皆有
            const has357 = [3, 5, 7].every(num => numbers.includes(num));
            const has369 = [3, 6, 9].every(num => numbers.includes(num));
            if (has357 && has369) {
                foundSpecialCases++;
                const div = document.createElement('div');
                div.className = 'bg-white bg-opacity-80 p-4 rounded-lg border-l-4 border-purple-500 shadow-sm';
                div.innerHTML = `
                    <div class="flex items-center mb-2">
                        <span class="text-lg mr-2">${specialCaseIcons['357_369_both']}</span>
                        <div class="font-semibold text-purple-800">${connectionMeanings.special['357_369_both'].condition}</div>
                    </div>
                    <div class="text-sm text-purple-700 font-medium mb-2">${connectionMeanings.special['357_369_both'].result}</div>
                    <div class="text-xs text-purple-600 leading-relaxed">${connectionMeanings.special['357_369_both'].description}</div>
                    <div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-700">
                        <strong>建議：</strong>專注於友情和事業發展，感情方面保持耐心。
                    </div>
                `;
                specialCaseContainer.appendChild(div);
            }
            
            // 檢查9個數皆有
            const hasAllNumbers = [1,2,3,4,5,6,7,8,9].every(num => numbers.includes(num));
            if (hasAllNumbers) {
                foundSpecialCases++;
                const div = document.createElement('div');
                div.className = 'bg-white bg-opacity-80 p-4 rounded-lg border-l-4 border-blue-500 shadow-sm';
                div.innerHTML = `
                    <div class="flex items-center mb-2">
                        <span class="text-lg mr-2">${specialCaseIcons['all_numbers']}</span>
                        <div class="font-semibold text-blue-800">${connectionMeanings.special['all_numbers'].condition}</div>
                    </div>
                    <div class="text-sm text-blue-700 font-medium mb-2">${connectionMeanings.special['all_numbers'].result}</div>
                    <div class="text-xs text-blue-600 leading-relaxed">${connectionMeanings.special['all_numbers'].description}</div>
                    <div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-700">
                        <strong>特質：</strong>擁有完整的數字能量，人生較為均衡發展。
                    </div>
                `;
                specialCaseContainer.appendChild(div);
            }
            
            if (foundSpecialCases === 0) {
                specialCaseContainer.innerHTML = `
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="text-gray-500 text-sm mb-1">🔍 特殊情況分析</div>
                        <div class="text-gray-600 text-sm">沒有發現特殊情況，你的數字組合屬於一般正常範圍，發展較為均衡。</div>
                    </div>
                `;
            } else {
                // 添加總結
                const summaryDiv = document.createElement('div');
                summaryDiv.className = 'mt-3 p-3 bg-rose-50 rounded-lg';
                summaryDiv.innerHTML = `
                    <div class="text-xs text-rose-700">
                        <strong>特殊分析總結：</strong>發現 ${foundSpecialCases} 個特殊情況，這些都是需要特別關注的生命課題。
                    </div>
                `;
                specialCaseContainer.appendChild(summaryDiv);
            }
        }

        function analyzeMissingNumbers(connectionNums, userNumbers, missingData) {
            const missingAnalysis = [];
            
            // 檢查單個數字缺失
            connectionNums.forEach(num => {
                if (!userNumbers.includes(num) && missingData[num.toString()]) {
                    missingAnalysis.push(`缺${num}：${missingData[num.toString()]}`);
                }
            });
            
            // 檢查組合缺失
            Object.keys(missingData).forEach(key => {
                if (key.length > 1) {
                    const missingNums = key.split('').map(Number);
                    const allMissing = missingNums.every(num => !userNumbers.includes(num));
                    
                    if (allMissing) {
                        missingAnalysis.push(`缺${key}：${missingData[key]}`);
                    }
                }
            });
            
            return missingAnalysis;
        }

        function restartGame() {
            currentQuestionIndex = 0;
            answers = [];
            lifeNumbers = {};
            
            document.getElementById('resultPage').classList.add('hidden');
            document.getElementById('coupleTestPage').classList.add('hidden');
            document.getElementById('coupleResultPage').classList.add('hidden');
            document.getElementById('birthdayPage').classList.add('hidden');
            document.getElementById('questionsPage').classList.add('hidden');
            document.getElementById('introPage').classList.remove('hidden');
            
            // 重置表單
            document.getElementById('nameInput').value = '';
            document.getElementById('genderSelect').value = '';
            document.getElementById('birthdayInput').value = '';
            document.getElementById('lifeNumberDisplay').classList.add('hidden');
            document.getElementById('proceedBtn').disabled = true;
            // 移除下一題按鈕相關重置
        }

        function shareResult() {
            const mainNumber = lifeNumbers.main;
            const meaning = lifeNumberMeanings[mainNumber];
            const shareText = `我的生命密碼是 ${mainNumber} (${meaning.colorName}能量)！\n\n性格特質：${meaning.personality}\n\n快來探索你的生命密碼吧！`;
            
            if (navigator.share) {
                navigator.share({
                    title: '我的生命密碼解析',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // 複製到剪貼板
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('結果已複製到剪貼板！');
                });
            }
        }

        // 伴侶契合度測試相關函數
        function startCoupleTest() {
            document.getElementById('resultPage').classList.add('hidden');
            document.getElementById('coupleTestPage').classList.remove('hidden');
            
            // 監聽輸入變化
            const inputs = ['partnerAName', 'partnerAGender', 'partnerABirthday', 'partnerBName', 'partnerBGender', 'partnerBBirthday'];
            inputs.forEach(id => {
                document.getElementById(id).addEventListener('input', checkCoupleInputs);
                document.getElementById(id).addEventListener('change', checkCoupleInputs);
            });
        }

        function checkCoupleInputs() {
            const partnerAName = document.getElementById('partnerAName').value.trim();
            const partnerAGender = document.getElementById('partnerAGender').value;
            const partnerABirthday = document.getElementById('partnerABirthday').value;
            const partnerBName = document.getElementById('partnerBName').value.trim();
            const partnerBGender = document.getElementById('partnerBGender').value;
            const partnerBBirthday = document.getElementById('partnerBBirthday').value;
            
            const allFilled = partnerAName && partnerAGender && partnerABirthday && 
                             partnerBName && partnerBGender && partnerBBirthday;
            
            document.getElementById('analyzeBtn').disabled = !allFilled;
        }

        function analyzeCoupleCompatibility() {
            // 收集伴侶資料
            coupleData = {
                partnerA: {
                    name: document.getElementById('partnerAName').value.trim(),
                    gender: document.getElementById('partnerAGender').value,
                    birthday: document.getElementById('partnerABirthday').value,
                    lifeNumbers: calculateLifeNumber(document.getElementById('partnerABirthday').value)
                },
                partnerB: {
                    name: document.getElementById('partnerBName').value.trim(),
                    gender: document.getElementById('partnerBGender').value,
                    birthday: document.getElementById('partnerBBirthday').value,
                    lifeNumbers: calculateLifeNumber(document.getElementById('partnerBBirthday').value)
                }
            };
            
            // 計算契合度
            const compatibility = calculateCompatibility(coupleData.partnerA.lifeNumbers.main, coupleData.partnerB.lifeNumbers.main);
            
            // 顯示結果
            showCoupleResult(compatibility);
        }

        function calculateCompatibility(numberA, numberB) {
            // 創建契合度鍵值（較小數字在前）
            const key = numberA <= numberB ? `${numberA}${numberB}` : `${numberB}${numberA}`;
            
            // 從數據庫獲取契合度資訊
            let compatibility = compatibilityData.matrix[key];
            
            // 如果沒有找到，使用預設計算方式
            if (!compatibility) {
                const diff = Math.abs(numberA - numberB);
                let score;
                if (diff === 0) score = 95; // 相同數字
                else if (diff <= 2) score = 85; // 相近數字
                else if (diff <= 4) score = 75; // 中等差異
                else score = 65; // 較大差異
                
                compatibility = {
                    score: score,
                    level: score >= 90 ? "完美契合" : score >= 80 ? "極佳契合" : score >= 70 ? "良好契合" : "中等契合",
                    description: "你們的數字組合顯示出獨特的互補關係"
                };
            }
            
            return compatibility;
        }

        function showCoupleResult(compatibility) {
            document.getElementById('coupleTestPage').classList.add('hidden');
            document.getElementById('coupleResultPage').classList.remove('hidden');
            
            // 更新基本資訊
            document.getElementById('partnerANumber').textContent = coupleData.partnerA.lifeNumbers.main;
            document.getElementById('partnerBNumber').textContent = coupleData.partnerB.lifeNumbers.main;
            document.getElementById('partnerADisplayName').textContent = coupleData.partnerA.name;
            document.getElementById('partnerBDisplayName').textContent = coupleData.partnerB.name;
            document.getElementById('scoreNumber').textContent = compatibility.score;
            document.getElementById('compatibilityLevel').textContent = compatibility.level;
            
            // 更新契合度分析
            document.getElementById('personalityCompatibility').textContent = compatibility.description;
            
            // 愛情運勢分析
            const loveAnalysis = generateLoveAnalysis(coupleData.partnerA.lifeNumbers.main, coupleData.partnerB.lifeNumbers.main);
            document.getElementById('loveCompatibility').textContent = loveAnalysis;
            
            // 迪士尼角色對應
            updateDisneyCouple();
            
            // 相處建議
            updateRelationshipAdvice(compatibility.score);
            
            // 未來發展預測
            updateFuturePredictions(compatibility.score);
        }

        function generateLoveAnalysis(numberA, numberB) {
            const analyses = {
                high: [
                    "你們的愛情運勢非常好，彼此都能給對方帶來正面的能量和成長。",
                    "這是一個充滿愛與理解的組合，你們的關係會越來越深厚。",
                    "你們的愛情具有長久的潛力，能夠經受時間的考驗。"
                ],
                medium: [
                    "你們的愛情需要更多的耐心和理解，但前景是光明的。",
                    "通過努力和溝通，你們的關係會變得更加穩固。",
                    "你們的愛情有很好的發展空間，需要彼此的包容和支持。"
                ],
                low: [
                    "你們的愛情需要更多的努力和妥協，但並非不可能。",
                    "建議多花時間了解彼此，找到共同點和平衡點。",
                    "雖然挑戰較多，但真愛能夠克服一切困難。"
                ]
            };
            
            const sum = numberA + numberB;
            if (sum >= 15) return analyses.high[Math.floor(Math.random() * analyses.high.length)];
            else if (sum >= 10) return analyses.medium[Math.floor(Math.random() * analyses.medium.length)];
            else return analyses.low[Math.floor(Math.random() * analyses.low.length)];
        }

        function updateDisneyCouple() {
            const partnerAChar = disneyCharacters[coupleData.partnerA.gender][coupleData.partnerA.lifeNumbers.main];
            const partnerBChar = disneyCharacters[coupleData.partnerB.gender][coupleData.partnerB.lifeNumbers.main];
            
            document.getElementById('partnerADisneyIcon').textContent = partnerAChar.icon;
            document.getElementById('partnerADisneyName').textContent = partnerAChar.character;
            document.getElementById('partnerBDisneyIcon').textContent = partnerBChar.icon;
            document.getElementById('partnerBDisneyName').textContent = partnerBChar.character;
            
            // 生成情侶分析
            const coupleTitle = `${partnerAChar.character} ❤️ ${partnerBChar.character}`;
            const coupleAnalysis = `你們就像${partnerAChar.character}和${partnerBChar.character}的組合，${partnerAChar.character}的${partnerAChar.traits.split('、')[0]}與${partnerBChar.character}的${partnerBChar.traits.split('、')[0]}形成了美好的互補。這個組合充滿了愛與理解，你們能夠在彼此身上找到最好的自己。`;
            
            document.getElementById('coupleDisneyTitle').textContent = coupleTitle;
            document.getElementById('coupleDisneyAnalysis').textContent = coupleAnalysis;
        }

        function updateRelationshipAdvice(score) {
            // 溝通建議
            let commLevel = score >= 85 ? 'high' : score >= 70 ? 'medium' : 'low';
            const commAdvice = relationshipAdvice.communication[commLevel];
            document.getElementById('communicationAdvice').textContent = commAdvice[Math.floor(Math.random() * commAdvice.length)];
            
            // 約會建議
            const dateTypes = ['adventurous', 'romantic', 'intellectual', 'relaxed'];
            const dateType = dateTypes[Math.floor(Math.random() * dateTypes.length)];
            const dateAdvice = relationshipAdvice.dating[dateType];
            document.getElementById('dateAdvice').textContent = dateAdvice[Math.floor(Math.random() * dateAdvice.length)];
            
            // 注意事項
            const cautionTypes = ['personality', 'communication', 'lifestyle'];
            const cautionType = cautionTypes[Math.floor(Math.random() * cautionTypes.length)];
            const cautionAdvice = relationshipAdvice.cautions[cautionType];
            document.getElementById('cautionAdvice').textContent = cautionAdvice[Math.floor(Math.random() * cautionAdvice.length)];
        }

        function updateFuturePredictions(score) {
            const predictions = {
                short: {
                    high: ["感情升溫迅速，很快進入穩定期", "彼此吸引力強，蜜月期延長", "溝通順暢，很少發生爭執"],
                    medium: ["需要時間磨合，但前景看好", "偶有小摩擦，但能快速和解", "感情穩定發展，逐漸加深"],
                    low: ["需要更多耐心和理解", "可能會有一些挑戰需要克服", "建議多花時間相處了解"]
                },
                medium: {
                    high: ["很可能步入婚姻殿堂", "關係穩固，考慮同居或結婚", "家人朋友都很支持你們"],
                    medium: ["關係逐漸穩定，考慮長期發展", "可能會討論未來規劃", "需要更多承諾和責任"],
                    low: ["需要更多時間考驗關係", "可能面臨一些重要決定", "建議慎重考慮長期發展"]
                },
                long: {
                    high: ["幸福美滿的家庭生活", "能夠一起面對人生各種挑戰", "成為彼此最好的人生伴侶"],
                    medium: ["穩定的長期關係", "需要持續經營和維護", "能夠共同成長和進步"],
                    low: ["需要更多努力維持關係", "可能需要專業諮詢協助", "真愛需要時間和努力證明"]
                }
            };
            
            const level = score >= 85 ? 'high' : score >= 70 ? 'medium' : 'low';
            
            document.getElementById('shortTermPrediction').textContent = predictions.short[level][Math.floor(Math.random() * predictions.short[level].length)];
            document.getElementById('mediumTermPrediction').textContent = predictions.medium[level][Math.floor(Math.random() * predictions.medium[level].length)];
            document.getElementById('longTermPrediction').textContent = predictions.long[level][Math.floor(Math.random() * predictions.long[level].length)];
        }

        function startNewCoupleTest() {
            // 清空表單
            document.getElementById('partnerAName').value = '';
            document.getElementById('partnerAGender').value = '';
            document.getElementById('partnerABirthday').value = '';
            document.getElementById('partnerBName').value = '';
            document.getElementById('partnerBGender').value = '';
            document.getElementById('partnerBBirthday').value = '';
            document.getElementById('analyzeBtn').disabled = true;
            
            // 返回測試頁面
            document.getElementById('coupleResultPage').classList.add('hidden');
            document.getElementById('coupleTestPage').classList.remove('hidden');
        }

        function shareCoupleResult() {
            const score = document.getElementById('scoreNumber').textContent;
            const level = document.getElementById('compatibilityLevel').textContent;
            const partnerA = coupleData.partnerA.name;
            const partnerB = coupleData.partnerB.name;
            
            const shareText = `💕 ${partnerA} ❤️ ${partnerB} 的契合度分析\n\n契合度：${score}% (${level})\n\n我們就像迪士尼情侶一樣甜蜜！快來測試你們的契合度吧！`;
            
            if (navigator.share) {
                navigator.share({
                    title: '伴侶契合度測試結果',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('契合度結果已複製到剪貼板！');
                });
            }
        }

        function backToResult() {
            document.getElementById('coupleTestPage').classList.add('hidden');
            document.getElementById('coupleResultPage').classList.add('hidden');
            document.getElementById('resultPage').classList.remove('hidden');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97f4b04c865e313b',t:'MTc1NzkwMzI4NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
<!-- 📱 手機預覽按鈕 -->
<button id="mobilePreviewToggle" class="fixed bottom-4 right-4 bg-purple-600 text-white px-4 py-2 rounded-full shadow-lg z-50 hidden md:block">
  📱 手機預覽
</button>

<style>
.mobile-preview {
  max-width: 420px;
  margin: 0 auto;
  border: 2px solid #aaa;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("mobilePreviewToggle");
  if(btn){
    btn.addEventListener("click", () => {
      document.body.classList.toggle("mobile-preview");
    });
  }
});
</script>


<audio id="bgm" src="bg.mp3" autoplay loop preload="auto" playsinline></audio>
<button id="audioToggle" class="audio-toggle" aria-label="音樂開關"><span class="icon">🔊</span></button>
<div id="soundToast" role="status">點一下開啟音效 🔊</div>

<script>
(function(){
  const audio = document.getElementById('bgm');
  const toggle = document.getElementById('audioToggle');
  const toast = document.getElementById('soundToast');
  if(!audio || !toggle) return;

  let desiredVolume = 0.5; // 預設音量（可改 0~1 之間）
  audio.volume = desiredVolume;

  function updateIcon(){
    const icon = toggle.querySelector('.icon');
    if (!icon) return;
    icon.textContent = audio.paused ? '🔇' : '🔊';
    toggle.setAttribute('aria-label', audio.paused ? '開啟音樂' : '關閉音樂');
  }

  async function tryPlay(tag){
    try{
      await audio.play();
      toast && toast.classList.remove('show');
    }catch(e){
      // Autoplay 受阻，提示用戶點一下啟用
      toast && toast.classList.add('show');
    }finally{
      updateIcon();
    }
  }

  // 嘗試自動播放（多次時序，提升成功率）
  document.addEventListener('DOMContentLoaded', ()=>{
    tryPlay('dom');
    setTimeout(()=>tryPlay('delay1'), 1200);
    setTimeout(()=>tryPlay('delay2'), 2500);
  });
  window.addEventListener('load', ()=> setTimeout(()=>tryPlay('load'), 400));

  // 任意首次互動即嘗試播放
  const oncePlay = ()=>{ tryPlay('user'); document.removeEventListener('pointerdown', oncePlay, {capture:true}); };
  document.addEventListener('pointerdown', oncePlay, {capture:true});

  // 綁定到現有主按鈕（若存在）
  const startBtn = document.getElementById('magicStartButton');
  if (startBtn) startBtn.addEventListener('click', ()=>tryPlay('start'), {passive:true});

  // 切換播放 / 暫停
  toggle.addEventListener('click', async ()=>{
    if (audio.paused) await tryPlay('toggle');
    else audio.pause();
    updateIcon();
  });

  // 簡易鍵盤開啟偵測（避免擋住輸入框）
  (function(){
    var body = document.body;
    var lastH = window.innerHeight, THRESHOLD = 120;
    function onResize(){
      var now = window.innerHeight;
      if (Math.abs(now - lastH) > THRESHOLD){
        if (now < lastH) body.classList.add('keyboard-open');
        else body.classList.remove('keyboard-open');
        lastH = now;
      }
    }
    window.addEventListener('resize', onResize, {passive:true});
    document.addEventListener('focusin', function(e){
      if (e.target.matches('input,textarea,select')) body.classList.add('keyboard-open');
    }, {passive:true});
    document.addEventListener('focusout', function(e){
      if (e.target.matches('input,textarea,select')) body.classList.remove('keyboard-open');
    }, {passive:true});
  })();

  updateIcon();
})();
</script>
</body>
</html>

